<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Corrado Caudek">
<title>82&nbsp; Predizione – Testing Psicologico</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/networks/01_networks.html" rel="next">
<link href="../../chapters/lgm/11_lgm_wais.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2363a7b1713459e3bb7e05f1febbb7c9.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-6160eebdccf729e88acfdd1d92726e70.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-62e4b2809dfb41b5160f340e7c383cce.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-d5b1b7f210f9f8712579e048ed54cd39.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean"
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/prediction/01_prediction.html">Predizione</a></li><li class="breadcrumb-item"><a href="../../chapters/prediction/01_prediction.html"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Predizione</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Testing Psicologico</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/testing_psicologico/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Attiva/disattiva la modalità oscura"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benvenuti</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendario</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cal_testing_psic_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calendario Didattico e Programma del Corso</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Punteggi e scale</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/01_scores_scales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Punteggi e scale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E1_likert.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E2_optimal_scoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E3_thurstone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/02_development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sviluppo dello strumento</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/03_equating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Equating nei Test Psicologici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E4_norming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">CTT</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/01_ctt_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fondamenti teorici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/02_ctt_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">L’affidabilità del test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/03_ctt_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Metodi di stima dell’affidabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/04_err_std_mis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">L’errore standard della misurazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/05_err_std_stima.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">La stima del punteggio vero</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/06_ctt_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Applicazioni della CTT</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Giudici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/raters/01_multilevel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modelli multilivello</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/raters/02_interrater_reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">L’affidabilità tra giudici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/raters/E1_irr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Validità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/validity/01_validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">La validità del test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/validity/02_other_variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Relazioni test-criterio</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Generalizzabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/gtheory/01_gtheory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Teoria della generalizzabilità</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Items</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/items/01_item_development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Lo sviluppo degli item</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/items/02_item_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analisi degli item</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Analisi dei percorsi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/path_analysis/01_path_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analisi dei percorsi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/path_analysis/02_clement_2022.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Riparazione affettiva post-infedeltà</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">PCA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/pca/01_linear_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Elementi di algebra lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/pca/02_pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Analisi delle componenti principali</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">FA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/01_intro_fa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Introduzione all’analisi fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/02_analisi_fattoriale_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Il modello unifattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/03_analisi_fattoriale_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Il modello statistico dell’analisi fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/04_analisi_fattoriale_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Il modello multifattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/05_factor_scores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">I punteggi fattoriali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/06_constraints_on_parms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Attendibilità e modello fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/07_total_score.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Punteggio totale e modello fattoriale</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Costruzione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/01_val_matrici.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Valutazione della matrice di correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/02_estrazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">L’estrazione dei fattori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/03_numero_fattori.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Il numero dei fattori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/04_rotazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">La rotazione fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/05_val_soluzione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Valutare e rifinire la soluzione fattoriale</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">CFA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/01_cfa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Analisti Fattoriale Confermativa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/02_meanstructure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">La struttura delle medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/03_cat_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dati non gaussiani e categoriali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/04_mmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">CFA per matrici multi-tratto multi-metodo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/05_bifactor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Modello bifattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/06_efa_lavaan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Exploratory Structural Equation Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/07_fa_in_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Strategia Integrata per un’Analisi Fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/E_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/E_02_bifactor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">SEM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/01_sem_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Introduzione ai Modelli SEM</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/02_data_preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Preparazione dei Dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/03_gof.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Test del Modello e Indicizzazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/04_mod_comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Confronto tra modelli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/05_cfa_mod_comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">CFA: confronto tra modelli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/06_refine_solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">La revisione del modello</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/07_group_invariance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Invarianza di misura</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/08_multilevel_sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Modelli di Equazioni Strutturali Multilivello</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/09_structural_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Modelli di Regressione Strutturale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/10_missing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Dati mancanti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/11_small_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Modellizzazione SEM in Piccoli Campioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/12_temp_reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Affidabilità longitudinale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/13_esem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Exploratory structural equation modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/14_sem_power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Dimensione Campionaria e Analisi della Potenza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/E_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/15_prior_pred_mod_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Prior Predictive Model Checking</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">Mokken</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mokken/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Modello di Regressione Logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mokken/02_core_issues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Analisi della Scala di Mokken</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mokken/03_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Applicazione Pratica</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">IRT</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/E_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/02_rasch_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Modello di Rasch</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/03_assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Assunzioni e Proprietà del Modello di Rasch</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/04_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Stima</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/05_1pl_2pl_3pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Modelli 1PL, 2PL e 3PL</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/06_implementation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Implementazione</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">LGM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/01_lgm_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Curve di crescita latente</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/02_lgm_prelims.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Considerazioni Preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/06_lgm_mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">LGM e modelli misti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/03_time_effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Dati longitudinali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/05_intro_panel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Specificare e Interpretare un Modello Longitudinale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/07_growth_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Curve di crescita latente</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/08_growth_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Il tempo su una metrica continua</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/09_time_inv_cov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Covariate indipendenti dal tempo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/10_growth_groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Modelli di crescita latenti a gruppi multipli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/11_lgm_wais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Lo Sviluppo dell’Intelligenza</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true">
 <span class="menu-text">Predizione</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/prediction/01_prediction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Predizione</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false">
 <span class="menu-text">Networks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/networks/01_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Network psicologici</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografia</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a1_intro_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Linguaggio R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a2_sums.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Simbolo di somma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a3_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">Soluzioni degli esercizi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/solutions_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Probabilità</span></span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Indice</h2>
   
  <ul>
<li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">82.1</span> Introduzione</a></li>
  <li><a href="#calcolo-della-probabilit%C3%A0-di-hiv-dato-un-test-positivo" id="toc-calcolo-della-probabilità-di-hiv-dato-un-test-positivo" class="nav-link" data-scroll-target="#calcolo-della-probabilit%C3%A0-di-hiv-dato-un-test-positivo"><span class="header-section-number">82.2</span> Calcolo della probabilità di HIV dato un test positivo</a></li>
  <li>
<a href="#calcolo-della-probabilit%C3%A0-di-un-secondo-test-positivo" id="toc-calcolo-della-probabilità-di-un-secondo-test-positivo" class="nav-link" data-scroll-target="#calcolo-della-probabilit%C3%A0-di-un-secondo-test-positivo"><span class="header-section-number">82.3</span> Calcolo della probabilità di un secondo test positivo</a>
  <ul>
<li><a href="#accuratezza-delle-predizioni-versione-migliorata" id="toc-accuratezza-delle-predizioni-versione-migliorata" class="nav-link" data-scroll-target="#accuratezza-delle-predizioni-versione-migliorata"><span class="header-section-number">82.3.1</span> Accuratezza delle Predizioni: Versione Migliorata</a></li>
  <li><a href="#la-matrice-di-confusione" id="toc-la-matrice-di-confusione" class="nav-link" data-scroll-target="#la-matrice-di-confusione"><span class="header-section-number">82.3.2</span> La Matrice di Confusione</a></li>
  <li><a href="#tassi-marginali-e-indicatori-chiave" id="toc-tassi-marginali-e-indicatori-chiave" class="nav-link" data-scroll-target="#tassi-marginali-e-indicatori-chiave"><span class="header-section-number">82.3.3</span> Tassi Marginali e Indicatori Chiave</a></li>
  <li><a href="#limportanza-del-tasso-di-base" id="toc-limportanza-del-tasso-di-base" class="nav-link" data-scroll-target="#limportanza-del-tasso-di-base"><span class="header-section-number">82.3.4</span> L’Importanza del Tasso di Base</a></li>
  <li><a href="#diversi-tipi-di-errori-e-i-loro-costi" id="toc-diversi-tipi-di-errori-e-i-loro-costi" class="nav-link" data-scroll-target="#diversi-tipi-di-errori-e-i-loro-costi"><span class="header-section-number">82.3.5</span> Diversi Tipi di Errori e i loro Costi</a></li>
  <li><a href="#importanza-del-rapporto-di-selezione-e-del-tasso-di-base" id="toc-importanza-del-rapporto-di-selezione-e-del-tasso-di-base" class="nav-link" data-scroll-target="#importanza-del-rapporto-di-selezione-e-del-tasso-di-base"><span class="header-section-number">82.3.6</span> Importanza del Rapporto di Selezione e del Tasso di Base</a></li>
  <li><a href="#predizioni-e-affidabilit%C3%A0-in-condizioni-di-basso-tasso-di-base" id="toc-predizioni-e-affidabilità-in-condizioni-di-basso-tasso-di-base" class="nav-link" data-scroll-target="#predizioni-e-affidabilit%C3%A0-in-condizioni-di-basso-tasso-di-base"><span class="header-section-number">82.3.7</span> Predizioni e Affidabilità in Condizioni di Basso Tasso di Base</a></li>
  <li><a href="#sensibilit%C3%A0-specificit%C3%A0-ppv-e-npv" id="toc-sensibilità-specificità-ppv-e-npv" class="nav-link" data-scroll-target="#sensibilit%C3%A0-specificit%C3%A0-ppv-e-npv"><span class="header-section-number">82.3.8</span> Sensibilità, Specificità, PPV e NPV</a></li>
  <li><a href="#interpretazione-delle-metriche" id="toc-interpretazione-delle-metriche" class="nav-link" data-scroll-target="#interpretazione-delle-metriche"><span class="header-section-number">82.3.9</span> Interpretazione delle Metriche</a></li>
  </ul>
</li>
  <li><a href="#alcune-stime-di-accuratezza-dipendono-dal-cutoff" id="toc-alcune-stime-di-accuratezza-dipendono-dal-cutoff" class="nav-link" data-scroll-target="#alcune-stime-di-accuratezza-dipendono-dal-cutoff"><span class="header-section-number">82.4</span> Alcune Stime di Accuratezza Dipendono dal Cutoff</a></li>
  <li>
<a href="#teoria-della-detezione-del-segnale" id="toc-teoria-della-detezione-del-segnale" class="nav-link" data-scroll-target="#teoria-della-detezione-del-segnale"><span class="header-section-number">82.5</span> Teoria della Detezione del Segnale</a>
  <ul>
<li><a href="#curva-roc-receiver-operating-characteristic" id="toc-curva-roc-receiver-operating-characteristic" class="nav-link" data-scroll-target="#curva-roc-receiver-operating-characteristic"><span class="header-section-number">82.5.1</span> Curva ROC (Receiver Operating Characteristic)</a></li>
  <li><a href="#area-sotto-la-curva-roc-auc" id="toc-area-sotto-la-curva-roc-auc" class="nav-link" data-scroll-target="#area-sotto-la-curva-roc-auc"><span class="header-section-number">82.5.2</span> Area Sotto la Curva ROC (AUC)</a></li>
  </ul>
</li>
  <li><a href="#predictionAccuracy" id="toc-predictionAccuracy" class="nav-link" data-scroll-target="#predictionAccuracy"><span class="header-section-number">82.6</span> Accuratezza della Predizione attraverso i Cutoff</a></li>
  <li>
<a href="#calibration" id="toc-calibration" class="nav-link" data-scroll-target="#calibration"><span class="header-section-number">82.7</span> Calibrazione</a>
  <ul>
<li>
<a href="#calibrationPlot" id="toc-calibrationPlot" class="nav-link" data-scroll-target="#calibrationPlot"><span class="header-section-number">82.7.1</span> Calibration Plot</a>
  <ul>
<li><a href="#brierScores" id="toc-brierScores" class="nav-link" data-scroll-target="#brierScores"><span class="header-section-number">82.7.1.1</span> Brier Scores</a></li>
  <li><a href="#brierScores" id="toc-brierScores" class="nav-link" data-scroll-target="#brierScores"><span class="header-section-number">82.7.1.2</span> Brier Scores</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#matrice-di-confusione" id="toc-matrice-di-confusione" class="nav-link" data-scroll-target="#matrice-di-confusione"><span class="header-section-number">82.8</span> Matrice di Confusione</a>
  <ul>
<li><a href="#truePositive" id="toc-truePositive" class="nav-link" data-scroll-target="#truePositive"><span class="header-section-number">82.8.1</span> True Positives (TP)</a></li>
  <li><a href="#trueNegative" id="toc-trueNegative" class="nav-link" data-scroll-target="#trueNegative"><span class="header-section-number">82.8.2</span> True Negatives (TN)</a></li>
  <li><a href="#falsePositive" id="toc-falsePositive" class="nav-link" data-scroll-target="#falsePositive"><span class="header-section-number">82.8.3</span> False Positives (FP)</a></li>
  <li><a href="#falseNegative" id="toc-falseNegative" class="nav-link" data-scroll-target="#falseNegative"><span class="header-section-number">82.8.4</span> False Negatives (FN)</a></li>
  <li><a href="#sampleSize-prediction" id="toc-sampleSize-prediction" class="nav-link" data-scroll-target="#sampleSize-prediction"><span class="header-section-number">82.8.5</span> Dimensione del Campione (<em>N</em>)</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/prediction/01_prediction.html">Predizione</a></li><li class="breadcrumb-item"><a href="../../chapters/prediction/01_prediction.html"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Predizione</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-prediction-roc" class="quarto-section-identifier"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Predizione</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><strong>Prerequisiti</strong></p>
<ul>
<li>Leggere il capitolo 9 <em>Prediction</em> del testo di <span class="citation" data-cites="petersen2024principles">Petersen (<a href="../../99-references.html#ref-petersen2024principles" role="doc-biblioref">2024</a>)</span>.</li>
</ul>
<p><strong>Concetti e Competenze Chiave</strong></p>
<p><strong>Preparazione del Notebook</strong></p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span></span>
<span>    <span class="va">petersenlab</span>, <span class="va">magrittr</span>, <span class="va">viridis</span>, <span class="va">pROC</span>, <span class="va">ROCR</span>, <span class="va">rms</span>, <span class="va">ResourceSelection</span>,</span>
<span>    <span class="va">PredictABEL</span>, <span class="va">gridExtra</span>, <span class="va">grid</span>, <span class="va">ggpubr</span>, <span class="va">msir</span>, <span class="va">car</span>, <span class="va">ggrepel</span>, <span class="va">MOTE</span>,</span>
<span>    <span class="va">tinytex</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduzione" class="level2" data-number="82.1"><h2 data-number="82.1" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">82.1</span> Introduzione</h2>
<p>Le predizioni possono essere di vario tipo. Alcune riguardano dati categoriali, mentre altre si basano su dati continui. Per i dati categoriali, possiamo valutare le predizioni utilizzando una tabella 2 <span class="math inline">\(\times\)</span> 2, nota come matrice di confusione, o con modelli di regressione logistica. Invece, per i dati continui, possiamo utilizzare la regressione multipla o varianti come il modello a equazioni strutturali o i modelli misti.</p>
</section><section id="calcolo-della-probabilità-di-hiv-dato-un-test-positivo" class="level2" data-number="82.2"><h2 data-number="82.2" class="anchored" data-anchor-id="calcolo-della-probabilità-di-hiv-dato-un-test-positivo">
<span class="header-section-number">82.2</span> Calcolo della probabilità di HIV dato un test positivo</h2>
<p>Analizziamo un esempio pratico per stimare la probabilità di avere l’HIV, partendo da un test positivo, utilizzando le seguenti informazioni tratte da <span class="citation" data-cites="petersen2024principles">Petersen (<a href="../../99-references.html#ref-petersen2024principles" role="doc-biblioref">2024</a>)</span>:</p>
<ul>
<li>
<strong>Tasso di base dell’HIV (P(HIV))</strong>: 0.3% (0.003). Questa è la probabilità che una persona nella popolazione generale abbia l’HIV.</li>
<li>
<strong>Sensibilità del test (P(Test+ HIV))</strong>: 95% (0.95). È la probabilità che il test risulti positivo quando la persona ha l’HIV.</li>
<li>
<strong>Specificità del test (P(Test- ¬HIV))</strong>: 99.28% (0.9928). È la probabilità che il test risulti negativo quando la persona non ha l’HIV.</li>
</ul>
<p>Per calcolare la probabilità di avere l’HIV dato un test positivo <span class="math inline">\(P(HIV \mid  Test+)\)</span>, utilizziamo il teorema di Bayes:</p>
<p><span class="math display">\[
P(HIV \mid  Test+) = \frac{P(Test+ \mid  HIV) \times P(HIV)}{P(Test+)}.
\]</span></p>
<p>Il denominatore rappresenta la probabilità complessiva di ottenere un test positivo e include sia i <strong>veri positivi</strong> che i <strong>falsi positivi</strong>:</p>
<p><span class="math display">\[
P(Test+) = P(Test+ \mid  HIV) \times P(HIV) + P(Test+ \mid  \neg HIV) \times P(\neg HIV),
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(P(Test+ \mid  \neg HIV) = 1 - P(Test- \mid  \neg HIV) = 1 - 0.9928 = 0.0072\)</span> (tasso di falsi positivi),</li>
<li>
<span class="math inline">\(P(\neg HIV) = 1 - P(HIV) = 1 - 0.003 = 0.997\)</span>.</li>
</ul>
<p>Sostituendo i valori:</p>
<p><span class="math display">\[
P(Test+) = (0.95 \times 0.003) + (0.0072 \times 0.997) \approx 0.010027.
\]</span></p>
<p>Ora possiamo calcolare la probabilità di avere l’HIV dato un test positivo:</p>
<p><span class="math display">\[
P(HIV \mid  Test+) = \frac{0.95 \times 0.003}{0.010027} \approx 0.2844 \quad \text{(28.44\%)}.
\]</span></p>
<p>Quindi, per un test con le caratteristiche descritte, un risultato positivo indica una probabilità di avere l’HIV pari al 28.44%.</p>
</section><section id="calcolo-della-probabilità-di-un-secondo-test-positivo" class="level2" data-number="82.3"><h2 data-number="82.3" class="anchored" data-anchor-id="calcolo-della-probabilità-di-un-secondo-test-positivo">
<span class="header-section-number">82.3</span> Calcolo della probabilità di un secondo test positivo</h2>
<p>Dopo un primo test positivo, la probabilità di avere l’HIV è aumentata al 28.44%. Ora consideriamo la probabilità di ottenere un <strong>secondo test positivo</strong> e calcoliamo la probabilità aggiornata di avere l’HIV dopo due test positivi consecutivi.</p>
<p>La probabilità di un secondo test positivo si calcola considerando due scenari:</p>
<ol type="1">
<li>
<strong>La persona ha l’HIV</strong>:
<ul>
<li>Probabilità di avere l’HIV dopo il primo test: <span class="math inline">\(P(HIV \mid  Test+) = 0.2844\)</span>,</li>
<li>Probabilità che il test sia positivo: <span class="math inline">\(P(Test+ \mid  HIV) = 0.95\)</span>.</li>
</ul>
</li>
<li>
<strong>La persona non ha l’HIV</strong>:
<ul>
<li>Probabilità di non avere l’HIV dopo il primo test: <span class="math inline">\(P(\neg HIV \mid  Test+) = 1 - P(HIV \mid  Test+) = 0.7156\)</span>,</li>
<li>Probabilità che il test sia positivo: <span class="math inline">\(P(Test+ \mid  \neg HIV) = 0.0072\)</span>.</li>
</ul>
</li>
</ol>
<p>Utilizziamo la formula della probabilità totale:</p>
<p><span class="math display">\[
P(\text{Secondo Test+}) = P(Test+ \mid  HIV) \times P(HIV \mid  Test+) \\
+ P(Test+ \mid  \neg HIV) \times P(\neg HIV \mid  Test+).
\]</span></p>
<p>Sostituendo i valori:</p>
<p><span class="math display">\[
P(\text{Secondo Test+}) = (0.95 \times 0.2844) + (0.0072 \times 0.7156) \approx 0.2753.
\]</span></p>
<p>Applichiamo nuovamente il teorema di Bayes per aggiornare la probabilità:</p>
<p><span class="math display">\[
P(HIV \mid  \text{Secondo Test+}) = \frac{P(Test+ \mid  HIV) \times P(HIV \mid  Test+)}{P(\text{Secondo Test+})}.
\]</span></p>
<p>Sostituendo i valori:</p>
<p><span class="math display">\[
P(HIV \mid  \text{Secondo Test+}) = \frac{0.95 \times 0.2844}{0.2753} \approx 0.981 \quad \text{(98.1\%)}.
\]</span></p>
<p>In conclusione,</p>
<ol type="1">
<li>
<strong>Probabilità iniziale</strong>: La probabilità iniziale di avere l’HIV nella popolazione è molto bassa (0.3%).</li>
<li>
<strong>Primo test positivo</strong>: Un primo test positivo aumenta la probabilità al 28.44%.</li>
<li>
<strong>Secondo test positivo</strong>: Un secondo test positivo porta la probabilità al 98.1%.</li>
</ol>
<p>Questi risultati dimostrano:</p>
<ul>
<li>L’importanza di considerare la prevalenza (tasso di base) nella popolazione.</li>
<li>Come il teorema di Bayes consenta di aggiornare progressivamente le probabilità sulla base di nuove evidenze.</li>
<li>L’efficacia dei test ripetuti per aumentare la precisione diagnostica.</li>
</ul>
<p>L’analisi evidenzia come un approccio bayesiano possa ridurre notevolmente l’incertezza iniziale, fornendo stime più accurate della probabilità di una condizione medica.</p>
<section id="accuratezza-delle-predizioni-versione-migliorata" class="level3" data-number="82.3.1"><h3 data-number="82.3.1" class="anchored" data-anchor-id="accuratezza-delle-predizioni-versione-migliorata">
<span class="header-section-number">82.3.1</span> Accuratezza delle Predizioni: Versione Migliorata</h3>
<p>Dopo l’introduzione sull’uso del teorema di Bayes per la predizione, <span class="citation" data-cites="petersen2024principles">Petersen (<a href="../../99-references.html#ref-petersen2024principles" role="doc-biblioref">2024</a>)</span> affronta il tema delle predizioni con una tabella 2 × 2. Per spiegare questo caso, l’autore presenta un esempio adattato da Meehl &amp; Rosen (1955).</p>
<p>Immaginiamo che l’esercito americano utilizzi un test per escludere i candidati con basse probabilità di completare l’addestramento di base. Per analizzare l’accuratezza delle predizioni effettuate, possiamo utilizzare una <strong>matrice di confusione</strong>, che confronta le predizioni del test con i risultati reali.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 14%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th><strong>Decisione (Predizione)</strong></th>
<th><strong>Adattamento Effettivo (Scarso)</strong></th>
<th><strong>Adattamento Effettivo (Buono)</strong></th>
<th><strong>Totale Predetto</strong></th>
<th><strong>Rapporto di Selezione (SR)</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Escludere</strong></td>
<td>TP = 86 (0,043)</td>
<td>FP = 422 (0,211)</td>
<td>508</td>
<td>SR = 0,254</td>
</tr>
<tr class="even">
<td><strong>Trattenere</strong></td>
<td>FN = 14 (0,007)</td>
<td>TN = 1.478 (0,739)</td>
<td>1.492</td>
<td>1 − SR = 0,746</td>
</tr>
<tr class="odd">
<td><strong>Totale Effettivo</strong></td>
<td>100</td>
<td>1.900</td>
<td>N = 2.000</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Tasso di Base (BR)</strong></td>
<td>BR = 0,05</td>
<td>1 − BR = 0,95</td>
<td></td>
<td></td>
</tr>
</tbody>
</table></section><section id="la-matrice-di-confusione" class="level3" data-number="82.3.2"><h3 data-number="82.3.2" class="anchored" data-anchor-id="la-matrice-di-confusione">
<span class="header-section-number">82.3.2</span> La Matrice di Confusione</h3>
<p>La <strong>matrice di confusione</strong> è uno strumento che mette in relazione le predizioni di un modello con i risultati osservati. Nel caso di una predizione binaria (es. sì/no o positivo/negativo), la matrice è organizzata in quattro categorie:</p>
<ol type="1">
<li>
<strong>Vero Positivo (TP)</strong>: La predizione corretta che identifica una persona con la caratteristica (es. cattivo adattamento).</li>
<li>
<strong>Vero Negativo (TN)</strong>: La predizione corretta che identifica una persona senza la caratteristica.</li>
<li>
<strong>Falso Positivo (FP)</strong>: L’errore in cui si predice la presenza della caratteristica quando in realtà non è presente.</li>
<li>
<strong>Falso Negativo (FN)</strong>: L’errore in cui si predice l’assenza della caratteristica quando in realtà è presente.</li>
</ol>
<p>Questi quattro risultati consentono di valutare l’accuratezza di un modello.</p>
</section><section id="tassi-marginali-e-indicatori-chiave" class="level3" data-number="82.3.3"><h3 data-number="82.3.3" class="anchored" data-anchor-id="tassi-marginali-e-indicatori-chiave">
<span class="header-section-number">82.3.3</span> Tassi Marginali e Indicatori Chiave</h3>
<p>Dalla matrice di confusione possiamo calcolare alcuni tassi e indicatori utili:</p>
<ol type="1">
<li><p><strong>Tasso di Base (BR)</strong>: La probabilità che una persona abbia la caratteristica di interesse. Ad esempio: <span class="math display">\[
BR = \frac{FN + TP}{N} = \frac{100}{2000} = 0.05
\]</span> Ciò significa che solo il 5% dei candidati ha un cattivo adattamento.</p></li>
<li><p><strong>Rapporto di Selezione (SR)</strong>: La probabilità di essere esclusi dal programma: <span class="math display">\[
SR = \frac{TP + FP}{N} = \frac{508}{2000} = 0.254
\]</span> In questo caso, il 25,4% dei candidati è stato escluso.</p></li>
<li><p><strong>Percentuale di Accuratezza</strong>: Rappresenta la proporzione di predizioni corrette sul totale: <span class="math display">\[
\text{Accuratezza} = 100 \times \frac{TP + TN}{N} = 100 \times \frac{86 + 1478}{2000} = 78\%
\]</span></p></li>
<li><p><strong>Accuratezza per Caso</strong>: Misura la precisione che si otterrebbe effettuando predizioni casuali basate solo sulle probabilità marginali (BR e SR). Per esempio: <span class="math display">\[
P(TP) = BR \times SR = 0.05 \times 0.254 = 0.0127
\]</span> <span class="math display">\[
P(TN) = (1 − BR) \times (1 − SR) = 0.95 \times 0.746 = 0.7087
\]</span> <span class="math display">\[
\text{Accuratezza per Caso} = P(TP) + P(TN) = 0.0127 + 0.7087 = 0.7214 \, (72,14\%)
\]</span></p></li>
</ol>
<p>Confrontando il 78% di accuratezza del modello con il 72.14% ottenibile per caso, il modello fornisce un miglioramento del 6%.</p>
</section><section id="limportanza-del-tasso-di-base" class="level3" data-number="82.3.4"><h3 data-number="82.3.4" class="anchored" data-anchor-id="limportanza-del-tasso-di-base">
<span class="header-section-number">82.3.4</span> L’Importanza del Tasso di Base</h3>
<p>Quando il <strong>tasso di base</strong> è molto basso (come in questo caso, BR = 0.05), l’accuratezza complessiva può essere ingannevole. Se predicessimo che nessuno ha un cattivo adattamento, otterremmo un’accuratezza del 95%, ma il modello non identificherebbe alcun caso di cattivo adattamento.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th><strong>Decisione (Predizione)</strong></th>
<th><strong>Adattamento Effettivo (Scarso)</strong></th>
<th><strong>Adattamento Effettivo (Buono)</strong></th>
<th><strong>Totale Predetto</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Escludere</strong></td>
<td>TP = 0</td>
<td>FP = 0</td>
<td>0</td>
</tr>
<tr class="even">
<td><strong>Trattenere</strong></td>
<td>FN = 100</td>
<td>TN = 1.900</td>
<td>2.000</td>
</tr>
<tr class="odd">
<td><strong>Totale Effettivo</strong></td>
<td>100</td>
<td>1.900</td>
<td>N = 2.000</td>
</tr>
</tbody>
</table>
<p>In questo caso, l’accuratezza complessiva sarebbe: <span class="math display">\[
P(\text{Accuratezza}) = \frac{TP + TN}{N} = \frac{0 + 1.900}{2.000} = 95\%.
\]</span></p>
<p>Questo esempio evidenzia che un’elevata accuratezza complessiva non garantisce un buon modello, specialmente quando il tasso di base è sbilanciato.</p>
<p>In conclusione, l’analisi di una matrice di confusione richiede attenzione ai tassi di base e agli errori, poiché l’accuratezza globale può essere fuorviante. È essenziale confrontare il valore del modello con ciò che si otterrebbe per caso o con strategie alternative, come basarsi solo sul tasso di base. Inoltre, occorre considerare il peso relativo degli errori (falsi positivi e falsi negativi) in base al contesto applicativo. Questi aspetti saranno discussi nel prossimo paragrafo.</p>
</section><section id="diversi-tipi-di-errori-e-i-loro-costi" class="level3" data-number="82.3.5"><h3 data-number="82.3.5" class="anchored" data-anchor-id="diversi-tipi-di-errori-e-i-loro-costi">
<span class="header-section-number">82.3.5</span> Diversi Tipi di Errori e i loro Costi</h3>
<p>In un processo di classificazione, non tutti gli errori hanno lo stesso costo. Esistono due tipi principali di errori: i <em>falsi positivi</em> e i <em>falsi negativi</em>, ciascuno con implicazioni diverse che dipendono dal contesto della predizione.</p>
<p>Spesso, l’accuratezza complessiva può essere aumentata affidandosi semplicemente al <em>tasso di base</em>, ma in molte situazioni può essere preferibile utilizzare uno strumento di screening, anche a costo di una minore <em>accuratezza complessiva</em>, se ciò consente di minimizzare errori specifici che hanno costi elevati. Ad esempio:</p>
<ol type="1">
<li><p><strong>Screening medico</strong>: Consideriamo uno strumento di screening per l’HIV. I <em>falsi positivi</em> (classificare erroneamente una persona come a rischio) comportano costi come la necessità di test di conferma e, talvolta, ansia temporanea per l’individuo. Tuttavia, un <em>falso negativo</em> (non identificare una persona effettivamente a rischio) ha costi molto più alti, poiché potrebbe portare a un mancato intervento precoce, con conseguenze gravi per la salute. In questo caso, i costi associati ai falsi negativi superano di gran lunga quelli dei falsi positivi, rendendo lo screening preferibile nonostante una diminuzione dell’accuratezza complessiva.</p></li>
<li><p><strong>Selezione del personale in situazioni di rischio</strong>: La CIA, ad esempio, ha utilizzato strumenti di selezione per identificare potenziali spie durante periodi di guerra. Un <em>falso positivo</em> in questo contesto (considerare erroneamente una persona come una spia) potrebbe risultare nell’esclusione di un candidato innocente. Un <em>falso negativo</em> (assumere una persona che è effettivamente una spia) comporta rischi molto più gravi, rendendo cruciale l’identificazione corretta delle spie, anche a costo di più <em>falsi positivi</em>.</p></li>
</ol>
<p>Il modo in cui i costi degli errori vengono valutati dipende fortemente dal contesto. Alcuni potenziali costi dei <em>falsi positivi</em> includono trattamenti medici non necessari o il rischio di incarcerare una persona innocente. Al contrario, i <em>falsi negativi</em> possono portare al rilascio di una persona pericolosa, alla mancata individuazione di una malattia grave, o al mancato riconoscimento di un rischio imminente.</p>
</section><section id="importanza-del-rapporto-di-selezione-e-del-tasso-di-base" class="level3" data-number="82.3.6"><h3 data-number="82.3.6" class="anchored" data-anchor-id="importanza-del-rapporto-di-selezione-e-del-tasso-di-base">
<span class="header-section-number">82.3.6</span> Importanza del Rapporto di Selezione e del Tasso di Base</h3>
<p>Il costo degli errori può variare a seconda di come si imposta il <em>rapporto di selezione</em> (cioè, quanto rigorosamente si applica il criterio per accettare o escludere un individuo). La scelta di un rapporto di selezione meno restrittivo o più restrittivo influisce sulla probabilità di incorrere in <em>falsi positivi</em> e <em>falsi negativi</em> e può dipendere dal contesto e dai costi associati agli errori.</p>
<ul>
<li>
<strong>Criterio meno rigido</strong>: Se escludere candidati è costoso, ad esempio quando si ha la necessità di assumere molte persone, potrebbe essere più utile un criterio di selezione permissivo, che accetta anche persone con un rischio potenziale.</li>
<li>
<strong>Criterio più rigido</strong>: In contesti in cui non è necessario accettare molti individui, si può adottare un criterio di selezione più rigido per ridurre i rischi, scartando un numero maggiore di candidati sospetti.</li>
</ul>
<p>Quando il <em>rapporto di selezione</em> differisce dal <em>tasso di base</em> degli esiti negativi effettivi, inevitabilmente si generano errori:</p>
<ul>
<li>Se, ad esempio, il rapporto di selezione prevede di escludere il 25% dei candidati, ma solo il 5% risulta effettivamente “non idoneo,” il risultato sarà un numero elevato di <em>falsi positivi</em>.</li>
<li>D’altro canto, se si esclude solo l’1% dei candidati mentre il tasso di non idoneità è del 5%, si finirà per includere molti <em>falsi negativi</em>.</li>
</ul></section><section id="predizioni-e-affidabilità-in-condizioni-di-basso-tasso-di-base" class="level3" data-number="82.3.7"><h3 data-number="82.3.7" class="anchored" data-anchor-id="predizioni-e-affidabilità-in-condizioni-di-basso-tasso-di-base">
<span class="header-section-number">82.3.7</span> Predizioni e Affidabilità in Condizioni di Basso Tasso di Base</h3>
<p>Fare predizioni accurate diventa particolarmente complesso quando il tasso di base è basso, come nel caso di eventi rari (ad esempio, il suicidio). In questi casi, il numero di casi positivi reali è molto ridotto, rendendo difficile identificare correttamente i pochi eventi positivi senza generare numerosi falsi positivi o falsi negativi.</p>
<p>Questa difficoltà può essere compresa in relazione alla teoria classica dei test, che definisce l’affidabilità come il rapporto tra la varianza del punteggio vero e la varianza del punteggio osservato. Con un tasso di base molto basso, la varianza del punteggio vero è ridotta, il che abbassa l’affidabilità della misura e rende più complessa una predizione accurata.</p>
</section><section id="sensibilità-specificità-ppv-e-npv" class="level3" data-number="82.3.8"><h3 data-number="82.3.8" class="anchored" data-anchor-id="sensibilità-specificità-ppv-e-npv">
<span class="header-section-number">82.3.8</span> Sensibilità, Specificità, PPV e NPV</h3>
<p>Come abbiamo visto, la <em>percentuale di accuratezza</em> da sola non è sufficiente per valutare l’efficacia di un modello, poiché è molto influenzata dai <em>tassi di base</em>. Ad esempio, se il tasso di base è basso, potremmo ottenere un’alta percentuale di accuratezza semplicemente affermando che nessuno ha la condizione; se è alto, affermando che tutti ce l’hanno. Perciò, è essenziale considerare altre metriche di accuratezza, come <em>sensibilità</em> (SN), <em>specificità</em> (SP), <em>valore predittivo positivo</em> (PPV) e <em>valore predittivo negativo</em> (NPV).</p>
<p>Queste metriche, che si possono calcolare dalla <em>matrice di confusione</em>, ci aiutano a valutare se il modello è efficace nel rilevare la condizione senza includere erroneamente i casi negativi. Analizziamole in dettaglio:</p>
<ul>
<li>
<p><strong>Sensibilità</strong> (SN): indica la capacità del test di identificare correttamente i veri positivi, cioè le persone con la condizione. Si calcola come la proporzione di veri positivi (<span class="math inline">\(\text{TP}\)</span>) rispetto al totale di persone con la condizione (<span class="math inline">\(\text{TP} + \text{FN}\)</span>):</p>
<p><span class="math display">\[
\frac{\text{TP}}{\text{TP} + \text{FN}} = \frac{86}{86 + 14} = 0.86
\]</span></p>
</li>
<li>
<p><strong>Specificità</strong> (SP): misura la capacità del test di identificare correttamente i veri negativi, ossia le persone senza la condizione. Si calcola come la proporzione di veri negativi (<span class="math inline">\(\text{TN}\)</span>) rispetto al totale di persone senza la condizione (<span class="math inline">\(\text{TN} + \text{FP}\)</span>):</p>
<p><span class="math display">\[
\frac{\text{TN}}{\text{TN} + \text{FP}} = \frac{1,478}{1,478 + 422} = 0.78
\]</span></p>
</li>
<li>
<p><strong>Valore Predittivo Positivo</strong> (PPV): indica la probabilità che una persona classificata come positiva abbia effettivamente la condizione. Si calcola come la proporzione di veri positivi (<span class="math inline">\(\text{TP}\)</span>) sul totale dei positivi stimati (<span class="math inline">\(\text{TP} + \text{FP}\)</span>):</p>
<p><span class="math display">\[
\frac{\text{TP}}{\text{TP} + \text{FP}} = \frac{86}{86 + 422} = 0.17
\]</span></p>
</li>
<li>
<p><strong>Valore Predittivo Negativo</strong> (NPV): rappresenta la probabilità che una persona classificata come negativa non abbia effettivamente la condizione. Si calcola come la proporzione di veri negativi (<span class="math inline">\(\text{TN}\)</span>) sul totale dei negativi stimati (<span class="math inline">\(\text{TN} + \text{FN}\)</span>):</p>
<p><span class="math display">\[
\frac{\text{TN}}{\text{TN} + \text{FN}} = \frac{1,478}{1,478 + 14} = 0.99
\]</span></p>
</li>
</ul>
<p>Ogni misura è espressa come una proporzione, variando da 0 a 1, dove valori più alti indicano una maggiore accuratezza per ciascun aspetto specifico. Usando queste metriche otteniamo un quadro dettagliato dell’efficacia dello strumento a un determinato cutoff.</p>
</section><section id="interpretazione-delle-metriche" class="level3" data-number="82.3.9"><h3 data-number="82.3.9" class="anchored" data-anchor-id="interpretazione-delle-metriche">
<span class="header-section-number">82.3.9</span> Interpretazione delle Metriche</h3>
<p>In questo caso, il nostro strumento mostra: - <strong>Alta sensibilità</strong> (0,86): è efficace nel rilevare chi ha la condizione. - <strong>Bassa specificità</strong> (0,78): classifica erroneamente come positivi molti casi che non hanno la condizione. - <strong>Basso PPV</strong> (0,17): la maggior parte dei casi classificati come positivi sono in realtà negativi, indicando una frequenza elevata di falsi positivi. - <strong>Alto NPV</strong> (0,99): quasi tutti i casi classificati come negativi non hanno la condizione.</p>
<p>Quindi, pur avendo una buona capacità di rilevare i positivi (alta sensibilità), il modello è meno efficace nel limitare i falsi positivi (basso PPV). Questo potrebbe essere accettabile se l’obiettivo è identificare tutti i potenziali casi positivi, anche a costo di includere molti falsi positivi, ma potrebbe non essere ideale se il costo degli errori di falsa positività è elevato.</p>
</section></section><section id="alcune-stime-di-accuratezza-dipendono-dal-cutoff" class="level2" data-number="82.4"><h2 data-number="82.4" class="anchored" data-anchor-id="alcune-stime-di-accuratezza-dipendono-dal-cutoff">
<span class="header-section-number">82.4</span> Alcune Stime di Accuratezza Dipendono dal Cutoff</h2>
<p>Sensibilità, specificità, PPV e NPV variano in base al cutoff (ovvero, la soglia) per la classificazione. Consideriamo il seguente esempio. Degli alieni visitano la Terra e sviluppano un test per determinare se una bacca è commestibile o non commestibile.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sampleSize</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">edibleScores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">sampleSize</span>, <span class="fl">50</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">inedibleScores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">sampleSize</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="va">edibleData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">edibleScores</span>, <span class="va">inedibleScores</span><span class="op">)</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"edible"</span>, <span class="va">sampleSize</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"inedible"</span>, <span class="va">sampleSize</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">75</span></span>
<span></span>
<span><span class="va">hist_edible</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">edibleScores</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">150</span><span class="op">)</span> <span class="op">%$%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>area <span class="op">=</span> <span class="va">x</span> <span class="op">&gt;=</span> <span class="va">cutoff</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hist_edible</span><span class="op">$</span><span class="va">type</span><span class="op">[</span><span class="va">hist_edible</span><span class="op">$</span><span class="va">area</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"edible_FP"</span></span>
<span><span class="va">hist_edible</span><span class="op">$</span><span class="va">type</span><span class="op">[</span><span class="va">hist_edible</span><span class="op">$</span><span class="va">area</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"edible_TN"</span></span>
<span></span>
<span><span class="va">hist_inedible</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">inedibleScores</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">150</span><span class="op">)</span> <span class="op">%$%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>area <span class="op">=</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="va">cutoff</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hist_inedible</span><span class="op">$</span><span class="va">type</span><span class="op">[</span><span class="va">hist_inedible</span><span class="op">$</span><span class="va">area</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"inedible_FN"</span></span>
<span><span class="va">hist_inedible</span><span class="op">$</span><span class="va">type</span><span class="op">[</span><span class="va">hist_inedible</span><span class="op">$</span><span class="va">area</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"inedible_TP"</span></span>
<span></span>
<span><span class="va">density_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">hist_edible</span>, <span class="va">hist_inedible</span><span class="op">)</span></span>
<span></span>
<span><span class="va">density_data</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">density_data</span><span class="op">$</span><span class="va">type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"edible_TN"</span>, <span class="st">"inedible_TP"</span>, <span class="st">"edible_FP"</span>, <span class="st">"inedible_FN"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La Figura successiva mostra le distribuzioni dei punteggi in base al tipo di bacca. Si può notare come ci sono due distribuzioni distinte, ma con una certa sovrapposizione. Pertanto, qualsiasi cutoff selezionato comporterà almeno alcune classificazioni errate. L’entità della sovrapposizione delle distribuzioni riflette la quantità di errore di misurazione dello strumento rispetto alla caratteristica di interesse.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">edibleData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span>, ymin <span class="op">=</span> <span class="fl">0</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Tipo di Bacca"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">viridis</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequenza"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>La Figura successiva mostra le distribuzioni dei punteggi in base al tipo di bacca con un cutoff. La linea rossa indica il cutoff: il livello al di sopra del quale le bacche vengono classificate come non commestibili. Ci sono errori su entrambi i lati del cutoff. Sotto il cutoff, ci sono dei falsi negativi (blu): bacche non commestibili erroneamente classificate come commestibili. Sopra il cutoff, ci sono dei falsi positivi (verde): bacche commestibili erroneamente classificate come non commestibili. I costi dei falsi negativi potrebbero includere malattia o morte derivanti dal consumo di bacche non commestibili, mentre i costi dei falsi positivi potrebbero includere maggiore tempo per trovare cibo, insufficienza di cibo e fame.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">density_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_ribbon</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"Tipo di Bacca"</span>,</span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"edible_TN"</span>, <span class="st">"inedible_TP"</span>, <span class="st">"edible_FP"</span>, <span class="st">"inedible_FN"</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Commestibile: TN"</span>, <span class="st">"Non Commestibile: TP"</span>, <span class="st">"Commestibile: FP"</span>, <span class="st">"Non Commestibile: FN"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">cutoff</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Punteggio"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequenza"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>A seconda dei nostri obiettivi di valutazione, potremmo voler usare un diverso rapporto di selezione modificando il cutoff. La Figura mostra le distribuzioni dei punteggi quando si aumenta il cutoff. Ora ci sono più falsi negativi (blu) e meno falsi positivi (verde). Se alziamo il cutoff per essere più conservativi, il numero di falsi negativi aumenta, mentre il numero di falsi positivi diminuisce. Di conseguenza, aumentando il cutoff, la sensibilità e il valore predittivo negativo (NPV) diminuiscono, mentre la specificità e il valore predittivo positivo (PPV) aumentano. Un cutoff più alto potrebbe essere ottimale se i costi dei falsi positivi sono considerati superiori a quelli dei falsi negativi. Ad esempio, se gli alieni non possono rischiare di mangiare bacche non commestibili perché sono fatali, e ci sono abbastanza bacche commestibili per nutrire la colonia aliena.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Raise the cutoff</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">85</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">density_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_ribbon</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"Tipo di Bacca"</span>,</span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"edible_TN"</span>, <span class="st">"inedible_TP"</span>, <span class="st">"edible_FP"</span>, <span class="st">"inedible_FN"</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Commestibile: TN"</span>, <span class="st">"Non Commestibile: TP"</span>, <span class="st">"Commestibile: FP"</span>, <span class="st">"Non Commestibile: FN"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">cutoff</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Punteggio"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequenza"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>In alternativa, possiamo abbassare il cutoff per essere più liberali. La Figura seguente mostra le distribuzioni dei punteggi quando abbassiamo il cutoff. Ora ci sono meno falsi negativi (blu) e più falsi positivi (verde). Abbassando il cutoff, la sensibilità e il NPV aumentano, mentre la specificità e il PPV diminuiscono. Un cutoff più basso potrebbe essere ottimale se i costi dei falsi negativi sono considerati superiori a quelli dei falsi positivi. Ad esempio, se gli alieni non possono rischiare di perdere bacche commestibili perché sono scarse, e mangiare bacche non commestibili comporta solo disagi temporanei.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Lower the cutoff</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">65</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">density_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_ribbon</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"Tipo di Bacca"</span>,</span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fu">viridis</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"edible_TN"</span>, <span class="st">"inedible_TP"</span>, <span class="st">"edible_FP"</span>, <span class="st">"inedible_FN"</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Commestibile: TN"</span>, <span class="st">"Non Commestibile: TP"</span>, <span class="st">"Commestibile: FP"</span>, <span class="st">"Non Commestibile: FN"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">cutoff</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Punteggio"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequenza"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>In sintesi, sensibilità e specificità variano in base al cutoff utilizzato per la classificazione. Se aumentiamo il cutoff, la specificità e il PPV aumentano, mentre la sensibilità e il NPV diminuiscono. Se abbassiamo il cutoff, la sensibilità e il NPV aumentano, mentre la specificità e il PPV diminuiscono. Pertanto, il cutoff ottimale dipende dai costi associati ai falsi negativi e ai falsi positivi. Se i falsi negativi sono più costosi, dovremmo impostare un cutoff basso; se i falsi positivi sono più costosi, dovremmo impostare un cutoff alto.</p>
</section><section id="teoria-della-detezione-del-segnale" class="level2" data-number="82.5"><h2 data-number="82.5" class="anchored" data-anchor-id="teoria-della-detezione-del-segnale">
<span class="header-section-number">82.5</span> Teoria della Detezione del Segnale</h2>
<p>La <em>teoria della detezione del segnale</em> (Signal Detection Theory, SDT) è una teoria probabilistica utilizzata per il rilevamento di uno stimolo (segnale) all’interno di un insieme di stimoli che include anche stimoli non target (rumore). La SDT è nata durante lo sviluppo del radar (<strong>RA</strong>dio <strong>D</strong>etection <strong>A</strong>nd <strong>R</strong>anging) e del sonar (<strong>SO</strong>und <strong>N</strong>avigation <strong>A</strong>nd <strong>R</strong>anging) durante la Seconda Guerra Mondiale, basandosi su ricerche in ambito sensoriale-percettivo. Il settore militare desiderava determinare quali oggetti rilevati da radar/sonar fossero effettivamente aerei o sottomarini nemici, e quali fossero solo rumore (ad esempio, oggetti diversi nell’ambiente).</p>
<p>La SDT ha permesso di valutare il numero di errori commessi dagli operatori (cioè, quanto fossero precisi) e di scomporre tali errori in diverse categorie. La teoria distingue tra <em>sensibilità</em> e <em>bias</em>. Nella SDT, la <em>sensibilità</em> (o discriminabilità) è la capacità di un test di distinguere tra uno stimolo target e stimoli non target, ossia quanto bene il test riesca a rilevare il segnale tra i rumori. Il <em>bias</em> rappresenta invece la tendenza del test a sovrastimare o sottostimare la probabilità di un evento target rispetto al tasso reale di occorrenza di tale evento.</p>
<p>Alcuni operatori radar/sonar non erano molto sensibili alla differenza tra segnale e rumore, a causa di fattori come l’età o la capacità di distinguere sottili variazioni di segnale. Gli individui con bassa sensibilità, che quindi non riuscivano a distinguere efficacemente tra segnale e rumore, venivano esclusi, poiché la sensibilità era considerata una competenza che difficilmente si può insegnare. Altri operatori, pur avendo una buona sensibilità, mostravano bias sistematici o scarsa <em>calibrazione</em>, cioè commettevano errori sistematici nel giudicare i segnali, ad esempio sovra-rifiutando o sotto-rifiutando il target.</p>
<p>Sovra-rifiutare significa produrre molti <em>falsi negativi</em> (cioè, giudicare un segnale sicuro quando in realtà non lo è), mentre sotto-rifiutare genera molti <em>falsi positivi</em> (cioè, giudicare un segnale come pericoloso quando in realtà non lo è). Un operatore con buona sensibilità ma bias sistematico veniva considerato più facile da addestrare rispetto a chi aveva una bassa sensibilità. Gli operatori radar e sonar venivano quindi selezionati in base alla loro sensibilità nel distinguere tra segnale e rumore, e poi addestrati per migliorare la calibrazione e ridurre il bias sistematico, evitando così di sovra- o sotto-rifiutare gli stimoli.</p>
<p>Anche se la SDT è stata sviluppata inizialmente durante la Seconda Guerra Mondiale, oggi ha un ruolo importante in molti ambiti della scienza e della medicina. Un esempio in medicina è il rilevamento di tumori nella radiologia. La SDT è fondamentale anche in psicologia, specialmente nella psicologia cognitiva. Ad esempio, ricerche sulla percezione sociale hanno dimostrato che gli uomini tendono a mostrare una scarsa sensibilità nel distinguere le manifestazioni di interesse sessuale nelle donne, confondendo la cordialità con l’interesse sessuale. Inoltre, gli uomini tendono ad avere un bias sistematico, sovrastimando l’interesse sessuale delle donne nei loro confronti, mostrando così una soglia troppo bassa nel giudicare tali segnali.</p>
<p>Le metriche SDT di sensibilità includono <a href="#dPrimeSDT"><span class="math inline">\(d'\)</span></a> (d-prime), <a href="#aSDT"><span class="math inline">\(A\)</span></a> (o <span class="math inline">\(A'\)</span>), e l’area sotto la curva ROC (Receiver Operating Characteristic). Le metriche di bias includono <a href="#betaSDT"><span class="math inline">\(\beta\)</span></a>, <a href="#cSDT"><span class="math inline">\(c\)</span></a> e <a href="#bSDT"><span class="math inline">\(b\)</span></a>.</p>
<section id="curva-roc-receiver-operating-characteristic" class="level3" data-number="82.5.1"><h3 data-number="82.5.1" class="anchored" data-anchor-id="curva-roc-receiver-operating-characteristic">
<span class="header-section-number">82.5.1</span> Curva ROC (Receiver Operating Characteristic)</h3>
<p>L’asse delle x della curva ROC rappresenta il tasso di falsi allarmi o tasso di falsi positivi (<span class="math inline">\(1 -\)</span> specificità). L’asse delle y rappresenta il tasso di successi o tasso di veri positivi (sensibilità). La curva ROC traccia la combinazione tra sensibilità e specificità per ogni possibile valore di cutoff.</p>
<p>Iniziamo con un cutoff pari a zero (in alto a destra sulla curva ROC). In questo caso, la sensibilità è pari a 1.0 e la specificità è 0, e il punto corrispondente viene tracciato sulla curva. Con un cutoff di zero, il test decide di agire su ogni stimolo (quindi il test è estremamente liberale). Aumentiamo progressivamente il cutoff e tracciamo la sensibilità e la specificità a ogni valore di cutoff. All’aumentare del cutoff, la sensibilità diminuisce e la specificità aumenta.</p>
<p>Terminiamo con il valore di cutoff più alto possibile, dove la sensibilità è pari a 0 e la specificità è 1.0 (in altre parole, il test non agisce mai; quindi è il massimo della conservatività). Ogni punto sulla curva ROC corrisponde a una coppia di tasso di successi (sensibilità) e tasso di falsi allarmi (falsi positivi) risultante da uno specifico valore di cutoff. Dopodiché, possiamo collegare i punti con delle linee o curve per ottenere la curva ROC.</p>
<p>La Figura seguente mostra un esempio empirico di curva ROC, dove le linee connettono i tassi di successi e di falsi allarmi.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">aSAH</span><span class="op">$</span><span class="va">outcome</span>, <span class="va">aSAH</span><span class="op">$</span><span class="va">s100b</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Creiamo ora una curva ROC lisciata, dove viene tracciata una curva continua e adattata per connettere i tassi di successi e di falsi allarmi.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">aSAH</span><span class="op">$</span><span class="va">outcome</span>, <span class="va">aSAH</span><span class="op">$</span><span class="va">s100b</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="area-sotto-la-curva-roc-auc" class="level3" data-number="82.5.2"><h3 data-number="82.5.2" class="anchored" data-anchor-id="area-sotto-la-curva-roc-auc">
<span class="header-section-number">82.5.2</span> Area Sotto la Curva ROC (AUC)</h3>
<p>Le metodologie ROC possono essere utilizzate per confrontare e calcolare il potere discriminativo degli strumenti di misurazione, senza essere influenzati da fattori come il <em>selection ratio</em>, il <em>base rate</em> e i costi e benefici associati. L’analisi ROC fornisce un indice quantitativo di quanto bene uno strumento possa prevedere un segnale di interesse o discriminare tra segnali diversi. Questo approccio ci aiuta a capire con quale frequenza la nostra valutazione è corretta.</p>
<p>Se scegliamo casualmente due osservazioni, e una è corretta mentre l’altra è sbagliata, la precisione sarebbe del 50%, ma questo rifletterebbe una risposta casuale, quindi inutile. L’area geometrica sotto la curva ROC riflette l’accuratezza discriminativa della misura. Questo indice è noto come AUC (Area Under the Curve) della curva ROC. AUC quantifica il potere discriminativo di un test. Più precisamente, AUC rappresenta la probabilità che, selezionando casualmente un target e un non-target, il test classifichi correttamente il target come tale. I valori dell’AUC variano da 0.0 a 1.0, dove 0.5 rappresenta la precisione casuale, come indicato dalla linea diagonale nella curva ROC. Un test è utile nella misura in cui la sua curva ROC si trova sopra la linea diagonale, indicando che la sua accuratezza discriminativa è superiore al caso.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">aSAH</span><span class="op">$</span><span class="va">outcome</span>, <span class="va">aSAH</span><span class="op">$</span><span class="va">s100b</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span>, auc.polygon <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulazione dei dati per AUC</span></span>
<span><span class="va">simulateDataFromAUC</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">auc</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">auc</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">t</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="fl">2.515517</span> <span class="op">+</span> <span class="fl">0.802853</span> <span class="op">*</span> <span class="va">t</span> <span class="op">+</span> <span class="fl">0.0103328</span> <span class="op">*</span> <span class="va">t</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1.432788</span> <span class="op">*</span> <span class="va">t</span> <span class="op">+</span> <span class="fl">0.189269</span> <span class="op">*</span> <span class="va">t</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.001308</span> <span class="op">*</span> <span class="va">t</span><span class="op">**</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">z</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span></span>
<span><span class="va">auc60</span> <span class="op">&lt;-</span> <span class="fu">simulateDataFromAUC</span><span class="op">(</span><span class="fl">.60</span>, <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="va">auc70</span> <span class="op">&lt;-</span> <span class="fu">simulateDataFromAUC</span><span class="op">(</span><span class="fl">.70</span>, <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="va">auc80</span> <span class="op">&lt;-</span> <span class="fu">simulateDataFromAUC</span><span class="op">(</span><span class="fl">.80</span>, <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="va">auc90</span> <span class="op">&lt;-</span> <span class="fu">simulateDataFromAUC</span><span class="op">(</span><span class="fl">.90</span>, <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="va">auc95</span> <span class="op">&lt;-</span> <span class="fu">simulateDataFromAUC</span><span class="op">(</span><span class="fl">.95</span>, <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="va">auc99</span> <span class="op">&lt;-</span> <span class="fu">simulateDataFromAUC</span><span class="op">(</span><span class="fl">.99</span>, <span class="fl">50000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">auc60</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span>, print.auc.x <span class="op">=</span> <span class="fl">.52</span>, print.auc.y <span class="op">=</span> <span class="fl">.61</span>, print.auc.pattern <span class="op">=</span> <span class="st">"%.2f"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">auc70</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span>, print.auc.x <span class="op">=</span> <span class="fl">.6</span>, print.auc.y <span class="op">=</span> <span class="fl">.67</span>, print.auc.pattern <span class="op">=</span> <span class="st">"%.2f"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">auc80</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span>, print.auc.x <span class="op">=</span> <span class="fl">.695</span>, print.auc.y <span class="op">=</span> <span class="fl">.735</span>, print.auc.pattern <span class="op">=</span> <span class="st">"%.2f"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">auc90</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span>, print.auc.x <span class="op">=</span> <span class="fl">.805</span>, print.auc.y <span class="op">=</span> <span class="fl">.815</span>, print.auc.pattern <span class="op">=</span> <span class="st">"%.2f"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">auc95</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span>, print.auc.x <span class="op">=</span> <span class="fl">.875</span>, print.auc.y <span class="op">=</span> <span class="fl">.865</span>, print.auc.pattern <span class="op">=</span> <span class="st">"%.2f"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">roc</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">auc99</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span>, print.auc.x <span class="op">=</span> <span class="fl">.94</span>, print.auc.y <span class="op">=</span> <span class="fl">.94</span>, print.auc.pattern <span class="op">=</span> <span class="st">"%.2f"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Ad esempio, se l’AUC è pari a 0.75, ciò significa che il punteggio complessivo di un individuo che possiede la caratteristica in questione sarà più alto nel 75% dei casi rispetto a quello di un individuo che non la possiede. In termini più semplici, l’AUC fornisce la probabilità che lo strumento classifichi correttamente, se scegliamo casualmente un esito positivo e uno negativo.</p>
<p>L’AUC è un indice più robusto rispetto alla percentuale di accuratezza perché la percentuale di accuratezza può essere influenzata da fattori come il base rate. L’AUC misura quanto un test è migliore del caso nel discriminare tra esiti diversi. Inoltre, è utile come indicatore generale di accuratezza discriminativa, poiché mostra quanto un test sia accurato su tutti i possibili cutoff.</p>
<p>Anche se conoscere l’accuratezza del test a ogni cutoff può essere utile per selezionare il cutoff ottimale, nella realtà non siamo interessati a tutti i possibili cutoff, poiché non tutti gli errori hanno lo stesso costo.</p>
<p>Iniziare {#gettingStarted-prediction}</p>
<p>Caricare le Librerie {#loadLibraries-prediction}</p>
<p>Preparare i Dati {#prepareData-prediction} Caricamento dei Dati {#loadData-prediction}</p>
<p>Il dataset aSAH del pacchetto pROC contiene i punteggi dei test (s100b) e gli esiti clinici (outcome) di pazienti.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">aSAH</span><span class="op">)</span></span>
<span><span class="va">mydataSDT</span> <span class="op">&lt;-</span> <span class="va">aSAH</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per garantire la riproducibilità, imposto il seed qui sotto. L’utilizzo dello stesso seed garantirà gli stessi risultati ogni volta. Non c’è nulla di speciale in questo seed specifico.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span> <span class="op">&lt;-</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span></span>
<span><span class="va">mydataSDT</span> <span class="op">&lt;-</span> <span class="va">mydataSDT</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>testScoreSimple <span class="op">=</span> <span class="fu">ntile</span><span class="op">(</span><span class="va">testScore</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">predictedProbability</span> <span class="op">&lt;-</span></span>
<span>    <span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span>        <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">continuousOutcome</span> <span class="op">&lt;-</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0.20</span>, sd <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span><span class="op">[</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"Good"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span><span class="op">[</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"Poor"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La curva ROC (Receiver Operating Characteristic) mostra la combinazione tra il tasso di successo (o sensibilità) e il tasso di falsi allarmi (<span class="math inline">\(1 - \text{specificità}\)</span>) per ogni possibile soglia di cutoff. La curva dimostra come, all’aumentare della soglia (diventando più conservativa), la sensibilità diminuisce e la specificità aumenta, e viceversa.</p>
<p>Le curve ROC possono essere generate utilizzando il pacchetto pROC, e gli esempi mostrano che la misura ha un’accuratezza moderata—è più accurata del caso, ma c’è margine di miglioramento.</p>
<p>Curva ROC Empirica {#empiricalROC} Il codice per generare una curva ROC empirica è mostrato qui sotto, e il grafico è visibile in Figura <span class="citation" data-cites="ref">(<a href="../../99-references.html#ref-ref" role="doc-biblioref"><strong>ref?</strong></a>)</span>(fig</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rocCurve</span> <span class="op">&lt;-</span> <span class="fu">roc</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mydataSDT</span>, response <span class="op">=</span> <span class="va">disorder</span>, predictor <span class="op">=</span> <span class="va">testScore</span>, smooth <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rocCurve</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Una curva ROC empirica con i cutoff sovrapposti è mostrata</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">prediction</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"testScoreSimple"</span>, <span class="st">"disorder"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">testScoreSimple</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"testScoreSimple"</span>, <span class="st">"disorder"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">disorder</span></span>
<span><span class="op">)</span></span>
<span><span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu">performance</span><span class="op">(</span><span class="va">pred</span>, <span class="st">"tpr"</span>, <span class="st">"fpr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">perf</span>, print.cutoffs.at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, text.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Curva ROC Liscia si ottiene nel modo seguente.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rocCurveSmooth</span> <span class="op">&lt;-</span> <span class="fu">roc</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mydataSDT</span>, response <span class="op">=</span> <span class="va">disorder</span>, predictor <span class="op">=</span> <span class="va">testScore</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rocCurveSmooth</span>, legacy.axes <span class="op">=</span> <span class="cn">TRUE</span>, print.auc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Statistica di Youden J {#youdenJ} La soglia della statistica di Youden J è il punto in cui il test ha la massima combinazione (somma) di sensibilità e specificità: <span class="math inline">\(\text{max}(\text{sensitivity} + \text{specificity} - 1)\)</span>.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">youdenJ</span> <span class="op">&lt;-</span> <span class="fu">coords</span><span class="op">(</span><span class="va">rocCurve</span>, x <span class="op">=</span> <span class="st">"best"</span>, best.method <span class="op">=</span> <span class="st">"youden"</span><span class="op">)</span></span>
<span><span class="va">youdenJthreshold</span> <span class="op">&lt;-</span> <span class="va">youdenJ</span><span class="op">$</span><span class="va">threshold</span></span>
<span><span class="va">youdenJspecificity</span> <span class="op">&lt;-</span> <span class="va">youdenJ</span><span class="op">$</span><span class="va">specificity</span></span>
<span><span class="va">youdenJsensitivity</span> <span class="op">&lt;-</span> <span class="va">youdenJ</span><span class="op">$</span><span class="va">sensitivity</span></span>
<span></span>
<span><span class="va">youdenJ</span></span>
<span><span class="co">#&gt;   threshold specificity sensitivity</span></span>
<span><span class="co">#&gt; 1     0.205       0.806       0.634</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per questo test, la soglia ottimale secondo la statistica di Youden J è <span class="math inline">\(r youdenJthreshold\)</span>, con una sensibilità di <span class="math inline">\(r youdenJsensitivity\)</span> e una specificità di <span class="math inline">\(r youdenJspecificity\)</span>.</p>
<p>Punto più vicino alla parte in alto a sinistra della curva ROC {#topLeftROC} Il punto più vicino alla parte superiore sinistra della curva ROC, dove sensibilità e specificità sono perfette, è dato da: <span class="math inline">\(\text{min}[(1 - \text{sensitivity})^2 + (1 - \text{specificity})^2]\)</span>.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">closestTopLeft</span> <span class="op">&lt;-</span> <span class="fu">coords</span><span class="op">(</span><span class="va">rocCurve</span>, x <span class="op">=</span> <span class="st">"best"</span>, best.method <span class="op">=</span> <span class="st">"closest.topleft"</span><span class="op">)</span></span>
<span><span class="va">closestTopLeftthreshold</span> <span class="op">&lt;-</span> <span class="va">closestTopLeft</span><span class="op">$</span><span class="va">threshold</span></span>
<span><span class="va">closestTopLeftspecificity</span> <span class="op">&lt;-</span> <span class="va">closestTopLeft</span><span class="op">$</span><span class="va">specificity</span></span>
<span><span class="va">closestTopLeftsensitivity</span> <span class="op">&lt;-</span> <span class="va">closestTopLeft</span><span class="op">$</span><span class="va">sensitivity</span></span>
<span></span>
<span><span class="va">closestTopLeft</span></span>
<span><span class="co">#&gt;   threshold specificity sensitivity</span></span>
<span><span class="co">#&gt; 1     0.205       0.806       0.634</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per questo test, la combinazione di sensibilità e specificità è ottimale alla soglia di <span class="math inline">\(r closestTopLeftthreshold\)</span>, con una sensibilità di <span class="math inline">\(r closestTopLeftsensitivity\)</span> e una specificità di <span class="math inline">\(r closestTopLeftspecificity\)</span>.</p>
</section></section><section id="predictionAccuracy" class="level2" data-number="82.6"><h2 data-number="82.6" class="anchored" data-anchor-id="predictionAccuracy">
<span class="header-section-number">82.6</span> Accuratezza della Predizione attraverso i Cutoff</h2>
<p>Esistono due dimensioni principali dell’accuratezza: (1) la <em>discriminazione</em> (ad esempio, <a href="#sensitivity">sensibilità</a>, <a href="#specificity">specificità</a>, <a href="#auc">area sotto la curva ROC</a>) e (2) la <em>calibrazione</em>. Alcuni indici generali di accuratezza combinano la discriminazione e la calibrazione.</p>
<p>Il pacchetto <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> include la funzione <code>accuracyOverall()</code>, che stima l’accuratezza della predizione su tutti i cutoff.</p>
<p>Ecco un esempio di codice che utilizza questa funzione:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">accuracyOverall</span><span class="op">(</span></span>
<span>    predicted <span class="op">=</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span>,</span>
<span>    actual <span class="op">=</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     [,1]</span></span>
<span><span class="co">#&gt; ME                 -0.12</span></span>
<span><span class="co">#&gt; MAE                 0.34</span></span>
<span><span class="co">#&gt; MSE                 0.21</span></span>
<span><span class="co">#&gt; RMSE                0.46</span></span>
<span><span class="co">#&gt; MPE                 -Inf</span></span>
<span><span class="co">#&gt; MAPE                 Inf</span></span>
<span><span class="co">#&gt; sMAPE              82.72</span></span>
<span><span class="co">#&gt; MASE                0.74</span></span>
<span><span class="co">#&gt; RMSLE               0.30</span></span>
<span><span class="co">#&gt; rsquared            0.17</span></span>
<span><span class="co">#&gt; rsquaredAdj         0.17</span></span>
<span><span class="co">#&gt; rsquaredPredictive  0.12</span></span>
<span></span>
<span><span class="fu">accuracyOverall</span><span class="op">(</span></span>
<span>    predicted <span class="op">=</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span>,</span>
<span>    actual <span class="op">=</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span>,</span>
<span>    dropUndefined <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     [,1]</span></span>
<span><span class="co">#&gt; ME                 -0.12</span></span>
<span><span class="co">#&gt; MAE                 0.34</span></span>
<span><span class="co">#&gt; MSE                 0.21</span></span>
<span><span class="co">#&gt; RMSE                0.46</span></span>
<span><span class="co">#&gt; MPE                60.29</span></span>
<span><span class="co">#&gt; MAPE               65.51</span></span>
<span><span class="co">#&gt; sMAPE              82.72</span></span>
<span><span class="co">#&gt; MASE                0.74</span></span>
<span><span class="co">#&gt; RMSLE               0.30</span></span>
<span><span class="co">#&gt; rsquared            0.17</span></span>
<span><span class="co">#&gt; rsquaredAdj         0.17</span></span>
<span><span class="co">#&gt; rsquaredPredictive  0.12</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In questo esempio, la funzione <code>accuracyOverall()</code> calcola l’accuratezza complessiva della predizione su tutta la gamma di cutoff disponibili, fornendo una sintesi del grado di accuratezza globale del modello.</p>
</section><section id="calibration" class="level2" data-number="82.7"><h2 data-number="82.7" class="anchored" data-anchor-id="calibration">
<span class="header-section-number">82.7</span> Calibrazione</h2>
<p>Quando si tratta di un risultato categorico, la calibrazione è il grado in cui una stima probabilistica di un evento riflette la reale probabilità sottostante di quell’evento.<br>
Quando si tratta di un risultato continuo, la calibrazione indica quanto i valori previsti siano vicini ai valori effettivi osservati.<br>
L’importanza di esaminare la calibrazione, oltre alla <em>discriminazione</em>, è descritta da Lindhiem (2020).</p>
<p>La calibrazione è diventata centrale nella valutazione dell’accuratezza delle previsioni meteorologiche.<br>
Ad esempio, nei giorni in cui un meteorologo prevede il 60% di possibilità di pioggia, dovrebbe effettivamente piovere circa il 60% delle volte.<br>
Grazie ai progressi nella comprensione scientifica dei sistemi meteorologici, le previsioni della pioggia sono diventate più accurate.<br>
Le previsioni della National Weather Service, per esempio, sono ben calibrate.<br>
Tuttavia, le previsioni di pioggia fatte da meteorologi televisivi locali possono essere esagerate per aumentare l’audience (Silver, 2012).<br>
Curiosamente, alcune previsioni di pioggia di The Weather Channel risultano miscalibrate in certe condizioni (Bickel, 2008).<br>
Ad esempio, nei giorni in cui viene prevista una probabilità di pioggia del 20%, la probabilità reale è in realtà intorno al 5%.<br>
Questa miscalibrazione è deliberata, poiché le persone tendono a essere più arrabbiate se viene detto loro che non pioverà e invece piove (falsi negativi) rispetto al contrario (falsi positivi).<br>
Come osserva Silver (2012), “Se piove quando non dovrebbe, le persone si arrabbiano con il meteorologo, mentre una giornata inaspettatamente soleggiata è vista come un bonus fortuito.”</p>
<p>La calibrazione non è importante solo per le previsioni meteorologiche, ma anche per la valutazione psicologica.<br>
Esistono diversi metodi per esaminare la calibrazione, come i <em>Brier Scores</em>, il test di Hosmer-Lemeshow, lo <em>z</em> di Spiegelhalter e la differenza media tra i valori previsti e osservati a diversi intervalli di soglie, rappresentata graficamente tramite un <em>calibration plot</em>.</p>
<section id="calibrationPlot" class="level3" data-number="82.7.1"><h3 data-number="82.7.1" class="anchored" data-anchor-id="calibrationPlot">
<span class="header-section-number">82.7.1</span> Calibration Plot</h3>
<p>Un <em>calibration plot</em> può aiutare a individuare la miscalibrazione.<br>
Questo grafico rappresenta la probabilità prevista di un evento sull’asse x e la probabilità effettiva osservata sull’asse y.<br>
Le previsioni sono suddivise in gruppi (spesso 10).<br>
La linea diagonale rappresenta previsioni perfettamente calibrate.<br>
Quando le previsioni si discostano da questa linea, indicano miscalibrazione.<br>
Esistono quattro pattern generali di miscalibrazione: <em>overextremity</em>, <em>underextremity</em>, <em>overprediction</em>, e <em>underprediction</em>.</p>
<ul>
<li>
<em>Overextremity</em> si verifica quando le probabilità previste sono troppo vicine agli estremi (zero o uno).<br>
</li>
<li>
<em>Underextremity</em> accade quando le probabilità previste sono troppo lontane dagli estremi.<br>
</li>
<li>
<em>Overprediction</em> si ha quando le probabilità previste sono costantemente maggiori di quelle osservate.<br>
</li>
<li>
<em>Underprediction</em> si ha quando le probabilità previste sono costantemente minori di quelle osservate.</li>
</ul>
<p>Per generare un <em>calibration plot</em>, possiamo utilizzare il pacchetto <code>PredictABEL</code>. Di seguito è riportato un esempio di codice in R per creare questo grafico:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">aSAH</span><span class="op">)</span></span>
<span><span class="va">mydataSDT</span> <span class="op">&lt;-</span> <span class="va">aSAH</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span> <span class="op">&lt;-</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span></span>
<span><span class="va">mydataSDT</span> <span class="op">&lt;-</span> <span class="va">mydataSDT</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>testScoreSimple <span class="op">=</span> <span class="fu">ntile</span><span class="op">(</span><span class="va">testScore</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">predictedProbability</span> <span class="op">&lt;-</span></span>
<span>    <span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span>        <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">s100b</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">continuousOutcome</span> <span class="op">&lt;-</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0.20</span>, sd <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span><span class="op">[</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"Good"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span><span class="op">[</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"Poor"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">colNumberOutcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">)</span> <span class="op">==</span> <span class="st">"disorder"</span><span class="op">)</span></span>
<span><span class="va">myDataNoMissing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plotCalibration</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">myDataNoMissing</span><span class="op">)</span>,</span>
<span>    cOutcome <span class="op">=</span> <span class="va">colNumberOutcome</span>,</span>
<span>    predRisk <span class="op">=</span> <span class="va">myDataNoMissing</span><span class="op">$</span><span class="va">predictedProbability</span>,</span>
<span>    groups <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $Table_HLtest</span></span>
<span><span class="co">#&gt;                 total meanpred meanobs predicted observed</span></span>
<span><span class="co">#&gt; [0.0000,0.0245)    20    0.013   0.200      0.26        4</span></span>
<span><span class="co">#&gt; 0.0245              7    0.025   0.143      0.17        1</span></span>
<span><span class="co">#&gt; 0.0294              8    0.029   0.250      0.24        2</span></span>
<span><span class="co">#&gt; [0.0343,0.0441)    14    0.036   0.214      0.50        3</span></span>
<span><span class="co">#&gt; [0.0441,0.0588)    11    0.051   0.364      0.56        4</span></span>
<span><span class="co">#&gt; [0.0588,0.0686)     8    0.061   0.125      0.49        1</span></span>
<span><span class="co">#&gt; [0.0686,0.1324)    12    0.094   0.417      1.12        5</span></span>
<span><span class="co">#&gt; [0.1324,0.2059)    12    0.165   0.583      1.98        7</span></span>
<span><span class="co">#&gt; [0.2059,0.2598)    10    0.222   0.300      2.22        3</span></span>
<span><span class="co">#&gt; [0.2598,1.0000]    11    0.408   1.000      4.49       11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Chi_square</span></span>
<span><span class="co">#&gt; [1] 154</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_value</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_prediction_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questo <em>calibration plot</em> mostra che le probabilità previste erano consistentemente inferiori a quelle effettive osservate, suggerendo un problema di <em>underprediction</em>. Per correggere questa miscalibrazione, le probabilità previste dovrebbero essere aumentate affinché risultino coerenti con quelle osservate.</p>
<section id="brierScores" class="level4" data-number="82.7.1.1"><h4 data-number="82.7.1.1" class="anchored" data-anchor-id="brierScores">
<span class="header-section-number">82.7.1.1</span> Brier Scores</h4>
</section><section id="brierScores" class="level4" data-number="82.7.1.2"><h4 data-number="82.7.1.2" class="anchored" data-anchor-id="brierScores">
<span class="header-section-number">82.7.1.2</span> Brier Scores</h4>
<p>I punteggi di Brier (<em>Brier scores</em>) offrono una misura di accuratezza per le previsioni probabilistiche, valutando quanto le probabilità previste si avvicinino ai risultati reali. Questo punteggio è calcolato come la media dei quadrati delle differenze tra le probabilità previste e i risultati osservati, permettendo di valutare la qualità delle previsioni considerando sia errori di sovrastima che di sottostima.</p>
<p>Un punteggio di Brier basso indica una migliore calibrazione delle previsioni, con un valore di 0 che rappresenta una previsione perfettamente calibrata (cioè, le probabilità previste coincidono esattamente con i risultati osservati). Valori più vicini a 1 indicano invece una calibrazione peggiore, suggerendo che le previsioni si discostano ampiamente dai risultati effettivi.</p>
<p>Il pacchetto <code>rms</code> di R può essere utilizzato per calcolare i punteggi di Brier, come mostrato nell’esempio seguente:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">val.prob</span><span class="op">(</span></span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">predictedProbability</span>,</span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span>,</span>
<span>    pl <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="st">"Brier"</span><span class="op">]</span></span>
<span><span class="co">#&gt; Brier </span></span>
<span><span class="co">#&gt; 0.261</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In sintesi, il punteggio di Brier rappresenta una misura sintetica della precisione e della calibrazione di un modello predittivo: quanto più è basso, tanto maggiore è la capacità del modello di riflettere accuratamente le probabilità reali.</p>
</section></section></section><section id="matrice-di-confusione" class="level2" data-number="82.8"><h2 data-number="82.8" class="anchored" data-anchor-id="matrice-di-confusione">
<span class="header-section-number">82.8</span> Matrice di Confusione</h2>
<p>Una matrice di confusione (detta anche tabella 2x2 di accuratezza, tabella di cross-tabulation o tabella di contingenza) è una matrice utilizzata per i dati categoriali che mostra l’esito predetto su una dimensione e l’esito reale (la verità) sull’altra. Se le predizioni e gli esiti sono dicotomici, la matrice di confusione è una matrice 2x2 con due righe e due colonne che rappresentano le quattro possibili combinazioni previste-reali (i cosiddetti outcome decisionali). In questo caso, la matrice di confusione fornisce un conteggio tabellare dei casi corretti (true positives e true negatives) rispetto agli errori (false positives e false negatives).</p>
<p>Conteggio Assoluto {#confusionMatrix-number}</p>
<p>È possibile visualizzare i dati di una matrice di confusione utilizzando il seguente codice:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">0.205</span></span>
<span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span><span class="op">[</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span> <span class="op">&lt;</span> <span class="va">cutoff</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span><span class="op">[</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">testScore</span> <span class="op">&gt;=</span> <span class="va">cutoff</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosisFactor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Decision: Diagnosis"</span>, <span class="st">"Decision: No Diagnosis"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorderFactor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Truth: Disorder"</span>, <span class="st">"Truth: No Disorder"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosisFactor</span>, <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorderFactor</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         </span></span>
<span><span class="co">#&gt;                          Truth: Disorder Truth: No Disorder</span></span>
<span><span class="co">#&gt;   Decision: Diagnosis                 26                 14</span></span>
<span><span class="co">#&gt;   Decision: No Diagnosis              15                 58</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Conteggio con Margini Aggiunti {#confusionMatrix-numberMargins}</p>
<p>Per aggiungere i margini ai conteggi assoluti:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosisFactor</span>, <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorderFactor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         </span></span>
<span><span class="co">#&gt;                          Truth: Disorder Truth: No Disorder Sum</span></span>
<span><span class="co">#&gt;   Decision: Diagnosis                 26                 14  40</span></span>
<span><span class="co">#&gt;   Decision: No Diagnosis              15                 58  73</span></span>
<span><span class="co">#&gt;   Sum                                 41                 72 113</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per calcolare le proporzioni:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosisFactor</span>, <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorderFactor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         </span></span>
<span><span class="co">#&gt;                          Truth: Disorder Truth: No Disorder</span></span>
<span><span class="co">#&gt;   Decision: Diagnosis              0.230              0.124</span></span>
<span><span class="co">#&gt;   Decision: No Diagnosis           0.133              0.513</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aggiungi i margini alle proporzioni:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosisFactor</span>, <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorderFactor</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         </span></span>
<span><span class="co">#&gt;                          Truth: Disorder Truth: No Disorder   Sum</span></span>
<span><span class="co">#&gt;   Decision: Diagnosis              0.230              0.124 0.354</span></span>
<span><span class="co">#&gt;   Decision: No Diagnosis           0.133              0.513 0.646</span></span>
<span><span class="co">#&gt;   Sum                              0.363              0.637 1.000</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="truePositive" class="level3" data-number="82.8.1"><h3 data-number="82.8.1" class="anchored" data-anchor-id="truePositive">
<span class="header-section-number">82.8.1</span> True Positives (TP)</h3>
<p>I <em>true positives</em> (TP) sono i casi in cui una classificazione positiva (ad esempio, la presenza di un disturbo) è corretta, ovvero il test indica che la classificazione è presente, e lo è davvero. Più alto è il numero di <em>true positives</em> rispetto alla dimensione del campione, maggiore è l’accuratezza. La formula per calcolare i <em>true positives</em> è:</p>
<p><span class="math display">\[
TP = BR \times SR \times N
\]</span></p>
<p>Ecco come calcolare i true positives in R:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span></span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span> <span class="op">==</span> <span class="fl">1</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TPvalue</span></span>
<span><span class="co">#&gt; [1] 26</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="trueNegative" class="level3" data-number="82.8.2"><h3 data-number="82.8.2" class="anchored" data-anchor-id="trueNegative">
<span class="header-section-number">82.8.2</span> True Negatives (TN)</h3>
<p>I <em>true negatives</em> (TN) sono i casi in cui una classificazione negativa (assenza di disturbo) è corretta, ovvero il test indica che la classificazione non è presente e questa effettivamente non è presente. La formula per calcolare i <em>true negatives</em> è:</p>
<p><span class="math display">\[
TN = (1 - BR) \times (1 - SR) \times N
\]</span></p>
<p>Per calcolare i true negatives in R:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TNvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span></span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TNvalue</span></span>
<span><span class="co">#&gt; [1] 58</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="falsePositive" class="level3" data-number="82.8.3"><h3 data-number="82.8.3" class="anchored" data-anchor-id="falsePositive">
<span class="header-section-number">82.8.3</span> False Positives (FP)</h3>
<p>I <em>false positives</em> (FP) sono i casi in cui una classificazione positiva è errata, ovvero il test indica la presenza di un disturbo che in realtà non è presente. Valori più bassi di <em>false positives</em> riflettono una maggiore accuratezza. La formula per calcolare i <em>false positives</em> è:</p>
<p><span class="math display">\[
FP = (1 - BR) \times SR \times N
\]</span></p>
<p>Ecco come calcolare i false positives in R:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FPvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span></span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FPvalue</span></span>
<span><span class="co">#&gt; [1] 14</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="falseNegative" class="level3" data-number="82.8.4"><h3 data-number="82.8.4" class="anchored" data-anchor-id="falseNegative">
<span class="header-section-number">82.8.4</span> False Negatives (FN)</h3>
<p>I <em>false negatives</em> (FN) sono i casi in cui una classificazione negativa è errata, ovvero il test indica l’assenza di un disturbo che in realtà è presente. Valori più bassi di <em>false negatives</em> riflettono una maggiore accuratezza. La formula per calcolare i <em>false negatives</em> è:</p>
<p><span class="math display">\[
FN = BR \times (1 - SR) \times N
\]</span></p>
<p>Per calcolare i false negatives in R:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FNvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span></span>
<span>    <span class="va">mydataSDT</span><span class="op">$</span><span class="va">diagnosis</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">mydataSDT</span><span class="op">$</span><span class="va">disorder</span> <span class="op">==</span> <span class="fl">1</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FNvalue</span></span>
<span><span class="co">#&gt; [1] 15</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sampleSize-prediction" class="level3" data-number="82.8.5"><h3 data-number="82.8.5" class="anchored" data-anchor-id="sampleSize-prediction">
<span class="header-section-number">82.8.5</span> Dimensione del Campione (<em>N</em>)</h3>
<p>La dimensione del campione può essere calcolata sommando il numero di TP, TN, FP e FN:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sampleSize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">TP</span>, <span class="va">TN</span>, <span class="va">FP</span>, <span class="va">FN</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">value</span> <span class="op">&lt;-</span> <span class="va">TP</span> <span class="op">+</span> <span class="va">TN</span> <span class="op">+</span> <span class="va">FP</span> <span class="op">+</span> <span class="va">FN</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">sampleSize</span><span class="op">(</span></span>
<span>    TP <span class="op">=</span> <span class="va">TPvalue</span>,</span>
<span>    TN <span class="op">=</span> <span class="va">TNvalue</span>,</span>
<span>    FP <span class="op">=</span> <span class="va">FPvalue</span>,</span>
<span>    FN <span class="op">=</span> <span class="va">FNvalue</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 113</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-petersen2024principles" class="csl-entry" role="listitem">
Petersen, I. T. (2024). <em>Principles of psychological assessment: With applied examples in R</em>. CRC Press.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/testing_psicologico\/intro\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/lgm/11_lgm_wais.html" class="pagination-link" aria-label="Lo Sviluppo dell'Intelligenza">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Lo Sviluppo dell’Intelligenza</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/networks/01_networks.html" class="pagination-link" aria-label="Network psicologici">
        <span class="nav-page-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Network psicologici</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Testing Psicologico</strong> è una dispensa scritta da Corrado Caudek.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>