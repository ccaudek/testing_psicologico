# ✏ Esercizi

```{r}
source("../../code/_common.R")
library("rio")
library("psych")
```

## Introduzione allo Scaling di Thurstone

Lo scaling di Thurstone, sviluppato da Louis Leon Thurstone nel 1931, è un approccio statistico che mira a modellare dati di ranking soggettivo. I dati di ranking soggettivo si producono quando le persone ordinano un insieme di elementi o stimoli secondo un criterio particolare. Questo tipo di dati è particolarmente utile quando è più semplice per i partecipanti esprimere una preferenza relativa piuttosto che stime quantitative precise.

### Il Modello Thurstoniano 

Il modello Thurstoniano rappresenta un approccio statistico per analizzare e interpretare le preferenze o i ranking individuali rispetto a vari oggetti o stimoli. Questo modello si basa sull'idea che esista una scala latente, ovvero una dimensione non direttamente osservabile, attorno alla quale si distribuiscono i ranking individuali. In altre parole, ogni individuo assegna un punteggio ad ogni oggetto basandosi su criteri personali, ma queste valutazioni individuali sono influenzate da una percezione collettiva o aggregata che può essere descritta su una scala continua latente.

Il principale obiettivo del modello Thurstoniano è di trasformare queste medie di ranking latenti aggregati, che esistono su una scala continua, in un ranking discreto che possiamo interpretare più facilmente. Per farlo, il modello si avvale di alcune ipotesi chiave:

1. **Distribuzione Gaussiana**: Si assume che il ranking latente per ciascun oggetto possa essere descritto da una distribuzione gaussiana. 

2. **Media Differenziata, Varianza Costante**: Il modello presuppone che le distribuzioni gaussiane dei ranking per ciascun oggetto differiscano tra loro solo per la media, mantenendo costante la varianza (scaling di Thurstone caso V). Questo implica che, sebbene gli oggetti possano avere livelli di preferenza medi diversi (alcuni potrebbero essere generalmente preferiti ad altri), la variabilità delle valutazioni (quanto le opinioni dei rispondenti differiscono tra loro) è la stessa per tutti gli oggetti.

Per posizionare gli oggetti sulla scala di Thurstone, si procede nel seguente modo:

- Si calcola la proporzione di rispondenti che preferiscono un oggetto rispetto a ciascuno degli altri.
- Si determinano i corrispondenti percentile (z-scores) della distribuzione cumulativa normale, che ci dicono quante deviazioni standard un valore è distante dalla media.
- Si calcola la media di questi z-scores per ciascun oggetto.

**Esempio Pratico**

Immaginiamo di avere tre oggetti: A, B e C. Dopo aver raccolto le preferenze, scopriamo che:

- Il 70% dei rispondenti preferisce A rispetto a B e C.
- Il 50% dei rispondenti preferisce B rispetto ad A, ma solo il 30% lo preferisce a C.
- Il 80% dei rispondenti preferisce C rispetto a B, ma solo il 50% lo preferisce ad A.

Trasformando queste percentuali in z-scores, possiamo ottenere una misura della "distanza" di ciascun oggetto dalla media sulla scala latente. Mediando questi z-scores, possiamo creare un ranking discreto che riflette le preferenze medie aggregate, permettendoci di interpretare quali oggetti sono generalmente preferiti rispetto ad altri secondo il modello Thurstoniano.

**Soluzione**

Ecco il codice R per risolvere il problema utilizzando il modello Thurstoniano per trasformare le preferenze in z-score e calcolare il ranking latente. 

```{r}
# Definizione delle percentuali di preferenza
preferences <- data.frame(
  obj1 = c("A", "A", "B", "B", "C", "C"),
  obj2 = c("B", "C", "A", "C", "B", "A"),
  p = c(0.70, 0.70, 0.50, 0.30, 0.80, 0.50)
)

# Conversione delle percentuali in z-score
preferences <- preferences %>%
  mutate(z = qnorm(p))

preferences
```

```{r}
# Creazione della matrice delle preferenze
objects <- unique(c(preferences$obj1, preferences$obj2))
objects

z_matrix <- matrix(0, nrow = length(objects), ncol = length(objects),
                   dimnames = list(objects, objects))

# Popolamento della matrice
for (i in 1:nrow(preferences)) {
  z_matrix[preferences$obj1[i], preferences$obj2[i]] <- preferences$z[i]
  z_matrix[preferences$obj2[i], preferences$obj1[i]] <- -preferences$z[i]
}

# Calcolo dei punteggi latenti medi per ogni oggetto
latent_scores <- rowMeans(z_matrix)

# Creazione del data frame con il ranking
ranking <- data.frame(
  Oggetto = names(latent_scores),
  Punteggio_Latente = latent_scores
) %>%
  arrange(desc(Punteggio_Latente)) %>%
  mutate(Ranking = row_number())

# Stampa del ranking finale
print(ranking)
```

Spiegazione:

1. **Definizione delle preferenze**: Creiamo un data frame con le coppie di oggetti confrontati e le percentuali di preferenza.
2. **Trasformazione in z-score**: Convertiamo le percentuali in z-score usando `qnorm()`.
3. **Creazione della matrice delle preferenze**: Inizializziamo una matrice quadrata con gli oggetti e assegnamo gli z-score alle rispettive posizioni.
4. **Calcolo del punteggio latente**: Per ogni oggetto, calcoliamo la media degli z-score rispetto agli altri oggetti.
5. **Creazione del ranking**: Ordiniamo gli oggetti in base ai punteggi latenti.

Il risultato mostrerà un ranking basato sulle preferenze aggregate, riflettendo l'ordine degli oggetti sulla scala latente di preferenza.

## Studio sulle preferenze riguardanti le caratteristiche dell'occupazione ideale

I dati utilizzati in questo studio sono stati raccolti nell'ambito di una ricerca sulla motivazione lavorativa condotta da Ilke Inceoglu. Nel corso di questa indagine, 1079 partecipanti sono stati invitati a classificare nove aspetti lavorativi in base all'importanza che desideravano che fossero presenti nella loro occupazione ideale:

1. Ambiente di Supporto (Supporto)
2. Lavoro Stimolante (Sfida)
3. Progressione di Carriera (Carriera)
4. Lavoro Etico (Etica)
5. Controllo sul Lavoro, Impatto Personale (Autonomia)
6. Sviluppo (Sviluppo)
7. Interazione Sociale (Interazione)
8. Ambiente Competitivo (Competizione)
9. Ambiente Piacevole e Sicuro (Sicurezza)

Un punteggio di 1 attribuito a qualsiasi aspetto lavorativo indica che tale aspetto era il più importante per quel partecipante, mentre un punteggio di 9 indica che era il meno importante.

```{r}
JobFeatures <- rio::import("../../data/JobFeatures.txt")
glimpse(JobFeatures)
```

Consideriamo i dati del primo rispondente:

```{r}
JobFeatures[1, ]
```

Questo rispondente ha risposto assegnando la caratteristica più importante dell'impego a "Interaction", seguita da "Autonomy". L'ultima preferenza è "Safety".

Eseguiamo lo scaling di Thurstone usando la funzione `thurstone` del pacchetto psych:

```{r}
scaling <- psych::thurstone(JobFeatures, ranks = TRUE)
```

Gli attributi dell'oggetto `scaling` prodotto da `thurstone()` possono essere elencati nel modo seguente.

```{r}
attributes(scaling)
```

I risultati dello scaling si ottengono nel modo seguente. Sono elencati nell'ordine fornito sopra, ovvero Support,	Challenge,	Career,	Ethics,	Autonomy,	Development,	Interaction,	Competition	e Safety.

Una media alta indica che i partecipanti attribuiscono un alto valore a questo aspetto lavorativo rispetto agli altri. Tuttavia, poiché le preferenze sono sempre relative, è impossibile identificare in maniera univoca tutte le medie. Pertanto, una delle medie deve essere fissata a un valore arbitrario. È consuetudine fissare la media dell'aspetto meno preferito a 0. Quindi, tutte le altre medie sono positive.

```{r}
scaling$scale |> print()
```

La media più bassa (0.0) corrisponde all'8° aspetto, Competizione, mentre la media più alta (1.04) corrisponde al 6° aspetto, Sviluppo. Ciò significa che l'ambiente competitivo era il meno desiderato, mentre le opportunità di sviluppo personale erano le più desiderate dalle persone nel loro lavoro ideale. Gli altri aspetti sono stati valutati come aventi un'importanza relativa intermedia a queste due, con Sicurezza che ha una media bassa (0.23) - appena superiore a 0 per la Competizione, mentre Supporto, Sfida, Carriera ed Etica hanno medie simili (intorno a 0.9). Autonomia e Interazione hanno medie moderate simili intorno a 0.6.

L'istruzione seguente produce una matrice 9x9 contenente le proporzioni dei partecipanti nel campione che hanno preferito l'aspetto nella colonna rispetto all'aspetto nella riga. Nella matrice risultante, le righe e le colonne seguono l'ordine delle variabili nel file originale.

```{r}
scaling$choice |> 
  round(2)
```

Il valore maggiore è

```{r}
max(scaling$choice)
```

Questo valore, 0.8526, rappresenta la proporzione di partecipanti che hanno preferito l'8° aspetto, Competizione, al 6° aspetto, Sviluppo, ed è il valore più grande nella matrice precedente: questa coppia di caratteristiche ha la preferenza più decisa per un aspetto rispetto all'altro.

La preferenza più decisa in termini di proporzioni di persone che scelgono un aspetto rispetto all'altro deve avere la maggiore distanza/differenza sulla scala delle preferenze soggettive (il 6° aspetto, Sviluppo, deve avere una preferenza percepita media molto più alta dell'8° aspetto, Competizione). Questo risultato è effettivamente in linea con i risultati per le medie di utilità, dove la media dello Sviluppo è la più alta con un valore di 1.04 e la Competizione è la più bassa con un valore di 0.

Consideriamo i residui del modello:

```{r}
scaling$residual |> 
  round(2)
```

L'istruzione precedente produce una matrice 9x9 contenente le differenze tra le proporzioni osservate (la matrice delle scelte) e le proporzioni attese (proporzioni che preferiscono l'aspetto nella riga rispetto all'aspetto nella colonna, che sarebbe atteso in base alle distribuzioni normali standard delle preferenze soggettive intorno alle medie scalate come sopra). Gli scarti tra i valori attesi e quelli osservati sono il modo più diretto di misurare se un modello (in questo caso, il modello proposto da Thurstone) "si adatta" ai dati osservati. Gli scarti piccoli (vicini allo zero) indicano che ci sono piccole discrepanze tra le scelte osservate e le scelte previste dal modello; il che significa che il modello che abbiamo adottato è piuttosto buono. 

Infine, esaminiamo un indice di bontà di adattamento:

```{r}
scaling$GF
```

Il valore GF (Goodness of Fit) viene calcolato come 1 meno la somma dei residui al quadrato divisi per i valori osservati al quadrato. Quando i residui sono quasi zero, i loro rapporti al quadrato rispetto alle proporzioni osservate dovrebbero anch'essi avvicinarsi a zero. Di conseguenza, l'indice di bontà di adattamento di un modello ben adattato dovrebbe essere vicino a 1.

Nella nostra analisi, tutti i residui sono notevolmente piccoli, indicando una stretta corrispondenza tra le scelte osservate (proporzioni di preferenze per una caratteristica rispetto a un'altra). Questo allineamento preciso si riflette nell'indice GF, che è quasi 1, suggerendo che il modello di Thurstone cattura adeguatamente le proprietà dei dati relativi alle caratteristiche dell'occupazione ideale.

## Considerazioni conclusive

Questa metodologia, introdotta da Louis Leon Thurstone negli anni '20, rappresenta una delle forme più semplici e intuitive di scaling, dove per "scaling" si intende il processo di costruzione di un ordinamento di valori lungo un continuum psicologico. Lo scaling thurstoniano si basa sulla premessa che sia possibile ordinare stimoli o concetti secondo il grado in cui incarnano una certa proprietà psicologica, creando così una scala di misura che riflette le percezioni, le attitudini o i giudizi degli individui.

Uno degli aspetti centrali dello scaling di Thurstone, in particolare il caso V della sua legge del giudizio comparativo, è l'assunzione che le distribuzioni di ranking degli stimoli abbiano varianze uguali. Questa ipotesi, pur facilitando la modellizzazione matematica e l'interpretazione dei dati, è stata oggetto di critiche poiché difficilmente riscontrabile nella pratica. Le varianze possono differire significativamente tra gli stimoli a seconda della coerenza dei giudizi degli individui e della natura degli stimoli stessi. Questa limitazione ha stimolato lo sviluppo e l'adozione di metodi alternativi più flessibili per affrontare la complessità dello scaling psicologico.

Un'ulteriore criticità metodologica, spesso poco discussa, riguarda la falsificazione della coerenza interna del modello. Ad esempio, nello scaling di Mokken si assume la monotonicità, ovvero che la probabilità di una risposta positiva a un item aumenti monotonamente con l'aumentare del livello del tratto psicologico misurato. Tale assunzione può essere esplicitamente verificata sui dati empirici, e quando viene violata indica un problema di validità interna della scala. Lo scaling di Thurstone, tuttavia, non prevede procedure sistematiche o strumenti consolidati per testare esplicitamente e falsificare la validità interna del modello. In altre parole, se gli individui forniscono risposte non coerenti con l'assunzione di uguale varianza o di un unico continuum psicologico comune, il modello thurstoniano stesso non offre criteri chiari per identificare e gestire tali violazioni. Questa assenza di procedure di falsificazione interna rappresenta uno dei limiti più significativi del modello di Thurstone.

Nel panorama contemporaneo, l'approccio più diffuso e metodologicamente avanzato per lo scaling psicologico deriva dalla Teoria della Risposta all'Item (IRT). L'IRT supera alcune delle limitazioni intrinseche allo scaling thurstoniano offrendo un quadro teorico e metodologico che considera la probabilità di una certa risposta a un item in funzione delle caratteristiche dell'item stesso e del livello dell'attributo psicologico del rispondente. Questo approccio permette di gestire in modo più efficace la varianza tra gli stimoli, di testare esplicitamente assunzioni chiave (come la monotonicità e l'indipendenza locale) e di fornire stime più accurate delle proprietà psicometriche degli item e delle caratteristiche degli individui.

In conclusione, mentre lo scaling thurstoniano ha rappresentato un passo fondamentale nello sviluppo degli strumenti di misurazione in psicologia, l'evoluzione metodologica e teorica ha portato a preferire approcci basati sull'IRT. Questo non diminuisce il valore storico e didattico dello scaling di Thurstone, che continua a essere un esempio introduttivo prezioso per comprendere i concetti fondamentali dello scaling psicologico. Tuttavia, è nell'ambito della IRT che attualmente si trovano le soluzioni più robuste e sofisticate per affrontare le sfide della misurazione psicologica, guidando la ricerca e l'applicazione pratica nel campo della psicometria contemporanea.

## Sesssion Info

```{r}
sessionInfo()
```

