# Punteggi e scale {#sec-measurement-scores}

**Prerequisiti**

- Leggere i capitoli 1, *Scores and Scales*, e 2, *Constructs*, del testo *Principles of psychological assessment* di @petersen2024principles. 
- Si consiglia di ripassare i concetti fondamentali della teoria delle probabilità, in particolare le distribuzioni di massa e di densità di probabilità. Per approfondire, si rimanda al materiale didattico dell'insegnamento di Psicometria disponibile al link [https://ccaudek.github.io/psicometria-r/].
- Lettere *A Tutorial on Regression-Based Norming of Psychological Tests With GAMLSS* [@timmerman2021tutorial].

**Concetti e Competenze Chiave**

- Tipologie di dati e loro implicazioni.
- Punteggi grezzi e trasformati.
- Interpretazioni basate sulla norma e sul criterio.
- Metodi di normazione: tradizionale vs regressione;
- Teoria della Risposta agli Item (IRT) e punteggi standardizzati.

**Preparazione del Notebook**

```{r}
# Carica il file _common.R per impostazioni di pacchetti e opzioni
here::here("code", "_common.R") |> source()

# Carica pacchetti aggiuntivi
pacman::p_load(MASS, nortest, missForest, aspect)
```


## Introduzione 

Questo capitolo si propone di introdurre l'utilizzo del software "R", ponendo l'attenzione sulla differenza tra valutazioni normative e criteriali. 

## Tipologie di Dati

Si possono identificare quattro principali categorie di dati: nominali, ordinali, di intervallo e di rapporto. È opportuno notare che, in funzione dell'utilizzo della variabile, i dati possono rientrare in più di una categoria. La tipologia del dato influisce significativamente sulle modalità di analisi applicabili. A titolo esemplificativo, l'analisi statistica parametrica (come la regressione lineare) presuppone che i dati siano di intervallo o di rapporto.

### Dati Nominali

I dati nominali si configurano come categorie distinte, caratterizzate da natura categorica e prive di ordinamento. Tali dati non esprimono affermazioni di natura quantitativa, bensì rappresentano entità nominabili (ad esempio, "felino" e "canino"). Sebbene possano essere rappresentati numericamente, come nel caso dei codici postali o dei codici identificativi di genere, etnia o razza dei partecipanti, è fondamentale sottolineare che valori numerici più elevati non riflettono livelli superiori (o inferiori) del costrutto, in quanto i numeri rappresentano meramente categorie prive di ordine intrinseco.

### Dati Ordinali

I dati ordinali si distinguono per essere categorie ordinate: possiedono una denominazione e un ordine. Non forniscono informazioni sulla distanza concettuale tra i ranghi, ma indicano esclusivamente che valori più elevati rappresentano livelli superiori (o inferiori) del costrutto. Un esempio paradigmatico è costituito dalle posizioni in classifica successive a una competizione: il concorrente classificato al primo posto ha concluso la gara prima del secondo classificato, il quale a sua volta ha preceduto il terzo (1 > 2 > 3 > 4). È cruciale evidenziare che la distanza concettuale tra numeri adiacenti non è necessariamente equivalente.

### Dati di Intervallo

I dati di intervallo sono caratterizzati da un ordine e da distanze significative (ovvero, intervalli equidistanti). Questi dati consentono operazioni di somma (ad esempio, 2 dista 2 unità da 4), ma non di moltiplicazione ($2 \times 2 \ne 4$). Esempi emblematici sono le temperature espresse in gradi Fahrenheit o Celsius: 100 gradi Fahrenheit non equivalgono al doppio di 50 gradi Fahrenheit. È importante sottolineare che, sebbene in psicologia molti dati presentino la medesima distanza matematica tra gli intervalli, è probabile che tali intervalli non rappresentino la medesima distanza concettuale.

### Dati di Rapporto

I dati di rapporto si distinguono per essere ordinati, caratterizzati da distanze significative e da uno zero assoluto che rappresenta l'assenza del costrutto. In questa tipologia di dati, le relazioni moltiplicative risultano valide. Un esempio paradigmatico è la temperatura espressa in gradi Kelvin: 100 gradi Kelvin corrispondono effettivamente al doppio di 50 gradi Kelvin. Nel campo della psicologia, l'aspirazione a disporre di scale di rapporto persiste, nonostante la difficoltà di definire uno zero assoluto per i costrutti psicologici: come si potrebbe, infatti, concettualizzare l'assenza totale di depressione?

## Punteggi Grezzi e Trasformati

Nell'ambito dei test psicometrici, il **punteggio grezzo** costituisce la valutazione più immediata e si basa sulla somma delle risposte categorizzate, come quelle corrette o errate, o vero o falso. Nonostante la sua immediatezza, il punteggio grezzo presenta limitazioni interpretative, poiché non considera fattori contestuali quali il numero totale di domande o il livello di difficoltà di queste.

Per mitigare queste limitazioni, i punteggi grezzi vengono spesso convertiti in formati che permettono un'interpretazione più contestualizzata, quali i punteggi standardizzati o scalati. Queste trasformazioni facilitano l'interpretazione dei risultati ottenuti.

- L'interpretazione dei risultati dei test necessita di un riferimento comparativo. A seconda del contesto, può essere utile confrontare le prestazioni con una norma di riferimento o con criteri specifici.
- Un altro approccio interpretativo è offerto dalla **Teoria della Risposta agli Item** (IRT), che fornisce un'analisi avanzata delle prestazioni nei test, permettendo un'esplorazione dettagliata delle risposte individuali.

## Interpretazioni Basate sulla Norma

La maggior parte dei test psicologici—come quelli di intelligenza, dello sviluppo, neuropsicologici e clinici—utilizza punteggi basati su norme di riferimento. In questi test, i punteggi grezzi vengono trasformati in **punteggi normativi** che esprimono la performance di un individuo in relazione a una popolazione di riferimento. Questo tipo di interpretazione permette di collocare il risultato del soggetto all'interno di una distribuzione normativa, fornendo una misura relativa rispetto a ciò che è considerato tipico o normale per quel gruppo. Mentre i test normativi offrono informazioni sulla posizione relativa di un soggetto rispetto a un gruppo, i test basati su criteri determinano se il soggetto ha raggiunto un livello specifico di competenza o conoscenza.

Un aspetto cruciale in queste interpretazioni è la **pertinenza del gruppo di riferimento**. È fondamentale che questo gruppo sia rappresentativo degli individui a cui il test è destinato o con cui il partecipante viene confrontato. La selezione del campione normativo, o campione di standardizzazione, segue il principio del **campionamento casuale stratificato proporzionale**, assicurando che il campione rifletta proporzionalmente le caratteristiche demografiche nazionali. Quando si utilizzano questi test, è fondamentale valutare se il campione di standardizzazione è rappresentativo per l'uso previsto e se le caratteristiche demografiche del campione corrispondono a quelle dei soggetti testati. La pertinenza e l'attualità del campione, insieme alla sua dimensione, sono fattori chiave per garantire interpretazioni valide e affidabili.

Un'altra considerazione importante riguarda l'importanza della **standardizzazione nella somministrazione** del test. È essenziale che il campione di riferimento sia stato sottoposto al test nelle stesse condizioni e secondo le stesse procedure amministrative che saranno utilizzate nella pratica effettiva. Pertanto, quando il test viene somministrato in contesti clinici, è cruciale che l'esaminatore segua attentamente le procedure amministrative prescritte. Ad esempio, nel caso di test standardizzati, è fondamentale leggere le istruzioni esattamente come fornite e rispettare rigorosamente i limiti di tempo. Sarebbe inappropriato confrontare la performance di un esaminando in un test a tempo con quella di un campione di standardizzazione che ha avuto più o meno tempo per completare gli item. Questa necessità di seguire procedure standardizzate si applica a tutti i test standardizzati, sia quelli con interpretazioni basate sulla norma che quelli basati sul criterio.

### Approccio Tradizionale vs Approccio Basato sulla Regressione per la Normazione

Una caratteristica distintiva dei test psicologici con punteggi normati è che le norme spesso dipendono da caratteristiche specifiche come l'età, il sesso e/o il livello educativo. Ciò significa che esistono diverse **popolazioni di riferimento**, ciascuna con le proprie norme, che insieme costituiscono la popolazione normativa del test. Le norme vengono definite durante la fase di costruzione del test.

La normazione dei punteggi grezzi è essenziale per interpretare le prestazioni di un individuo rispetto a un gruppo di riferimento. Quando i punteggi dipendono da variabili continue come l'età, è possibile adottare due approcci principali: il metodo **tradizionale** e quello **basato sulla regressione**. La figura seguente illustra le differenze tra questi due metodi [@timmerman2021tutorial].

::: {#fig-timmerman}

![](../../figures/timmerman_fig1.png){width="99%"}

*Punteggi di un campione normativo illustrativo (N = 1.660) del Test 14 dell'IDS-2 in funzione dell'età, con la mediana stimata per intervalli di età di 4 anni (pannello A) e di 1 anno (pannello B), e i limiti degli intervalli di confidenza al 95% (IC 95%) della mediana del punteggio del test, come calcolati con il metodo tradizionale di normazione, e come funzione non lineare continua dell'età utilizzata nella normazione basata sulla regressione (pannello C) [figura tratta da @timmerman2021tutorial].*

:::

#### Normazione Tradizionale

Nell'approccio tradizionale, la variabile continua (ad esempio, l'età) viene suddivisa in intervalli discreti (ad esempio, fasce di età), e i punteggi normativi vengono calcolati per ciascun intervallo. Ad esempio:

- Nel **Pannello A**, i punteggi grezzi del test sono suddivisi in intervalli di 4 anni. Per ogni fascia, viene calcolata la **mediana** e i relativi **intervalli di confidenza al 95% (IC 95%)**.
- Nel **Pannello B**, si utilizzano intervalli più stretti di 1 anno, ottenendo stime più precise.

Questo metodo implica che i punteggi grezzi all'interno di ogni intervallo siano trattati come equivalenti, assumendo implicitamente che la distribuzione dei punteggi sia costante per tutte le età nell'intervallo.

**Problemi dell'approccio tradizionale:**

1. **Discontinuità tra intervalli:** Quando un soggetto si trova vicino al limite tra due intervalli, lo stesso punteggio grezzo può essere interpretato diversamente. Ad esempio, un bambino di **12 anni e 364 giorni** potrebbe ricevere un'interpretazione diversa rispetto a uno di **13 anni e 1 giorno**, nonostante la minima differenza di età.

2. **Irrealismo:** La suddivisione in fasce può produrre salti "artificiali" nei punteggi normativi, non allineati con l'andamento reale secondo cui le prestazioni cambiano gradualmente con l'età.

3. **Difficoltà con intervalli ampi:** Intervalli larghi, come quelli di 4 anni, rischiano di non catturare le variazioni sottili nella distribuzione dei punteggi legate all'età (Pannello A). Intervalli più stretti (Pannello B) migliorano la precisione, ma richiedono campioni molto più grandi per ciascun intervallo.

#### Normazione Basata sulla Regressione

L'approccio basato sulla regressione supera i limiti del metodo tradizionale modellando i punteggi grezzi come una **funzione continua** della variabile di riferimento (ad esempio, l'età). Nel **Pannello C**, la relazione tra i punteggi grezzi e l'età è rappresentata come una curva continua e non lineare, che:

- Permette di stimare i punteggi normativi per **qualsiasi età**.
- Riflette un cambiamento **graduale e realistico** dei punteggi rispetto all'età, evitando salti artificiali.

**Vantaggi della regressione:**

1. **Continuità:** Non ci sono salti tra intervalli di età. I punteggi grezzi vengono interpretati in modo fluido e realistico, anche per età non incluse esplicitamente nei dati del campione.

2. **Flessibilità:** Il modello può adattarsi a distribuzioni non lineari, catturando andamenti complessi nei dati senza richiedere un'eccessiva stratificazione del campione.

3. **Efficienza:** Si richiedono meno dati, poiché non è necessario suddividere la popolazione in molti piccoli intervalli.

In conclusione, l'approccio basato sulla regressione rappresenta un metodo moderno e flessibile per la normazione dei punteggi nei test psicologici. Esso è in grado di catturare andamenti graduali nei punteggi grezzi e di evitare le discontinuità tipiche dell'approccio tradizionale. 

## Punteggi Derivati

In ambito psicometrico, i punteggi derivati da test possono assumere diverse forme, ciascuna con implicazioni specifiche per l'interpretazione dei dati. Esploreremo le tipologie più comuni:

1. **Punteggi Standardizzati:**
    - Questi punteggi trasformano i punteggi grezzi (ad esempio, il numero di risposte corrette) in misure standardizzate, rendendoli confrontabili tra individui o gruppi diversi.  
    - La trasformazione avviene stabilendo una media e una deviazione standard di riferimento, che possono essere basate su un campione normativo o definite in base a criteri teorici.  
    - Esempi:
        - **z-scores**: Indicano di quante deviazioni standard un punteggio si discosta dalla media della distribuzione di riferimento. Sono calcolati rispetto alla media e alla deviazione standard del campione normativo, assumendo una distribuzione normale con media 0 e deviazione standard 1.  
        - **T-scores**: Sono una trasformazione lineare dei punteggi z, con una media fissata a 50 e una deviazione standard di 10, così da evitare valori negativi e rendere più intuitiva l’interpretazione.  
        - **Punteggi di QI**: Utilizzati nelle scale di intelligenza, hanno una media convenzionale di 100 e una deviazione standard di 15, basate su una distribuzione normale standardizzata della popolazione di riferimento.  

2. **Punteggi Standardizzati Normalizzati:**
    - Quando i punteggi grezzi non seguono una distribuzione normale, si applicano trasformazioni non lineari per ottenere una distribuzione che si avvicini a quella normale, rendendo i punteggi più facilmente interpretabili.  
    - Esempi:
        - **Stanine**: Suddividono la distribuzione in 9 categorie di ampiezza simile (da 1 a 9), con media 5 e deviazione standard di circa 2.  
        - **Punteggi scalati di Wechsler**: Derivati dai punteggi grezzi nelle scale di Wechsler, con media 10 e deviazione standard 3, e normalizzati per adattarsi a una distribuzione teorica attesa.  
        - **Equivalenti della Curva Normale (NCE)**: Sono una trasformazione dei ranghi percentili che rende i punteggi confrontabili come se seguissero una distribuzione normale.  

3. **Ranghi Percentili:**
    - Esprimono la posizione relativa di un punteggio rispetto alla distribuzione di riferimento, indicando la percentuale di soggetti che hanno ottenuto un punteggio uguale o inferiore.  
    - Non assumono una distribuzione normale e non sono equidistanti: la differenza tra il 50° e il 60° percentile non è necessariamente uguale a quella tra il 90° e il 100° percentile.  
    - Ad esempio, un punteggio al 75° percentile indica che il soggetto ha ottenuto un risultato superiore al 75% della popolazione di riferimento.  

### Interpretazioni Basate su Criteri

L'approccio delle valutazioni basate su criteri specifici è diventato sempre più rilevante nel mondo dell'educazione e della psicometria a partire dagli anni Sessanta. Questo approccio, noto anche come valutazione basata su contenuti, dominio o obiettivi, si concentra sulla misurazione delle competenze individuali rispetto a standard definiti, piuttosto che sul confronto con le prestazioni di un gruppo di riferimento.

Ecco alcune metodologie e applicazioni comuni:

1. **Percentuale di Risposte Corrette**:
    - Questo metodo fornisce un'indicazione diretta delle competenze di uno studente.
    - Ad esempio, se uno studente risponde correttamente all'85% delle domande di matematica, l'insegnante può valutare le sue abilità in modo specifico.

2. **Test di Padronanza**:
    - Questi test determinano se uno studente ha acquisito una competenza specifica.
    - Ad esempio, gli esami per la patente di guida valutano se lo studente ha raggiunto il livello di padronanza richiesto.

3. **Valutazioni Basate su Standard**:
    - Queste valutazioni classificano i risultati in categorie di prestazione (ad esempio, base, competente, avanzato).
    - Spesso, i punteggi vengono correlati a voti letterali basati su una percentuale di correttezza.

I punti di forza delle valutazioni basate su criteri includono:

- **Comparazione con Standard Predefiniti**:
    - Valutano il raggiungimento di competenze o obiettivi specifici, indipendentemente dalle prestazioni altrui.
    - Questo approccio evita il bias derivante dal confronto con altri studenti.

- **Focalizzazione su Competenze Specifiche**:
    - Questi test richiedono una definizione precisa dell'area di conoscenza o abilità valutata.
    - Sono ideali per valutare aree di contenuto specifiche.

#### Benefici

- **Valutazione Mirata delle Competenze**: Fornisce una verifica concreta del conseguimento delle conoscenze e abilità delineate dal programma di studi.
- **Personalizzazione dell'Insegnamento**: Identifica le aree di debolezza, consentendo un approccio didattico più focalizzato e personalizzato.

In conclusione, le valutazioni basate su criteri rappresentano un'alternativa preziosa ai metodi di valutazione tradizionali, specialmente in contesti in cui è fondamentale misurare le competenze individuali. Questo approccio è in crescente adozione in ambiti educativi e formativi, enfatizzando l'importanza dell'acquisizione di conoscenze e abilità mirate.

## Analisi Comparativa tra Valutazioni Normative e Basate su Criteri

La distinzione tra valutazioni **normative** (norm-referenced) e **basate su criteri** (criterion-referenced) è fondamentale per interpretare le prestazioni individuali nei test. Sebbene un test possa teoricamente adottare entrambi gli approcci interpretativi, di solito si orienta verso uno dei due, a seconda dell'obiettivo specifico.

Ecco una panoramica delle differenze:

1. **Valutazioni Normative**:
    - **Versatilità**: Si applicano a test che valutano una vasta gamma di dimensioni, come attitudini, risultati scolastici, interessi, atteggiamenti e comportamenti.
    - **Ampio Quadro**: Ideali per esplorare costrutti generali come l'attitudine generale o l'intelligenza.
    - **Selezione delle Domande**: Preferiscono domande di difficoltà intermedia, evitando quelle troppo semplici o complesse.

2. **Valutazioni Basate su Criteri**:
    - **Specificità**: Associate principalmente a test che mirano a valutare conoscenze o competenze specifiche.
    - **Focalizzazione**: Concentrate su abilità e competenze ben definite.
    - **Calibrazione delle Domande**: La difficoltà delle domande è tarata in base alle conoscenze o abilità specifiche da valutare.

È importante notare che queste interpretazioni non sono mutuamente esclusive. Alcuni test offrono sia valutazioni normative che basate su criteri, fornendo una visione completa delle prestazioni relative rispetto a un gruppo di riferimento e del livello di competenza in un ambito specifico. Questa dualità interpretativa è preziosa in vari contesti.

## Analisi dei Punteggi secondo la Teoria della Risposta agli Item 

La **Teoria della Risposta agli Item** (IRT) rappresenta un notevole avanzamento nel campo della psicometria, fornendo strumenti essenziali per valutare con precisione le capacità e i tratti latenti degli individui.

**Fondamenti e Principi dell'IRT:**
L'IRT si basa sull'assunto che ogni persona possieda un livello di un tratto latente, come l'intelligenza, che è indipendente dalle specifiche domande del test o dal metodo di valutazione utilizzato. Attraverso l'applicazione di modelli matematici complessi, l'IRT consente di posizionare ogni individuo su un continuum di tratto latente, offrendo una misurazione delle capacità più precisa rispetto ai tradizionali punteggi grezzi.

**Vantaggi dei Punteggi basati sull'IRT:**
I punteggi derivati dall'IRT presentano significativi vantaggi. Essi sono trattati come punteggi a intervalli costanti, consentendo comparazioni valide tra le performance di soggetti o gruppi diversi. Inoltre, questi punteggi mantengono una deviazione standard uniforme attraverso diverse fasce d'età, rendendoli particolarmente adatti per monitorare l'evoluzione o il progresso delle abilità nel tempo.

**Applicazioni Pratiche e Prospettive Future dell'IRT:**
Una delle applicazioni più innovative dell'IRT è lo sviluppo dei **test adattivi computerizzati (CAT)**, in cui le domande vengono selezionate dinamicamente in base alle risposte precedenti del candidato. Questo metodo consente valutazioni precise ed efficienti delle abilità in tempo reale. 

## La Selezione del Punteggio Appropriato per la Valutazione

Determinare il tipo di punteggio più adeguato per un test è essenziale per ottenere informazioni specifiche e pertinenti dalla valutazione. Le diverse categorie di punteggi forniscono risposte a domande distinte riguardo alle prestazioni degli esaminandi:

1. **Punteggi Grezzi:**
   - Rappresentano la quantità totale di risposte corrette accumulate da un individuo.
   - Offrono una visione immediata del livello di prestazione e permettono di stabilire un ordine tra i partecipanti.
   - Sono utili per identificare rapidamente il posizionamento relativo di un individuo all'interno di un gruppo.

2. **Punteggi Norm-Referenced Standard:**
   - Forniscono un confronto diretto tra le prestazioni di un individuo e quelle di un gruppo normativo.
   - Consentono di interpretare la prestazione su una scala relativa, facilitando la comprensione del rendimento in termini di posizione all'interno di una popolazione di riferimento.

3. **Punteggi Criterion-Referenced:**
   - Indicano se un individuo ha raggiunto un determinato standard di competenza.
   - Sono particolarmente indicati per valutare il conseguimento di obiettivi specifici o competenze chiave.

4. **Punteggi Basati sull'IRT (Inclusi i Punteggi Rasch):**
   - Offrono una misurazione su scala a intervalli costanti, riflettendo la posizione di un individuo su un continuum di un tratto latente.
   - Sono ideali per tracciare il progresso nel tempo o confrontare le prestazioni attraverso diverse valutazioni di un medesimo tratto.

Ad esempio, nel caso di Giovanni, che ha beneficiato di un programma di supporto alla lettura:

- **Punteggi Norm-Referenced:** Fornirebbero insight su come le capacità di lettura di Giovanni si confrontano con quelle dei suoi coetanei dopo l'intervento.
- **Punteggi Rasch o IRT:** Consentirebbero di valutare l'evoluzione precisa delle competenze di lettura di Giovanni, misurando il progresso a partire dal suo livello iniziale.
- **Punteggi Grezzi:** Darebbero indicazioni sul miglioramento assoluto, sebbene privi della capacità di riflettere le variazioni in termini di difficoltà degli item o di altri fattori.
- **Punteggi Criterion-Referenced:** Stabilirebbero se Giovanni ha raggiunto specifici obiettivi di competenza in lettura definiti a priori.

In conclusione, la scelta del tipo di punteggio da utilizzare è guidata dal contesto di valutazione e dall'obiettivo specifico della misurazione. 

## Significato e Applicazione delle Norme e dei Punteggi Standardizzati

Per chiarire questi concetti, esaminiamo i dati della Tabella 2.1 di @bandalos2018measurement. Con degli esempi numerici, analizzeremo vari tipi di punteggi normativi, tra cui: 

- **Punteggi Percentili**: Che indicano la posizione relativa di un individuo all'interno del gruppo normativo.
- **Punteggi Standardizzati e Normalizzati**: Che trasformano i punteggi grezzi in una scala standard per facilitare il confronto tra diversi individui o gruppi.
- **Stanini**: Un metodo di punteggio che divide i punteggi in intervalli standardizzati.
- **Equivalenti alla Curva Normale**: Che adattano i punteggi a una distribuzione normale.

Nei capitoli successivi esamineremo poi come calcolare i punteggi basati sulla teoria IRT.

Iniziamo a leggere i dati.

```{r}
#| vscode: {languageId: r}
raw_score <- c(
    26, 25, 33, 31, 26, 34, 29, 36, 25, 29, 28, 32, 25,
    30, 27, 31, 30, 30, 35, 30, 27, 26, 34, 32, 26, 34,
    30, 28, 28, 31, 30, 27, 26, 29, 29, 33, 27, 35, 26,
    27, 28, 29, 28, 27, 34, 36, 26, 26, 34, 30, 34, 27
)
```

### Distribuzione di frequenze

```{r}
#| vscode: {languageId: r}
freq <- table(raw_score) # frequency
cumfreq <- cumsum(freq) # cumulative frequency
perc <- prop.table(freq) * 100 # percentage
cumperc <- cumsum(perc) # cumulative percentage
pr <- (cumperc - 0.5 * perc) # percentile rank
cbind(freq, cumfreq, perc, cumperc, pr)
```

### Punteggi Percentili

I punteggi percentili sono un modo efficace per interpretare e confrontare i punteggi di un individuo con quelli di un campione normativo. Un punteggio percentile indica la posizione relativa di un individuo all'interno di un gruppo normativo. Più specificamente, un punteggio percentile mostra la percentuale di persone nel campione normativo che ha ottenuto un punteggio uguale o inferiore a quello dell'individuo in questione.

```{r}
#| vscode: {languageId: r}
quantile(raw_score, .74) 
```

```{r}
#| vscode: {languageId: r}
# Use a different type (see https://en.wikipedia.org/wiki/Quantile#Estimating_quantiles_from_a_sample)
quantile(raw_score, .74, type = 6)
```

I punteggi percentili sono particolarmente utili perché offrono una comprensione intuitiva della posizione di un individuo rispetto agli altri. Tuttavia, è importante notare che essi rappresentano una scala ordinale e, pertanto, le differenze tra i punteggi percentili non sono necessariamente uniformi o proporzionali attraverso l'intera gamma di punteggi. 

### Punteggi Standardizzati 

I punteggi standardizzati consentono di confrontare i risultati di individui o gruppi in maniera equa e coerente, superando le variazioni di scala o di difficoltà tra diversi test.

#### Principi Fondamentali dei Punteggi Standardizzati
- **Media e Deviazione Standard Predefinite**: I punteggi standardizzati sono calcolati in modo tale da avere una media e una deviazione standard specifiche, stabilite in anticipo. Per esempio, spesso si utilizza una media di 100 e una deviazione standard di 15 (come nei test di intelligenza) o una media di 0 e una deviazione standard di 1 (come negli z-score).
- **Risultati Confrontabili**: Attraverso questa standardizzazione, i punteggi diventano direttamente confrontabili. Un punteggio standardizzato rispetto a una media di 100 e una deviazione standard di 15, ad esempio, permette di valutare rapidamente se un punteggio è al di sopra, al di sotto o vicino alla media del campione normativo.

#### Come Funziona la Trasformazione
Il processo di standardizzazione implica la sottrazione della media del campione normativo dal punteggio grezzo di un individuo, seguita dalla divisione del risultato per la deviazione standard del campione normativo. In termini matematici, se $ X $ è un punteggio grezzo, $ \mu $ è la media del campione normativo e $ \sigma $ è la deviazione standard del campione normativo, allora il punteggio standardizzato $ Z $ è calcolato come:

$$ 
Z = \frac{X - \mu}{\sigma}.
$$

#### Utilità dei Punteggi Standardizzati

- **Comparabilità**: Rendono i punteggi ottenuti da test diversi o da campioni diversi direttamente comparabili.
- **Interpretazione Facilitata**: Forniscono un modo semplice per interpretare i punteggi individuali in termini di posizione relativa rispetto alla media del campione normativo.
- **Adattabilità**: Sono utili in una varietà di contesti, da test educativi a valutazioni cliniche.

In conclusione, i punteggi standardizzati sono uno strumento cruciale nella psicometria e nella valutazione educativa. Trasformando i punteggi grezzi in una scala comune con media e deviazione standard specifiche, facilitano il confronto e l'interpretazione dei risultati dei test, rendendo più accessibile l'analisi e la valutazione delle prestazioni individuali e di gruppo.

Nel caso dell'esempio, i calcoli si svolgono in R nel modo seguente:

```{r}
#| vscode: {languageId: r}
z_score <- (raw_score - mean(raw_score)) / sd(raw_score)
c(mean = mean(z_score), sd = sd(z_score))
```

#### Punteggi T

I punteggi T sono una forma specifica di punteggi standardizzati, utilizzati frequentemente nella psicometria per rendere più accessibili e interpretabili i risultati dei test. A differenza dei punteggi z, che tipicamente hanno una media di 0 e una deviazione standard di 1, i punteggi T sono trasformati in modo da avere una media fissata a 50 e una deviazione standard di 10.

#### Caratteristiche Principali dei Punteggi T

- **Media e Deviazione Standard**: La media fissata a 50 e la deviazione standard di 10 sono scelte per offrire una scala più intuitiva e di facile lettura rispetto agli z-score. Questa trasformazione sposta la scala degli z-score in una gamma numericamente più familiare e più semplice da interpretare per la maggior parte delle persone.
  
- **Calcolo dei Punteggi T**: Il calcolo dei punteggi T avviene trasformando prima i punteggi grezzi in z-score e poi convertendo questi z-score nella scala dei punteggi T. Matematicamente, se $ Z $ è lo z-score, il punteggio T corrispondente $ T $ è calcolato come:
  
  $$
  T = 50 + 10 \times Z. 
  $$

  Questa formula adatta lo z-score in una scala che inizia da 50 e si allarga in entrambe le direzioni con incrementi standard di 10 per ogni deviazione standard.

#### Utilizzo dei Punteggi T

- **Facilità di Interpretazione**: I punteggi T sono particolarmente utili quando si desidera presentare i risultati dei test in un formato che sia immediatamente comprensibile, senza la necessità di ulteriori calcoli o trasformazioni.
- **Comparabilità**: Consentono di confrontare i risultati di test diversi in modo più diretto, grazie alla loro scala standardizzata.
- **Ampio Utilizzo**: Sono ampiamente usati in vari ambiti della valutazione psicologica, inclusi l'educazione, la ricerca e la pratica clinica.

In sintesi, i punteggi T offrono un modo efficace e standardizzato per interpretare i risultati dei test, rendendo i dati più accessibili e immediatamente comprensibili. La loro trasformazione da z-score a una scala con media 50 e deviazione standard 10 facilita la comprensione e la comparazione dei punteggi tra diversi test e diversi individui.

Svolgendo i calcoli in R otteniamo

```{r}
#| vscode: {languageId: r}
T_score <- z_score * 10 + 50
c(mean = mean(T_score), sd = sd(T_score))
```

### Punteggi Stanini

I punteggi Stanini (dall'inglese "standard nine") rappresentano un metodo standardizzato per categorizzare i risultati dei test in psicometria, dividendoli in nove intervalli. Questa scala, progettata per semplificare l'interpretazione dei dati, permette di valutare la posizione relativa di un individuo all'interno di un gruppo di riferimento.

**Come funzionano?**
Ogni intervallo Stanine corrisponde a un range di punteggi grezzi, con un'ampiezza che può variare leggermente a seconda della distribuzione dei dati. Un punteggio Stanine di 5 indica una prestazione media, mentre valori più alti o più bassi indicano prestazioni rispettivamente superiori o inferiori alla media. È importante notare che i punteggi Stanini sono principalmente utilizzati per confronti relativi all'interno di un gruppo, piuttosto che per misurazioni assolute.

**Calcolo dei Punteggi Stanini.**
Per calcolare i punteggi Stanini, è necessario seguire alcuni passaggi:

1. **Determinare Media e Deviazione Standard**: Inizialmente, si calcolano la media e la deviazione standard dei dati del campione normativo.
2. **Applicare la Formula dei Punteggi Stanini**: Per ogni punteggio grezzo, si applica la seguente formula per calcolare il punteggio Stanine corrispondente:
   
   $$
   \text{Stanine} = \left( \frac{\text{Punteggio Grezzo} - \text{Media}}{\text{Deviazione Standard}} \right) \times 2 + 5.
   $$
   
   Questa formula trasforma il punteggio grezzo in un valore sulla scala dei punteggi Stanini.
3. **Arrotondare al Numero Intero Più Vicino**: Infine, si arrotonda il risultato al numero intero più vicino per ottenere il punteggio Stanini finale.

I punteggi Stanini offrono diversi vantaggi:

- Semplicità: La scala a nove punti è facile da comprendere e memorizzare.
- Rapidità: Permettono una valutazione rapida della performance.
- Standardizzazione: Consentono di confrontare i risultati ottenuti in test diversi o da gruppi diversi.

**Limitazioni:**

Sebbene i punteggi Stanini siano uno strumento utile, è importante considerarne anche i limiti: essi assumono una distribuzione normale dei dati e quindi non sono adatti a tutti i tipi di test.

Per l'esempio presente abbiamo:

```{r}
#| vscode: {languageId: r}
mean_score <- mean(raw_score)
sd_score <- sd(raw_score)

stanine_scores <- round((raw_score - mean_score) / sd_score * 2 + 5)
print(stanine_scores)
```

È importante ricordare che la trasformazione in punti z non cambia la forma della distribuzione.

```{r}
#| vscode: {languageId: r}
plot(density(raw_score))
```

```{r}
#| vscode: {languageId: r}
plot(density(z_score))
```

```{r}
#| vscode: {languageId: r}
plot(density(T_score))
```

```{r}
#| vscode: {languageId: r}
plot(density(stanine_scores))
```

La seguente figura proposta da @petersen2024principles illustra le relazioni tra i punteggi stanini e altre tipologie di punteggi derivati.

::: {#fig-petersen-norm-referenced-scales}

![](../../figures/petersen_norm_refeenced_scales.png){width="80%"}

*Varie scale normate [figura tratta da @petersen2024principles].*

:::

### Equivalenti alla Curva Normale (NCE)

Gli Equivalenti alla Curva Normale, noti come NCE (dall'inglese "Normal Curve Equivalents"), sono un tipo di punteggio standardizzato utilizzato in ambito psicometrico. Questi punteggi vengono calcolati per trasformare i punteggi grezzi ottenuti in un test in una scala che rifletta una distribuzione approssimativamente normale. L'obiettivo principale dei punteggi NCE è quello di rendere i punteggi di diverse misure o test direttamente confrontabili, mantenendo una distribuzione che si allinea strettamente con una curva normale standard.

#### Caratteristiche dei Punteggi NCE
- **Distribuzione Normalizzata**: I punteggi NCE sono progettati per aderire a una distribuzione normale. Ciò significa che, a differenza di altri tipi di punteggi, i NCE si allineano più da vicino con le caratteristiche di una curva di distribuzione gaussiana, con la maggior parte dei punteggi concentrati intorno alla media e una distribuzione simmetrica verso gli estremi.
- **Facilità di Comparazione**: Grazie alla loro standardizzazione, i punteggi NCE consentono un confronto diretto e significativo tra le prestazioni in diversi test o misure. Questo è particolarmente utile in contesti educativi e clinici dove è necessario interpretare e confrontare i risultati di diversi test.

#### Calcolo e Utilizzo dei Punteggi NCE
Il calcolo dei punteggi NCE si basa sulla trasformazione dei punteggi grezzi in modo che si adattino a una distribuzione normalizzata. Questo processo implica l'uso di formule matematiche che riallineano i dati grezzi su una scala standard, considerando la media e la deviazione standard del campione normativo.

Una volta calcolati, i punteggi NCE offrono una visione chiara e immediata delle prestazioni relative di un individuo o di un gruppo, rispetto a un campione normativo. Questo tipo di punteggio è particolarmente utile quando i punteggi grezzi provengono da distribuzioni che non seguono una curva normale, consentendo così un'interpretazione più accurata e standardizzata dei risultati.

#### Applicazioni Pratiche dei Punteggi NCE
I punteggi NCE trovano impiego in una varietà di contesti, tra cui:

- **Valutazioni Educative**: In ambito scolastico, per confrontare le prestazioni degli studenti in test diversi.
- **Ricerca Psicologica**: Per analizzare e confrontare i risultati di diversi studi o misure psicometriche.
- **Pratica Clinica**: Nella valutazione di clienti o pazienti utilizzando diversi strumenti diagnostici.

In conclusione, i punteggi Equivalenti alla Curva Normale rappresentano uno strumento psicometrico potente per standardizzare e confrontare efficacemente i risultati di diversi test o misure, assicurando che questi siano interpretati all'interno di un quadro coerente e comparabile.

Per i dati dell'esempio abbiamo:

```{r}
#| vscode: {languageId: r}
# Using normal quantile
qnorm_pr <- qnorm(pr / 100)
# Convert raw scores
normalized_zscore <- as.vector(qnorm_pr[as.character(raw_score)])
```

In alternativa, è possibile usare la trasformazione di Box-Cox, che è una tecnica parametrica che cerca di correggere le asimmetrie e trasformare i dati in una forma che approssima una distribuzione normale. È efficace per i dati positivi. La trasformazione è definita come segue:

$$
 y(\lambda) = \begin{cases} \frac{x^\lambda - 1}{\lambda} & \text{se } \lambda \neq 0 \\ \log(x) & \text{se } \lambda = 0 \end{cases},
 $$

dove $x$ è il valore originale e $\lambda$ è il parametro di trasformazione che viene spesso trovato attraverso la massimizzazione della verosimiglianza.

Supponiamo di voler utilizzare la trasformazione di Box-Cox sul nostro set di dati. La procedura è la seguente. Questo codice utilizza la funzione `boxcox` dal pacchetto MASS per trovare il valore di $\lambda$ che massimizza la log-verosimiglianza della trasformazione di Box-Cox applicata ai dati. Poi, utilizza questo $\lambda$ per trasformare i dati.

```{r}
#| vscode: {languageId: r}
# Dati di esempio
set.seed(123) # Per rendere l'esempio riproducibile
data <- raw_score

# Trova il miglior lambda per la trasformazione di Box-Cox
bc <- boxcox(data ~ 1, lambda = seq(-2, 2, by = 0.1))

# Calcola la trasformazione di Box-Cox con il lambda ottimale
lambda_opt <- bc$x[which.max(bc$y)]
data_transformed <- (data^lambda_opt - 1) / lambda_opt
```

Avendo trovato i dati trasformati con la procedura Box-Cox, li confrontiamo con gli Equivalenti alla Curva Normale (NCE) calcolati con la procedura usuale.

```{r}
#| vscode: {languageId: r}
plot(normalized_zscore, data_transformed)
```

```{r}
#| vscode: {languageId: r}
plot(density(normalized_zscore)) # the shape will be closer to normal
```

```{r}
#| vscode: {languageId: r}
plot(density((data_transformed - mean(data_transformed)) / sd(data_transformed)))
```

Si osservi che i dati NCE presentano una distribuzione più simile a una curva a forma campanulare rispetto ai dati grezzi.

```{r}
#| vscode: {languageId: r}
lillie.test(normalized_zscore)
```

```{r}
#| vscode: {languageId: r}
lillie.test(data_transformed)
```

## Riflessioni Finali sui Metodi di Trasformazione dei Punteggi

La trasformazione dei punteggi grezzi in formati più interpretabili è una pratica cruciale in psicometria. Due sono i principali approcci utilizzati per attribuire significato ai punteggi di un test: il riferimento normativo e il riferimento criteriale.

### Riferimento Normativo
Nel riferimento normativo, si confronta il punteggio di un individuo con quello medio del gruppo normativo, ovvero gli altri soggetti che hanno svolto lo stesso test. Ci sono diversi tipi di punteggi normati, ciascuno con i suoi specifici vantaggi e limitazioni:

- **Punteggi Percentili**: Questi punteggi sono intuitivi e offrono un'indicazione immediata della posizione relativa di un individuo all'interno di un gruppo. Tuttavia, sono una scala ordinale e non si prestano bene a calcoli matematici più complessi.
  
- **Punteggi Standardizzati**: Gli z-score e i T-scores rientrano in questa categoria. Sono scalari a intervallo, quindi adatti a operazioni matematiche. Mantengono la forma distributiva originale dei punteggi grezzi, rendendo più agevole la loro elaborazione statistica.

### Riferimento Criteriale
Al contrario del riferimento normativo, il riferimento criteriale confronta i punteggi di un individuo con uno standard prestabilito o un criterio specifico, piuttosto che con i punteggi di altri individui.

### Trasformazioni per la Normalizzazione
Per ottenere una distribuzione dei punteggi più vicina alla curva normale, si possono utilizzare trasformazioni come gli stanini o gli NCE (Normal Curve Equivalents). Questi metodi di normalizzazione aiutano a standardizzare la distribuzione dei punteggi, facilitando così l'interpretazione e l'analisi dei dati psicometrici.

In conclusione, la scelta del metodo di trasformazione dei punteggi dipende dagli obiettivi specifici della valutazione e dall'interpretazione desiderata. La comprensione di queste diverse tecniche è essenziale per una corretta interpretazione dei risultati dei test e per l'analisi psicometrica più generale.

## Riflessioni Conclusive

Questo capitolo fornisce una panoramica sui diversi tipi di punteggi dei test e il loro significato. Iniziamo notando che i punteggi grezzi, sebbene facili da calcolare, di solito forniscono poche informazioni utili sul rendimento di un esaminando in un test. Di conseguenza, di solito trasformiamo i punteggi grezzi in punteggi derivati, che possono essere di riferimento normativo o al criterio. I punteggi di riferimento normativo confrontano il rendimento di un esaminando con quello di altre persone nel campione di standardizzazione, mentre quelli al criterio confrontano il rendimento con un livello di competenza specificato. È importante valutare l'adeguatezza del campione di standardizzazione quando si utilizzano punteggi di riferimento normativo.

Per interpretazioni basate sui punteggi di riferimento normativo, è utile conoscere la distribuzione normale e i punteggi standard di riferimento. Questi ultimi hanno una media predefinita e una deviazione standard. Esistono anche punteggi normalizzati quando i punteggi non seguono una distribuzione normale. Altri tipi di punteggi di riferimento normativo includono il rango percentile e i punteggi basati su età o livello di scolarità. Tuttavia, questi ultimi sono da evitare, se possibile, a favore di punteggi standard e ranghi percentile.

I punteggi al criterio confrontano il rendimento con un livello specifico di competenza. Sono utili per valutare abilità in domini specifici, ma richiedono una chiara definizione del dominio. A volte, un test può produrre entrambi i tipi di punteggi. Forniamo anche una panoramica dei punteggi basati sulla teoria della risposta agli item (IRT), che sono utili per misurare i cambiamenti nel tempo.

In conclusione, i diversi tipi di punteggi dei test forniscono informazioni per rispondere a diverse domande e devono essere scelti in base alle esigenze specifiche dell'analisi dei dati del test.

## Esercizi {.unnumbered}

::: {.callout-important title="Problemi" collapse="true"}
**Esercizio 1: Classificazione delle variabili**

1. Creare un data frame in R contenente cinque variabili con dati simulati:
   - **ID soggetto** (codice numerico univoco, dati nominali).
   - **Sesso** (M/F, dati nominali).
   - **Livello di ansia** (scala Likert da 1 a 5, dati ordinali).
   - **Punteggio QI** (media = 100, deviazione standard = 15, dati di intervallo).
   - **Tempo di reazione in secondi** (valore continuo, dati di rapporto).

2. Verificare la classe di ciascuna variabile con `class()` e discuterne la tipologia.

**Esercizio 2: Calcolo di Punteggi Standardizzati**

1. Utilizzando il data frame dell'Esercizio 1, standardizzare i punteggi QI e Tempo di Reazione con la formula dello z-score:
   $$
   Z = \frac{X - \text{media}}{\text{deviazione standard}}
   $$
2. Visualizzare la distribuzione dei punteggi grezzi e dei punteggi standardizzati con istogrammi.

**Esercizio 3: Calcolo di Punteggi Percentili**

1. Utilizzare i punteggi QI generati in precedenza.
2. Calcolare il **percentile rank** per ciascun partecipante.
3. Identificare il punteggio QI corrispondente al **percentile 90**.

**Esercizio 4: Confronto tra Normazione Tradizionale e Basata sulla Regressione**

1. Creare una variabile di età compresa tra 18 e 65 anni.
2. Generare punteggi grezzi simulati di un test cognitivo.
3. Applicare due metodi di normazione:
   - **Metodo tradizionale:** Dividere il campione in fasce d’età (18-30, 31-45, 46-65) e calcolare la media e la deviazione standard per ciascuna fascia.
   - **Metodo della regressione:** Applicare una regressione lineare per predire i punteggi in funzione dell’età.

**Esercizio 5: Simulazione della Distribuzione dei Punteggi Stanini**

1. Generare una distribuzione di punteggi di un test (N = 1000) con media = 50 e deviazione standard = 10.
2. Trasformare i punteggi in **stanini** utilizzando la formula:
   $$
   \text{Stanine} = \left(\frac{\text{Punteggio} - \text{Media}}{\text{Deviazione Standard}}\right) \times 2 + 5
   $$
3. Creare un istogramma con la distribuzione dei punteggi stanini.
:::

::: {.callout-tip title="Soluzioni" collapse="true"}

```{r}
# Esercizio 1: Classificazione delle variabili

set.seed(123)  # Per riproducibilità
data <- data.frame(
  ID = 1:20,
  Sesso = sample(c("M", "F"), 20, replace = TRUE),
  Ansia = factor(sample(1:5, 20, replace = TRUE), ordered = TRUE),  # Dati ordinali
  QI = rnorm(20, mean = 100, sd = 15),  # Dati di intervallo
  Tempo_Reazione = runif(20, min = 0.3, max = 2.5)  # Dati di rapporto
)

# Verifica della classe delle variabili
sapply(data, class)

# Esercizio 2: Calcolo di Punteggi Standardizzati
data$QI_z <- scale(data$QI)
data$Tempo_Reazione_z <- scale(data$Tempo_Reazione)

# Visualizzazione della distribuzione
par(mfrow = c(2, 2))
hist(data$QI, main = "Distribuzione QI Grezzo", col = "lightblue")
hist(data$QI_z, main = "Distribuzione QI Standardizzato", col = "lightgreen")
hist(data$Tempo_Reazione, main = "Distribuzione Tempo di Reazione Grezzo", col = "lightblue")
hist(data$Tempo_Reazione_z, main = "Distribuzione Tempo di Reazione Standardizzato", col = "lightgreen")
par(mfrow = c(1, 1))

# Esercizio 3: Calcolo di Punteggi Percentili
data$Percentile_QI <- ecdf(data$QI)(data$QI) * 100

# Mostra i primi 10 percentili calcolati
head(data[, c("QI", "Percentile_QI")], 10)

# Calcola il valore di QI corrispondente al 90° percentile
quantile(data$QI, 0.90)

# Esercizio 4: Confronto tra Normazione Tradizionale e Basata sulla Regressione
set.seed(123)
data$Eta <- sample(18:65, 20, replace = TRUE)
data$Test_Cognitivo <- 50 + 0.3 * data$Eta + rnorm(20, sd = 5)

# Normazione Tradizionale: suddivisione in gruppi di età
data$Gruppo_Età <- cut(data$Eta, breaks = c(18, 30, 45, 65), labels = c("18-30", "31-45", "46-65"))

# Calcolo della media e deviazione standard per ciascun gruppo
aggregate(Test_Cognitivo ~ Gruppo_Età, data = data, FUN = function(x) c(media = mean(x), sd = sd(x)))

# Normazione basata sulla regressione
mod <- lm(Test_Cognitivo ~ Eta, data = data)
data$Test_Cognitivo_Pred <- predict(mod)

# Confronto tra metodi
plot(data$Eta, data$Test_Cognitivo, main = "Normazione Tradizionale vs Regressione", pch = 19, col = "blue")
lines(data$Eta, data$Test_Cognitivo_Pred, col = "red", lwd = 2)
legend("topright", legend = c("Dati Osservati", "Modello Regressione"), col = c("blue", "red"), pch = c(19, NA), lwd = c(NA, 2))

# Esercizio 5: Simulazione della Distribuzione dei Punteggi Stanini
set.seed(123)
punteggi <- rnorm(1000, mean = 50, sd = 10)
stanine <- round((punteggi - mean(punteggi)) / sd(punteggi) * 2 + 5)
stanine <- pmax(pmin(stanine, 9), 1)

# Visualizzazione della distribuzione
hist(stanine, breaks = seq(0.5, 9.5, 1), main = "Distribuzione dei Punteggi Stanini", col = "lightblue", xlab = "Stanine", xaxt = "n")
axis(1, at = 1:9, labels = 1:9)
```
:::

## Session Info {.unnumbered}

```{r}
sessionInfo()
```

