<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Corrado Caudek">
<title>14&nbsp; Modelli multilivello – Testing Psicologico</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/raters/02_interrater_reliability.html" rel="next">
<link href="../../chapters/ctt/06_ctt_applications.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e1a6050b06ba78a9acb7bca22e74f83e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-c1966a8c70583a3816b1e3a216c1caf1.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/raters/01_multilevel.html">Giudici</a></li><li class="breadcrumb-item"><a href="../../chapters/raters/01_multilevel.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modelli multilivello</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Testing Psicologico</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/testing_psicologico/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Attiva/disattiva la modalità oscura"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benvenuti</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendario</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cal_testing_psic_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calendario Didattico e Programma del Corso</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Punteggi e scale</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/01_scores_scales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Punteggi e scale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E1_likert.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E2_optimal_scoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E3_thurstone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/02_development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sviluppo dello strumento</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/03_equating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Equating nei Test Psicologici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/measurement/E4_norming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">CTT</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/01_ctt_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fondamenti teorici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/02_ctt_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">L’affidabilità del test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/03_ctt_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Metodi di stima dell’affidabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/04_err_std_mis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">L’errore standard della misurazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/05_err_std_stima.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">La stima del punteggio vero</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ctt/06_ctt_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Applicazioni della CTT</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Giudici</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/raters/01_multilevel.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modelli multilivello</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/raters/02_interrater_reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">L’affidabilità tra giudici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/raters/E1_irr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Validità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/validity/01_validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">La Validità del test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/validity/02_other_variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Relazioni test-criterio</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Generalizzabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/gtheory/01_gtheory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Teoria della generalizzabilità</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Items</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/items/01_item_development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Lo sviluppo degli item</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/items/02_item_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analisi degli item</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Analisi dei percorsi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/path_analysis/01_path_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analisi dei percorsi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/path_analysis/02_clement_2022.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Riparazione affettiva post-infedeltà</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Networks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/networks/01_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Network psicologici</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">PCA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/pca/01_linear_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Elementi di algebra lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/pca/02_pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Analisi delle componenti principali</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">FA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/01_intro_fa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Introduzione all’analisi fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/02_analisi_fattoriale_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Il modello unifattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/03_analisi_fattoriale_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Il modello statistico dell’analisi fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/04_analisi_fattoriale_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Il modello multifattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/05_factor_scores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">I punteggi fattoriali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/06_constraints_on_parms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Attendibilità e modello fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fa/07_total_score.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Punteggio totale e modello fattoriale</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Costruzione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/01_val_matrici.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Valutazione della matrice di correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/02_estrazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">L’estrazione dei fattori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/03_numero_fattori.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Il numero dei fattori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/04_rotazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">La rotazione fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/extraction/05_val_soluzione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Valutare e rifinire la soluzione fattoriale</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">CFA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/01_cfa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Analisti Fattoriale Confermativa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/02_meanstructure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">La struttura delle medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/03_cat_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Dati non gaussiani e categoriali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/04_mmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">CFA per matrici multi-tratto multi-metodo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/05_bifactor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modello bifattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/06_efa_lavaan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Exploratory Structural Equation Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/07_fa_in_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Strategia Integrata per un’Analisi Fattoriale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/E_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/cfa/E_02_bifactor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">SEM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/01_sem_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Introduzione ai Modelli SEM</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/02_data_preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Preparazione dei Dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/03_gof.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Test del Modello e Indicizzazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/04_mod_comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Confronto tra modelli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/05_cfa_mod_comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">CFA: confronto tra modelli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/06_refine_solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">La revisione del modello</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/07_group_invariance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Invarianza di misura</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/08_multilevel_sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Modelli di Equazioni Strutturali Multilivello</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/09_structural_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Modelli di Regressione Strutturale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/10_missing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Dati mancanti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/11_small_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Modellizzazione SEM in Piccoli Campioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/13_esem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Exploratory structural equation modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/14_sem_power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Dimensione Campionaria e Analisi della Potenza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/E_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/15_prior_pred_mod_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Prior Predictive Model Checking</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">Mokken</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mokken/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Modello di Regressione Logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sem/E_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">✏️ Esercizi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mokken/02_core_issues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Analisi della Scala di Mokken</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mokken/03_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Applicazione Pratica</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">IRT</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/01_rasch_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Modello di Rasch</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/02_assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Assunzioni e Proprietà del Modello di Rasch</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/03_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Stima</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/04_1pl_2pl_3pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Modelli 1PL, 2PL e 3PL</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/irt/05_implementation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Implementazione</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false">
 <span class="menu-text">LGM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/01_lgm_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Curve di crescita latente</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/02_lgm_prelims.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Considerazioni Preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/06_lgm_mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">LGM e modelli misti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/03_time_effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Dati longitudinali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/05_intro_panel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Specificare e Interpretare un Modello Longitudinale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/07_growth_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Curve di crescita latente</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/08_growth_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Il tempo su una metrica continua</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/09_time_inv_cov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Covariate indipendenti dal tempo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/10_growth_groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Modelli di crescita latenti a gruppi multipli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/11_lgm_wais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Lo Sviluppo dell’Intelligenza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/lgm/12_temp_reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Affidabilità longitudinale</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false">
 <span class="menu-text">Predizione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/prediction/01_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Predizione</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografia</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a1_intro_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Linguaggio R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a2_sums.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Simbolo di somma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a3_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">Soluzioni degli esercizi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/solutions_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Probabilità</span></span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Indice</h2>
   
  <ul>
<li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">14.1</span> Introduzione</a></li>
  <li>
<a href="#un-esempio-concreto-analisi-dei-dati-di-deprivazione-del-sonno" id="toc-un-esempio-concreto-analisi-dei-dati-di-deprivazione-del-sonno" class="nav-link" data-scroll-target="#un-esempio-concreto-analisi-dei-dati-di-deprivazione-del-sonno"><span class="header-section-number">14.2</span> Un Esempio Concreto: Analisi dei Dati di Deprivazione del Sonno</a>
  <ul>
<li><a href="#accesso-ai-dati" id="toc-accesso-ai-dati" class="nav-link" data-scroll-target="#accesso-ai-dati"><span class="header-section-number">14.2.1</span> Accesso ai Dati</a></li>
  <li><a href="#struttura-del-dataset" id="toc-struttura-del-dataset" class="nav-link" data-scroll-target="#struttura-del-dataset"><span class="header-section-number">14.2.2</span> Struttura del Dataset</a></li>
  <li>
<a href="#analisi-esplorativa" id="toc-analisi-esplorativa" class="nav-link" data-scroll-target="#analisi-esplorativa"><span class="header-section-number">14.2.3</span> Analisi Esplorativa</a>
  <ul>
<li><a href="#visualizzazione-per-un-singolo-partecipante" id="toc-visualizzazione-per-un-singolo-partecipante" class="nav-link" data-scroll-target="#visualizzazione-per-un-singolo-partecipante"><span class="header-section-number">14.2.3.1</span> Visualizzazione per un Singolo Partecipante</a></li>
  <li><a href="#visualizzazione-per-tutti-i-partecipanti" id="toc-visualizzazione-per-tutti-i-partecipanti" class="nav-link" data-scroll-target="#visualizzazione-per-tutti-i-partecipanti"><span class="header-section-number">14.2.3.2</span> Visualizzazione per Tutti i Partecipanti</a></li>
  </ul>
</li>
  <li><a href="#descrizione-del-disegno-sperimentale" id="toc-descrizione-del-disegno-sperimentale" class="nav-link" data-scroll-target="#descrizione-del-disegno-sperimentale"><span class="header-section-number">14.2.4</span> Descrizione del Disegno Sperimentale</a></li>
  <li><a href="#preparazione-dei-dati" id="toc-preparazione-dei-dati" class="nav-link" data-scroll-target="#preparazione-dei-dati"><span class="header-section-number">14.2.5</span> Preparazione dei Dati</a></li>
  </ul>
</li>
  <li><a href="#relazione-tra-tempo-di-reazione-e-privazione-del-sonno" id="toc-relazione-tra-tempo-di-reazione-e-privazione-del-sonno" class="nav-link" data-scroll-target="#relazione-tra-tempo-di-reazione-e-privazione-del-sonno"><span class="header-section-number">14.3</span> Relazione tra Tempo di Reazione e Privazione del Sonno</a></li>
  <li><a href="#scelta-del-modello-di-regressione" id="toc-scelta-del-modello-di-regressione" class="nav-link" data-scroll-target="#scelta-del-modello-di-regressione"><span class="header-section-number">14.4</span> Scelta del Modello di Regressione</a></li>
  <li>
<a href="#complete-pooling" id="toc-complete-pooling" class="nav-link" data-scroll-target="#complete-pooling"><span class="header-section-number">14.5</span> Complete pooling</a>
  <ul>
<li><a href="#modello-di-regressione-lineare-in-complete-pooling" id="toc-modello-di-regressione-lineare-in-complete-pooling" class="nav-link" data-scroll-target="#modello-di-regressione-lineare-in-complete-pooling"><span class="header-section-number">14.5.1</span> Modello di Regressione Lineare in Complete Pooling</a></li>
  <li><a href="#visualizzazione" id="toc-visualizzazione" class="nav-link" data-scroll-target="#visualizzazione"><span class="header-section-number">14.5.2</span> Visualizzazione</a></li>
  </ul>
</li>
  <li>
<a href="#approccio-di-no-pooling" id="toc-approccio-di-no-pooling" class="nav-link" data-scroll-target="#approccio-di-no-pooling"><span class="header-section-number">14.6</span> Approccio di No Pooling</a>
  <ul>
<li><a href="#caratteristiche-del-no-pooling" id="toc-caratteristiche-del-no-pooling" class="nav-link" data-scroll-target="#caratteristiche-del-no-pooling"><span class="header-section-number">14.6.1</span> Caratteristiche del No Pooling</a></li>
  <li><a href="#implementazione-del-modello-di-no-pooling" id="toc-implementazione-del-modello-di-no-pooling" class="nav-link" data-scroll-target="#implementazione-del-modello-di-no-pooling"><span class="header-section-number">14.6.2</span> Implementazione del Modello di No Pooling</a></li>
  </ul>
</li>
  <li>
<a href="#partial-pooling" id="toc-partial-pooling" class="nav-link" data-scroll-target="#partial-pooling"><span class="header-section-number">14.7</span> Partial Pooling</a>
  <ul>
<li><a href="#il-vantaggio-del-partial-pooling" id="toc-il-vantaggio-del-partial-pooling" class="nav-link" data-scroll-target="#il-vantaggio-del-partial-pooling"><span class="header-section-number">14.7.1</span> Il Vantaggio del Partial Pooling</a></li>
  <li><a href="#implementazione-dei-modelli-a-effetti-misti" id="toc-implementazione-dei-modelli-a-effetti-misti" class="nav-link" data-scroll-target="#implementazione-dei-modelli-a-effetti-misti"><span class="header-section-number">14.7.2</span> Implementazione dei Modelli a Effetti Misti</a></li>
  <li><a href="#articolazione-e-applicazione-del-modello-multilivello" id="toc-articolazione-e-applicazione-del-modello-multilivello" class="nav-link" data-scroll-target="#articolazione-e-applicazione-del-modello-multilivello"><span class="header-section-number">14.7.3</span> Articolazione e Applicazione del Modello Multilivello</a></li>
  <li><a href="#livello-1-relazione-individuale" id="toc-livello-1-relazione-individuale" class="nav-link" data-scroll-target="#livello-1-relazione-individuale"><span class="header-section-number">14.7.4</span> Livello 1: Relazione Individuale</a></li>
  <li><a href="#livello-2-variabilit%C3%A0-tra-soggetti" id="toc-livello-2-variabilità-tra-soggetti" class="nav-link" data-scroll-target="#livello-2-variabilit%C3%A0-tra-soggetti"><span class="header-section-number">14.7.5</span> Livello 2: Variabilità Tra Soggetti</a></li>
  <li><a href="#modello-completo" id="toc-modello-completo" class="nav-link" data-scroll-target="#modello-completo"><span class="header-section-number">14.7.6</span> Modello Completo</a></li>
  <li><a href="#interpretazione-degli-effetti-fissi-e-casuali" id="toc-interpretazione-degli-effetti-fissi-e-casuali" class="nav-link" data-scroll-target="#interpretazione-degli-effetti-fissi-e-casuali"><span class="header-section-number">14.7.7</span> Interpretazione degli Effetti Fissi e Casuali</a></li>
  <li><a href="#importanza-della-matrice-di-varianza-covarianza" id="toc-importanza-della-matrice-di-varianza-covarianza" class="nav-link" data-scroll-target="#importanza-della-matrice-di-varianza-covarianza"><span class="header-section-number">14.7.8</span> Importanza della Matrice di Varianza-Covarianza</a></li>
  <li><a href="#vantaggi-del-modello-multilivello" id="toc-vantaggi-del-modello-multilivello" class="nav-link" data-scroll-target="#vantaggi-del-modello-multilivello"><span class="header-section-number">14.7.9</span> Vantaggi del Modello Multilivello</a></li>
  </ul>
</li>
  <li>
<a href="#stima-dei-parametri-del-modello" id="toc-stima-dei-parametri-del-modello" class="nav-link" data-scroll-target="#stima-dei-parametri-del-modello"><span class="header-section-number">14.8</span> Stima dei Parametri del Modello</a>
  <ul>
<li><a href="#sintassi-generale-di-lmer" id="toc-sintassi-generale-di-lmer" class="nav-link" data-scroll-target="#sintassi-generale-di-lmer"><span class="header-section-number">14.8.1</span> Sintassi Generale di <code>lmer()</code></a></li>
  <li><a href="#effetti-casuali-nella-formula" id="toc-effetti-casuali-nella-formula" class="nav-link" data-scroll-target="#effetti-casuali-nella-formula"><span class="header-section-number">14.8.2</span> Effetti Casuali nella Formula</a></li>
  <li>
<a href="#esempi-di-modelli-con-sleep2" id="toc-esempi-di-modelli-con-sleep2" class="nav-link" data-scroll-target="#esempi-di-modelli-con-sleep2"><span class="header-section-number">14.8.3</span> Esempi di Modelli con <code>sleep2</code></a>
  <ul>
<li><a href="#solo-intercette-casuali" id="toc-solo-intercette-casuali" class="nav-link" data-scroll-target="#solo-intercette-casuali"><span class="header-section-number">14.8.3.1</span> Solo Intercette Casuali</a></li>
  <li><a href="#intercette-e-pendenze-casuali" id="toc-intercette-e-pendenze-casuali" class="nav-link" data-scroll-target="#intercette-e-pendenze-casuali"><span class="header-section-number">14.8.3.2</span> Intercette e Pendenze Casuali</a></li>
  <li><a href="#pendenze-casuali-senza-correlazione" id="toc-pendenze-casuali-senza-correlazione" class="nav-link" data-scroll-target="#pendenze-casuali-senza-correlazione"><span class="header-section-number">14.8.3.3</span> Pendenze Casuali Senza Correlazione</a></li>
  <li><a href="#solo-pendenze-casuali" id="toc-solo-pendenze-casuali" class="nav-link" data-scroll-target="#solo-pendenze-casuali"><span class="header-section-number">14.8.3.4</span> Solo Pendenze Casuali</a></li>
  </ul>
</li>
  <li><a href="#scelta-del-modello" id="toc-scelta-del-modello" class="nav-link" data-scroll-target="#scelta-del-modello"><span class="header-section-number">14.8.4</span> Scelta del Modello</a></li>
  <li><a href="#applicazione" id="toc-applicazione" class="nav-link" data-scroll-target="#applicazione"><span class="header-section-number">14.8.5</span> Applicazione</a></li>
  <li>
<a href="#predizioni-del-modello" id="toc-predizioni-del-modello" class="nav-link" data-scroll-target="#predizioni-del-modello"><span class="header-section-number">14.8.6</span> Predizioni del Modello</a>
  <ul>
<li><a href="#creazione-di-un-nuovo-dataset" id="toc-creazione-di-un-nuovo-dataset" class="nav-link" data-scroll-target="#creazione-di-un-nuovo-dataset"><span class="header-section-number">14.8.6.1</span> Creazione di un Nuovo Dataset</a></li>
  <li><a href="#dettagli-del-codice" id="toc-dettagli-del-codice" class="nav-link" data-scroll-target="#dettagli-del-codice"><span class="header-section-number">14.8.6.2</span> Dettagli del Codice</a></li>
  <li><a href="#calcolo-delle-predizioni" id="toc-calcolo-delle-predizioni" class="nav-link" data-scroll-target="#calcolo-delle-predizioni"><span class="header-section-number">14.8.6.3</span> Calcolo delle Predizioni</a></li>
  </ul>
</li>
  <li><a href="#visualizzazione-grafica" id="toc-visualizzazione-grafica" class="nav-link" data-scroll-target="#visualizzazione-grafica"><span class="header-section-number">14.8.7</span> Visualizzazione Grafica</a></li>
  </ul>
</li>
  <li>
<a href="#interpretare-loutput-di-lmer-ed-estrarre-le-stime" id="toc-interpretare-loutput-di-lmer-ed-estrarre-le-stime" class="nav-link" data-scroll-target="#interpretare-loutput-di-lmer-ed-estrarre-le-stime"><span class="header-section-number">14.9</span> Interpretare l’output di <code>lmer()</code> ed estrarre le stime</a>
  <ul>
<li><a href="#effetti-fissi" id="toc-effetti-fissi" class="nav-link" data-scroll-target="#effetti-fissi"><span class="header-section-number">14.9.1</span> Effetti fissi</a></li>
  <li><a href="#effetti-random" id="toc-effetti-random" class="nav-link" data-scroll-target="#effetti-random"><span class="header-section-number">14.9.2</span> Effetti random</a></li>
  </ul>
</li>
  <li><a href="#riflessioni-conclusive" id="toc-riflessioni-conclusive" class="nav-link" data-scroll-target="#riflessioni-conclusive"><span class="header-section-number">14.10</span> Riflessioni Conclusive</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">14.11</span> Session Info</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/raters/01_multilevel.html">Giudici</a></li><li class="breadcrumb-item"><a href="../../chapters/raters/01_multilevel.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modelli multilivello</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-raters-multilevel-models" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modelli multilivello</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo apprenderai come:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>implementare e confrontare i modelli di <strong>complete pooling</strong>, <strong>no pooling</strong> e <strong>partial pooling</strong>, comprendendone le differenze concettuali e applicative;</li>
<li>interpretare l’output della funzione <code>lmer()</code> e utilizzare le stime dei parametri per analisi e visualizzazioni dei risultati.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Reliability</em> del testo di <span class="citation" data-cites="petersen2024principles">Petersen (<a href="../../99-references.html#ref-petersen2024principles" role="doc-biblioref">2024</a>)</span>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">car</span>, <span class="va">lme4</span>, <span class="va">lavaan</span>, <span class="va">semPlot</span>, <span class="va">repr</span>, <span class="va">kableExtra</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="introduzione" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">14.1</span> Introduzione</h2>
<p>I modelli multilivello, anche denominati modelli gerarchici o a effetti misti, costituiscono un approccio statistico avanzato progettato per analizzare dati organizzati in strutture gerarchiche o nidificate. Tali modelli consentono di modellare simultaneamente variazioni a diversi livelli di aggregazione, come il livello individuale e quello di gruppo, migliorando la precisione dell’inferenza e la comprensione delle dinamiche sottostanti ai dati.</p>
<p>In psicologia, i modelli multilivello rivestono un ruolo fondamentale, poiché i dati spesso derivano da contesti complessi in cui fattori individuali e ambientali interagiscono. Per esempio, nell’analisi delle prestazioni cognitive o delle risposte emotive, questi modelli permettono di distinguere le variazioni attribuibili a caratteristiche individuali (ad es., abilità cognitiva, tratti di personalità) da quelle dovute a fattori ambientali (ad es., clima scolastico, dinamiche familiari).</p>
<p>Le principali applicazioni dei modelli multilivello includono:</p>
<ul>
<li>
<strong>Analisi di dati longitudinali</strong>: Gestiscono la dipendenza seriale introdotta da misurazioni ripetute sugli stessi soggetti, migliorando l’accuratezza nell’estimare gli effetti temporali.</li>
<li>
<strong>Studio dell’impatto di fattori contestuali</strong>: Permettono di quantificare l’influenza dell’ambiente su variabili psicologiche, fornendo stime che isolano gli effetti specifici dei contesti.</li>
<li>
<strong>Rappresentazione della variabilità intra- e inter-individuale</strong>: Offrono una modellazione flessibile che cattura sia le differenze tra individui sia le fluttuazioni all’interno dello stesso individuo, riflettendo fedelmente la complessità dei processi psicologici.</li>
</ul></section><section id="un-esempio-concreto-analisi-dei-dati-di-deprivazione-del-sonno" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="un-esempio-concreto-analisi-dei-dati-di-deprivazione-del-sonno">
<span class="header-section-number">14.2</span> Un Esempio Concreto: Analisi dei Dati di Deprivazione del Sonno</h2>
<p>Questo capitolo illustra l’applicazione pratica dei modelli multilivello nell’analisi dei dati di uno studio sperimentale che ha investigato l’effetto della deprivazione del sonno sulle prestazioni psicomotorie. I dati analizzati provengono dalla ricerca di Belenky et al.&nbsp;(2003), che ha esaminato gli effetti cumulativi della restrizione del sonno.</p>
<section id="accesso-ai-dati" class="level3" data-number="14.2.1"><h3 data-number="14.2.1" class="anchored" data-anchor-id="accesso-ai-dati">
<span class="header-section-number">14.2.1</span> Accesso ai Dati</h3>
<p>I dati utilizzati sono inclusi nel dataset <code>sleepstudy</code>, disponibile nel pacchetto <code>lme4</code> di R <span class="citation" data-cites="bates2014fitting">(<a href="../../99-references.html#ref-bates2014fitting" role="doc-biblioref">Bates et al., 2014</a>)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">sleepstudy</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il dataset è costituito da 180 osservazioni e contiene tre variabili principali:</p>
<ul>
<li>
<strong><code>Reaction</code></strong>: Tempo medio di reazione (in millisecondi).</li>
<li>
<strong><code>Days</code></strong>: Numero di giorni consecutivi di deprivazione del sonno.</li>
<li>
<strong><code>Subject</code></strong>: Identificativo del partecipante.</li>
</ul></section><section id="struttura-del-dataset" class="level3" data-number="14.2.2"><h3 data-number="14.2.2" class="anchored" data-anchor-id="struttura-del-dataset">
<span class="header-section-number">14.2.2</span> Struttura del Dataset</h3>
<p>Il dataset presenta una tipica struttura multilivello: dati longitudinali con misurazioni ripetute del tempo medio di reazione (variabile dipendente) raccolte dai medesimi partecipanti nell’arco di dieci giorni. Tale configurazione è comune in psicologia sperimentale, dove è frequente analizzare variazioni intra-individuali e inter-individuali.</p>
<p>I 18 partecipanti dello studio sono stati sottoposti a una restrizione del sonno di tre ore per notte. Ogni giorno, per dieci giorni consecutivi, hanno eseguito un “test di vigilanza psicomotoria” di dieci minuti. Durante il test, i partecipanti monitoravano uno schermo e premevano un pulsante il più rapidamente possibile alla comparsa di uno stimolo visivo. La variabile di interesse è il <strong>tempo medio di reazione (RT)</strong>, utilizzato come indicatore delle prestazioni psicomotorie.</p>
</section><section id="analisi-esplorativa" class="level3" data-number="14.2.3"><h3 data-number="14.2.3" class="anchored" data-anchor-id="analisi-esplorativa">
<span class="header-section-number">14.2.3</span> Analisi Esplorativa</h3>
<section id="visualizzazione-per-un-singolo-partecipante" class="level4" data-number="14.2.3.1"><h4 data-number="14.2.3.1" class="anchored" data-anchor-id="visualizzazione-per-un-singolo-partecipante">
<span class="header-section-number">14.2.3.1</span> Visualizzazione per un Singolo Partecipante</h4>
<p>Per iniziare, si può esaminare l’andamento del tempo medio di reazione per un singolo partecipante. Ad esempio, consideriamo il soggetto identificato con <code>308</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">just_308</span> <span class="op">&lt;-</span> <span class="va">sleepstudy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op">==</span> <span class="st">"308"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">just_308</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Days</span>, y <span class="op">=</span> <span class="va">Reaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Andamento del tempo di reazione (Soggetto 308)"</span>, </span>
<span>         x <span class="op">=</span> <span class="st">"Giorni di deprivazione del sonno"</span>, </span>
<span>         y <span class="op">=</span> <span class="st">"Tempo medio di reazione (ms)"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_multilevel_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="visualizzazione-per-tutti-i-partecipanti" class="level4" data-number="14.2.3.2"><h4 data-number="14.2.3.2" class="anchored" data-anchor-id="visualizzazione-per-tutti-i-partecipanti">
<span class="header-section-number">14.2.3.2</span> Visualizzazione per Tutti i Partecipanti</h4>
<p>Per un’analisi più completa, è utile rappresentare i dati di tutti i 18 partecipanti in un’unica visualizzazione, evidenziando le differenze individuali nelle prestazioni psicomotorie durante il periodo di studio:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sleepstudy</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Days</span>, y <span class="op">=</span> <span class="va">Reaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Andamento del tempo di reazione per tutti i partecipanti"</span>, </span>
<span>         x <span class="op">=</span> <span class="st">"Giorni di deprivazione del sonno"</span>, </span>
<span>         y <span class="op">=</span> <span class="st">"Tempo medio di reazione (ms)"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_multilevel_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Queste visualizzazioni preliminari evidenziano sia le tendenze generali che le differenze individuali nel tempo di reazione in risposta alla deprivazione del sonno. Tali pattern saranno ulteriormente analizzati utilizzando modelli multilivello, che consentono di quantificare le variazioni intra-individuali e inter-individuali, isolando l’effetto cumulativo della deprivazione del sonno.</p>
</section></section><section id="descrizione-del-disegno-sperimentale" class="level3" data-number="14.2.4"><h3 data-number="14.2.4" class="anchored" data-anchor-id="descrizione-del-disegno-sperimentale">
<span class="header-section-number">14.2.4</span> Descrizione del Disegno Sperimentale</h3>
<ul>
<li><p><strong>Fase di Adattamento e Baseline</strong>: Lo studio è iniziato con tre giorni preliminari dedicati all’adattamento e all’addestramento (T1 e T2) seguiti dalla misurazione baseline (B). Durante questi giorni, i partecipanti hanno mantenuto un regime di sonno controllato, trascorrendo 8 ore a letto ogni notte (dalle 23:00 alle 07:00). Lo scopo di questa fase era garantire una condizione standardizzata e ridurre la variabilità individuale dovuta a precedenti abitudini di sonno.</p></li>
<li><p><strong>Condizioni di Restrizione e Prolungamento del Sonno</strong>: A partire dal quarto giorno, i partecipanti sono stati assegnati a diverse condizioni sperimentali per un periodo di sette giorni consecutivi (E1-E7). La durata del tempo trascorso a letto (Time in Bed, TIB) è stata manipolata e variava da un minimo di 3 ore a un massimo di 9 ore, al fine di indurre stati progressivi di deprivazione o recupero del sonno.</p></li>
</ul>
<p>Nella codifica temporale dello studio: - I giorni 0 e 1 rappresentano la fase di adattamento e addestramento. - Il giorno 2 corrisponde alla misurazione baseline, che riflette le prestazioni psicomotorie in condizioni di sonno ottimale. - I giorni 3-9 rappresentano il periodo sperimentale, durante il quale è stata applicata la manipolazione del sonno.</p>
<p>Per l’analisi, è fondamentale considerare il giorno di baseline (2) come punto di riferimento per valutare gli effetti della manipolazione del sonno sulle prestazioni. I giorni di adattamento e addestramento (0 e 1) devono essere esclusi dall’analisi, poiché le variazioni osservate in questa fase sono attribuibili all’acclimatazione ai protocolli dello studio e non alle condizioni sperimentali di sonno. L’esclusione di questi giorni garantisce che le stime dell’effetto siano focalizzate esclusivamente sull’impatto della restrizione o del prolungamento del sonno.</p>
</section><section id="preparazione-dei-dati" class="level3" data-number="14.2.5"><h3 data-number="14.2.5" class="anchored" data-anchor-id="preparazione-dei-dati">
<span class="header-section-number">14.2.5</span> Preparazione dei Dati</h3>
<p>La preparazione dei dati è un passaggio essenziale per garantire che l’analisi rifletta accuratamente gli effetti della manipolazione sperimentale. I seguenti passaggi sono stati eseguiti:</p>
<ol type="1">
<li><p><strong>Rimozione delle Osservazioni Iniziali</strong><br>
Le osservazioni relative ai giorni 0 e 1, corrispondenti alla fase di adattamento e addestramento, sono state escluse dal dataset. Questo assicura che l’analisi si concentri esclusivamente sul periodo di interesse, ovvero il baseline (giorno 2) e i successivi giorni di manipolazione del sonno.</p></li>
<li><p><strong>Creazione di una Variabile Ricodificata</strong><br>
È stata generata una nuova variabile, <code>days_deprived</code>, per rappresentare il numero di giorni di privazione del sonno a partire dal giorno baseline (giorno 2). La ricodifica inizia con 0 per il giorno baseline, 1 per il primo giorno di privazione (giorno 3), e così via. Questa variabile facilita la lettura e l’interpretazione dei risultati nel contesto del protocollo sperimentale.</p></li>
<li><p><strong>Salvataggio del Dataset Modificato</strong><br>
Il dataset modificato è stato denominato <code>sleep2</code> e ora include solo le osservazioni rilevanti per l’analisi, con una chiara distinzione tra il baseline e i giorni di privazione del sonno.</p></li>
</ol>
<p>Ecco il codice per implementare questi passaggi:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Filtraggio e creazione della nuova variabile</span></span>
<span><span class="va">sleep2</span> <span class="op">&lt;-</span> <span class="va">sleepstudy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Days</span> <span class="op">&gt;=</span> <span class="fl">2L</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># Escludiamo i giorni 0 e 1</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>days_deprived <span class="op">=</span> <span class="va">Days</span> <span class="op">-</span> <span class="fl">2L</span><span class="op">)</span>  <span class="co"># Ricodifichiamo la variabile Days</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>
<strong>Verifica della Ricodifica</strong><br>
La correttezza della ricodifica è stata verificata calcolando il numero di osservazioni per ciascun valore di <code>days_deprived</code> e confrontandolo con i valori originali della variabile <code>Days</code>:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sleep2</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">days_deprived</span>, <span class="va">Days</span><span class="op">)</span></span>
<span><span class="co">#&gt;   days_deprived Days  n</span></span>
<span><span class="co">#&gt; 1             0    2 18</span></span>
<span><span class="co">#&gt; 2             1    3 18</span></span>
<span><span class="co">#&gt; 3             2    4 18</span></span>
<span><span class="co">#&gt; 4             3    5 18</span></span>
<span><span class="co">#&gt; 5             4    6 18</span></span>
<span><span class="co">#&gt; 6             5    7 18</span></span>
<span><span class="co">#&gt; 7             6    8 18</span></span>
<span><span class="co">#&gt; 8             7    9 18</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>
<strong>Visualizzazione dei Dati</strong><br>
Per esplorare le tendenze individuali nel tempo di reazione in funzione dei giorni di privazione del sonno, è stato creato un grafico a dispersione con le seguenti caratteristiche:
<ul>
<li>L’asse x rappresenta i giorni di privazione del sonno, con 0 corrispondente al baseline.</li>
<li>L’asse y rappresenta il tempo medio di reazione (<code>Reaction</code>).</li>
<li>Ogni partecipante è visualizzato separatamente tramite il wrapping dei facet.</li>
</ul>
</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sleep2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">days_deprived</span>, y <span class="op">=</span> <span class="va">Reaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="st">"Tempo medio di reazione (ms)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Giorni di privazione del sonno (0 = baseline)"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Andamento del tempo di reazione durante la privazione del sonno"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_multilevel_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questa preparazione consente un’analisi più mirata, isolando gli effetti della privazione del sonno e semplificando l’interpretazione delle dinamiche temporali.</p>
</section></section><section id="relazione-tra-tempo-di-reazione-e-privazione-del-sonno" class="level2" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="relazione-tra-tempo-di-reazione-e-privazione-del-sonno">
<span class="header-section-number">14.3</span> Relazione tra Tempo di Reazione e Privazione del Sonno</h2>
<p>L’analisi dei dati relativi alla privazione del sonno rivela che, con una singola eccezione (il soggetto 335), il tempo medio di reazione tende ad aumentare progressivamente con ogni giorno di privazione aggiuntivo. Questo trend suggerisce che un modello di regressione lineare potrebbe essere utile per descrivere le prestazioni di ciascun partecipante.</p>
<p>La regressione lineare è definita dalla seguente equazione:</p>
<p><span class="math display">\[
E(Y) = \beta_0 + \beta_1 X,
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(Y\)</span> rappresenta la variabile dipendente (il tempo di reazione medio),</li>
<li>
<span class="math inline">\(\beta_0\)</span> è l’intercetta, ovvero il tempo di reazione stimato al giorno iniziale (baseline, senza privazione del sonno),</li>
<li>
<span class="math inline">\(\beta_1\)</span> è il coefficiente di pendenza, che rappresenta la variazione stimata nel tempo di reazione per ogni giorno di privazione aggiuntivo,</li>
<li>
<span class="math inline">\(X\)</span> indica il numero di giorni di privazione del sonno.</li>
</ul>
<p>I parametri <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> vengono stimati dai dati, e la loro interpretazione fornisce informazioni chiave sulle dinamiche delle prestazioni psicomotorie.</p>
</section><section id="scelta-del-modello-di-regressione" class="level2" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="scelta-del-modello-di-regressione">
<span class="header-section-number">14.4</span> Scelta del Modello di Regressione</h2>
<p>Un aspetto cruciale nell’analisi è decidere quale struttura modellistica adottare per descrivere i dati. Si devono considerare le seguenti opzioni:</p>
<ol type="1">
<li><p><strong>Complete Pooling</strong><br>
Questo approccio utilizza un unico modello di regressione lineare per tutti i partecipanti, assumendo che la relazione tra privazione del sonno e tempo di reazione sia identica per tutti. In pratica, si stima una singola intercetta (<span class="math inline">\(\beta_0\)</span>) e una singola pendenza (<span class="math inline">\(\beta_1\)</span>) comuni a tutti i soggetti. Sebbene semplice, questo metodo ignora completamente le differenze individuali.</p></li>
<li><p><strong>No Pooling</strong><br>
Qui, si stima un modello di regressione lineare separato per ciascun partecipante, consentendo a ogni soggetto di avere una propria intercetta e una propria pendenza. Questo approccio riconosce pienamente le variazioni individuali, ma potrebbe risultare eccessivamente complesso e sensibile al rumore nei dati, specialmente con pochi punti di osservazione per soggetto.</p></li>
<li><p><strong>Partial Pooling</strong><br>
Questo approccio intermedio, spesso implementato attraverso modelli multilivello, bilancia i due estremi sopra descritti. Si assume una relazione media condivisa tra i soggetti (ad esempio, una pendenza media), ma si consente una variazione individuale attorno a questa media. Il partial pooling sfrutta le informazioni condivise tra i partecipanti, migliorando la robustezza delle stime, specialmente in presenza di pochi dati per soggetto.</p></li>
</ol></section><section id="complete-pooling" class="level2" data-number="14.5"><h2 data-number="14.5" class="anchored" data-anchor-id="complete-pooling">
<span class="header-section-number">14.5</span> Complete pooling</h2>
<p>L’approccio di “complete pooling” in analisi statistica implica l’utilizzo di un modello che calcola un’unica intercetta e una sola pendenza per l’intero dataset. Questo metodo si basa sull’ipotesi che tutti i soggetti nel dataset condividano le stesse caratteristiche di base riguardo alla relazione tra la variabile dipendente e indipendente.</p>
<p>Questo approccio non tiene conto delle possibili differenze individuali nelle intercette o nelle pendenze tra i diversi soggetti. Ad esempio, ignorara come ciascun soggetto reagisce in modo diverso alla privazione del sonno.</p>
<p>Dall’analisi preliminare dei dati, abbiamo notato che l’approccio di complete pooling potrebbe non essere adatto per il nostro studio. La visualizzazione dei dati suggerisce che ogni partecipante potrebbe avere una propria relazione unica tra il tempo di reazione e i giorni di privazione del sonno, indicando la necessità di valori individuali per le intercette e le pendenze.</p>
<section id="modello-di-regressione-lineare-in-complete-pooling" class="level3" data-number="14.5.1"><h3 data-number="14.5.1" class="anchored" data-anchor-id="modello-di-regressione-lineare-in-complete-pooling">
<span class="header-section-number">14.5.1</span> Modello di Regressione Lineare in Complete Pooling</h3>
<p>Il modello generale lineare (GLM) per l’approccio di complete pooling è formulato come segue:</p>
<p><span class="math display">\[
Y_{sd} = \beta_0 + \beta_1 X_{sd} + e_{sd},
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(Y_{sd}\)</span> rappresenta il tempo di reazione medio del soggetto <span class="math inline">\(s\)</span> nel giorno <span class="math inline">\(d\)</span>.</li>
<li>
<span class="math inline">\(X_{sd}\)</span> è il numero di giorni di privazione del sonno (variabile <code>days_deprived</code>), che varia da 0 a 7.</li>
<li>
<span class="math inline">\(e_{sd}\)</span> è il termine di errore, che rappresenta le fluttuazioni casuali non spiegate dal modello.</li>
</ul>
<p>Per adattare questo modello in R, si utilizza la funzione <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">days_deprived</span>, <span class="va">sleep2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cp_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Reaction ~ days_deprived, data = sleep2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -112.28  -26.73    2.14   27.73  140.45 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)     267.97       7.74   34.63  &lt; 2e-16</span></span>
<span><span class="co">#&gt; days_deprived    11.44       1.85    6.18  6.3e-09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 50.9 on 142 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.212,  Adjusted R-squared:  0.207 </span></span>
<span><span class="co">#&gt; F-statistic: 38.2 on 1 and 142 DF,  p-value: 6.32e-09</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il modello di regressione che abbiamo considerato offre una stima del tempo di risposta medio per i soggetti allo studio al Giorno 0 (prima della privazione del sonno) e la variazione media del tempo di risposta per ogni giorno aggiuntivo di privazione. Secondo questo modello, il tempo di risposta medio iniziale è stimato essere di circa 268 millisecondi, con un incremento medio di circa 11 millisecondi per ogni giorno successivo di privazione del sonno.</p>
<p>È importante notare, tuttavia, che questo modello potrebbe avere delle limitazioni nella sua applicabilità:</p>
<ul>
<li>
<strong>Assunzione di Indipendenza</strong>: Il modello assume che tutte le osservazioni siano indipendenti. Questa assunzione potrebbe non essere valida nel nostro studio, dato che le osservazioni provengono da misurazioni ripetute sugli stessi soggetti.</li>
<li>
<strong>Errori Standard dei Coefficienti</strong>: La presunta indipendenza delle osservazioni implica che gli errori standard dei coefficienti di regressione potrebbero non essere completamente affidabili.</li>
</ul></section><section id="visualizzazione" class="level3" data-number="14.5.2"><h3 data-number="14.5.2" class="anchored" data-anchor-id="visualizzazione">
<span class="header-section-number">14.5.2</span> Visualizzazione</h3>
<p>Per visualizzare meglio questi risultati, possiamo aggiungere le previsioni del modello al grafico che abbiamo già creato. Utilizziamo la funzione <code>geom_abline()</code> di R per tracciare la linea di regressione stimata direttamente sul grafico esistente:</p>
<ul>
<li>
<strong>Utilizzo di <code>geom_abline()</code></strong>: Questa funzione ci permette di aggiungere una linea di regressione al grafico, specificando l’intercetta e la pendenza.</li>
<li>
<strong>Coefficienti del Modello</strong>: Utilizziamo <code>coef(cp_model)</code> per ottenere i coefficienti di regressione (intercetta e pendenza) dal nostro modello. Questa funzione restituisce un vettore con due elementi corrispondenti all’intercetta e alla pendenza, che possono essere poi utilizzati per definire la linea nel grafico.</li>
</ul>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sleep2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">days_deprived</span>, y <span class="op">=</span> <span class="va">Reaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span></span>
<span>        intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">cp_model</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>        slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">cp_model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Reaction Time"</span>, x <span class="op">=</span> <span class="st">"Days deprived of sleep (0 = baseline)"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_multilevel_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Dall’analisi effettuata, emerge che il modello attuale non si adatta in modo ottimale ai dati raccolti. Questa situazione indica la necessità di esplorare un approccio diverso per modellare in modo più accurato le relazioni presenti nei dati.</p>
</section></section><section id="approccio-di-no-pooling" class="level2" data-number="14.6"><h2 data-number="14.6" class="anchored" data-anchor-id="approccio-di-no-pooling">
<span class="header-section-number">14.6</span> Approccio di No Pooling</h2>
<p>In alternativa al modello di “complete pooling”, consideriamo l’approccio di “no pooling”. Questo approccio si basa sull’idea di adattare modelli di regressione separati per ogni partecipante, trattando ogni individuo come un’entità distinta.</p>
<section id="caratteristiche-del-no-pooling" class="level3" data-number="14.6.1"><h3 data-number="14.6.1" class="anchored" data-anchor-id="caratteristiche-del-no-pooling">
<span class="header-section-number">14.6.1</span> Caratteristiche del No Pooling</h3>
<ul>
<li>
<strong>Indipendenza delle Stime</strong>: In questo approccio, ogni partecipante ha il proprio set di stime per l’intercetta e la pendenza. Le stime relative a un partecipante non sono influenzate dalle stime degli altri.</li>
<li>
<strong>Stime Individualizzate</strong>: Si stima separatamente una coppia di intercetta/pendenza per ciascuno dei 18 partecipanti, riconoscendo la possibilità di variazioni significative nelle risposte individuali.</li>
</ul></section><section id="implementazione-del-modello-di-no-pooling" class="level3" data-number="14.6.2"><h3 data-number="14.6.2" class="anchored" data-anchor-id="implementazione-del-modello-di-no-pooling">
<span class="header-section-number">14.6.2</span> Implementazione del Modello di No Pooling</h3>
<p>Esistono due modi principali per implementare questo approccio:</p>
<ol type="1">
<li>
<strong>Regressioni Separate per Ogni Partecipante</strong>: Eseguire una serie di regressioni lineari individuali, una per ogni soggetto.</li>
<li>
<strong>Modello di Regressione Unificato con Effetti Principali e Interazione</strong>: Utilizzare un unico modello di regressione che includa sia gli effetti principali sia l’interazione tra le variabili <code>Subject</code> (soggetto) e <code>Day</code> (giorno). Questo metodo permette di includere tutte le stime in un unico modello.</li>
</ol>
<p>Per il secondo approccio, è necessario considerare le seguenti fasi:</p>
<ul>
<li>
<strong>Creazione di Variabili Dummy per il Fattore <code>Subject</code></strong>: Poiché <code>Subject</code> ha 18 livelli, saranno necessarie 17 variabili dummy per rappresentare questi livelli. In R, questo può essere fatto automaticamente definendo <code>Subject</code> come un fattore.</li>
<li>
<strong>Includere <code>Subject</code> come Fattore nel Modello</strong>: Aggiungere <code>Subject</code>, definito come un fattore, come predittore nel modello. L’inclusione dell’interazione tra <code>Subject</code> e <code>days_deprived</code> permette variazioni nelle intercette e nelle pendenze tra i soggetti.</li>
</ul>
<p>Prima di procedere, è importante assicurarsi che <code>Subject</code> sia definito correttamente come un fattore. Questo può essere verificato utilizzando la funzione <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> in R, che fornisce una sintesi delle caratteristiche della variabile, compreso se è trattata come un fattore.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sleep2</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Reaction        Days         Subject   days_deprived </span></span>
<span><span class="co">#&gt;  Min.   :203   Min.   :2.00   308    : 8   Min.   :0.00  </span></span>
<span><span class="co">#&gt;  1st Qu.:265   1st Qu.:3.75   309    : 8   1st Qu.:1.75  </span></span>
<span><span class="co">#&gt;  Median :303   Median :5.50   310    : 8   Median :3.50  </span></span>
<span><span class="co">#&gt;  Mean   :308   Mean   :5.50   330    : 8   Mean   :3.50  </span></span>
<span><span class="co">#&gt;  3rd Qu.:348   3rd Qu.:7.25   331    : 8   3rd Qu.:5.25  </span></span>
<span><span class="co">#&gt;  Max.   :466   Max.   :9.00   332    : 8   Max.   :7.00  </span></span>
<span><span class="co">#&gt;                               (Other):96</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La funzione <code>pull()</code> viene utilizzata per estrarre una specifica colonna da un data frame. Con le seguenti istruzioni verifichiamo se la colonna <code>Subject</code> è codificata come <code>factor</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sleep2</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pull</span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Adattiamo il modello di regressione ai dati. Si noti che la sintassi seguente può essere semplificata utilizzando <code>Reaction ~ days_deprived * Subject</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">np_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">days_deprived</span> <span class="op">+</span> <span class="va">Subject</span> <span class="op">+</span> <span class="va">days_deprived</span><span class="op">:</span><span class="va">Subject</span>,</span>
<span>    data <span class="op">=</span> <span class="va">sleep2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Reaction ~ days_deprived + Subject + days_deprived:Subject, </span></span>
<span><span class="co">#&gt;     data = sleep2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -106.52   -8.54    1.14    8.89  128.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                          Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)               288.217     16.477   17.49  &lt; 2e-16</span></span>
<span><span class="co">#&gt; days_deprived              21.690      3.939    5.51  2.5e-07</span></span>
<span><span class="co">#&gt; Subject309                -87.926     23.302   -3.77  0.00026</span></span>
<span><span class="co">#&gt; Subject310                -62.286     23.302   -2.67  0.00869</span></span>
<span><span class="co">#&gt; Subject330                -14.953     23.302   -0.64  0.52242</span></span>
<span><span class="co">#&gt; Subject331                  9.966     23.302    0.43  0.66974</span></span>
<span><span class="co">#&gt; Subject332                 27.816     23.302    1.19  0.23522</span></span>
<span><span class="co">#&gt; Subject333                 -2.758     23.302   -0.12  0.90600</span></span>
<span><span class="co">#&gt; Subject334                -50.205     23.302   -2.15  0.03342</span></span>
<span><span class="co">#&gt; Subject335                -25.343     23.302   -1.09  0.27921</span></span>
<span><span class="co">#&gt; Subject337                 24.614     23.302    1.06  0.29319</span></span>
<span><span class="co">#&gt; Subject349                -59.218     23.302   -2.54  0.01246</span></span>
<span><span class="co">#&gt; Subject350                -40.202     23.302   -1.73  0.08734</span></span>
<span><span class="co">#&gt; Subject351                -24.247     23.302   -1.04  0.30042</span></span>
<span><span class="co">#&gt; Subject352                 43.065     23.302    1.85  0.06732</span></span>
<span><span class="co">#&gt; Subject369                -21.504     23.302   -0.92  0.35815</span></span>
<span><span class="co">#&gt; Subject370                -53.307     23.302   -2.29  0.02411</span></span>
<span><span class="co">#&gt; Subject371                -30.490     23.302   -1.31  0.19350</span></span>
<span><span class="co">#&gt; Subject372                  2.477     23.302    0.11  0.91554</span></span>
<span><span class="co">#&gt; days_deprived:Subject309  -17.333      5.570   -3.11  0.00238</span></span>
<span><span class="co">#&gt; days_deprived:Subject310  -17.792      5.570   -3.19  0.00184</span></span>
<span><span class="co">#&gt; days_deprived:Subject330  -13.685      5.570   -2.46  0.01561</span></span>
<span><span class="co">#&gt; days_deprived:Subject331  -16.823      5.570   -3.02  0.00315</span></span>
<span><span class="co">#&gt; days_deprived:Subject332  -19.295      5.570   -3.46  0.00076</span></span>
<span><span class="co">#&gt; days_deprived:Subject333  -10.815      5.570   -1.94  0.05480</span></span>
<span><span class="co">#&gt; days_deprived:Subject334   -3.575      5.570   -0.64  0.52242</span></span>
<span><span class="co">#&gt; days_deprived:Subject335  -25.899      5.570   -4.65  9.5e-06</span></span>
<span><span class="co">#&gt; days_deprived:Subject337    0.752      5.570    0.13  0.89289</span></span>
<span><span class="co">#&gt; days_deprived:Subject349   -5.264      5.570   -0.95  0.34673</span></span>
<span><span class="co">#&gt; days_deprived:Subject350    1.601      5.570    0.29  0.77438</span></span>
<span><span class="co">#&gt; days_deprived:Subject351  -13.168      5.570   -2.36  0.01987</span></span>
<span><span class="co">#&gt; days_deprived:Subject352  -14.402      5.570   -2.59  0.01106</span></span>
<span><span class="co">#&gt; days_deprived:Subject369   -7.895      5.570   -1.42  0.15927</span></span>
<span><span class="co">#&gt; days_deprived:Subject370   -1.049      5.570   -0.19  0.85091</span></span>
<span><span class="co">#&gt; days_deprived:Subject371   -9.344      5.570   -1.68  0.09633</span></span>
<span><span class="co">#&gt; days_deprived:Subject372  -10.604      5.570   -1.90  0.05961</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 25.5 on 108 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.849,  Adjusted R-squared:   0.8 </span></span>
<span><span class="co">#&gt; F-statistic: 17.4 on 35 and 108 DF,  p-value: &lt;2e-16</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per chiarire, il soggetto di riferimento è il 308; in R, la modalità predefinita è quella di ordinare i livelli del fattore in ordine alfabetico e di scegliere il primo come soggetto di riferimento. Questo significa che l’intercetta e la pendenza per il soggetto 308 sono rappresentate rispettivamente da <code>(Intercept)</code> e <code>days_deprived</code>, poiché tutte le altre 17 variabili dummy saranno nulle per il soggetto 308.</p>
<p>Tutti i coefficienti di regressione degli altri soggetti sono rappresentati come scostamenti da questo soggetto di riferimento. Se desideriamo calcolare l’intercetta e la pendenza per un dato soggetto, dobbiamo semplicemente sommare gli scostamenti corrispondenti. Pertanto, abbiamo:</p>
<p>Intercetta per 308: 288.217<br>
Pendenza per 308: 21.69</p>
<p>Intercetta per 335: <code>(Intercept) + Subject335</code> = 288.217 + -25.343 = 262.874<br>
Pendenza per 335: <code>days_deprived + days_deprived:Subject335</code> = 21.69 + -25.899 = -4.209</p>
<p>E così via.</p>
<p>Nel modello “no pooling”, non viene stimata un’intercetta e una pendenza complessive per l’intera popolazione; in questo caso, <code>(Intercept)</code> e <code>days_deprived</code> sono stime dell’intercetta e della pendenza per il soggetto 308, che è stato scelto (arbitrariamente) come soggetto di riferimento. Per ottenere stime per l’intera popolazione, è possibile procedere con una seconda fase dell’analisi statistica in cui calcoliamo le medie delle intercette e delle pendenze individuali.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          coef(np_model)</span></span>
<span><span class="co">#&gt; (Intercept)                     288.217</span></span>
<span><span class="co">#&gt; days_deprived                    21.690</span></span>
<span><span class="co">#&gt; Subject309                      -87.926</span></span>
<span><span class="co">#&gt; Subject310                      -62.286</span></span>
<span><span class="co">#&gt; Subject330                      -14.953</span></span>
<span><span class="co">#&gt; Subject331                        9.966</span></span>
<span><span class="co">#&gt; Subject332                       27.816</span></span>
<span><span class="co">#&gt; Subject333                       -2.758</span></span>
<span><span class="co">#&gt; Subject334                      -50.205</span></span>
<span><span class="co">#&gt; Subject335                      -25.343</span></span>
<span><span class="co">#&gt; Subject337                       24.614</span></span>
<span><span class="co">#&gt; Subject349                      -59.218</span></span>
<span><span class="co">#&gt; Subject350                      -40.202</span></span>
<span><span class="co">#&gt; Subject351                      -24.247</span></span>
<span><span class="co">#&gt; Subject352                       43.065</span></span>
<span><span class="co">#&gt; Subject369                      -21.504</span></span>
<span><span class="co">#&gt; Subject370                      -53.307</span></span>
<span><span class="co">#&gt; Subject371                      -30.490</span></span>
<span><span class="co">#&gt; Subject372                        2.477</span></span>
<span><span class="co">#&gt; days_deprived:Subject309        -17.333</span></span>
<span><span class="co">#&gt; days_deprived:Subject310        -17.792</span></span>
<span><span class="co">#&gt; days_deprived:Subject330        -13.685</span></span>
<span><span class="co">#&gt; days_deprived:Subject331        -16.823</span></span>
<span><span class="co">#&gt; days_deprived:Subject332        -19.295</span></span>
<span><span class="co">#&gt; days_deprived:Subject333        -10.815</span></span>
<span><span class="co">#&gt; days_deprived:Subject334         -3.575</span></span>
<span><span class="co">#&gt; days_deprived:Subject335        -25.899</span></span>
<span><span class="co">#&gt; days_deprived:Subject337          0.752</span></span>
<span><span class="co">#&gt; days_deprived:Subject349         -5.264</span></span>
<span><span class="co">#&gt; days_deprived:Subject350          1.601</span></span>
<span><span class="co">#&gt; days_deprived:Subject351        -13.168</span></span>
<span><span class="co">#&gt; days_deprived:Subject352        -14.402</span></span>
<span><span class="co">#&gt; days_deprived:Subject369         -7.895</span></span>
<span><span class="co">#&gt; days_deprived:Subject370         -1.049</span></span>
<span><span class="co">#&gt; days_deprived:Subject371         -9.344</span></span>
<span><span class="co">#&gt; days_deprived:Subject372        -10.604</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcoliamo le intercette individuali:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_intercepts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">19</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcliamo le pendenze individuali:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_slopes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span><span class="op">[</span><span class="st">"days_deprived"</span><span class="op">]</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span><span class="op">[</span><span class="fl">20</span><span class="op">:</span><span class="fl">36</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">np_model</span><span class="op">)</span><span class="op">[</span><span class="st">"days_deprived"</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creiamo un DataFrame con le colonne Subject, intercept e slope:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">sleep2</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pull</span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 308 309 310 330 331 332 333 334 335 337 349 350 351 352 369 370 371 372</span></span>
<span><span class="co">#&gt; 18 Levels: 308 309 310 330 331 332 333 334 335 337 349 350 351 352 ... 372</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># make a tibble with the data extracted above</span></span>
<span><span class="va">np_coef</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>    Subject <span class="op">=</span> <span class="va">ids</span>,</span>
<span>    intercept <span class="op">=</span> <span class="va">all_intercepts</span>,</span>
<span>    slope <span class="op">=</span> <span class="va">all_slopes</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">np_coef</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 18 × 3</span></span>
<span><span class="co">#&gt;   Subject intercept slope</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 308          288. 21.7 </span></span>
<span><span class="co">#&gt; 2 309          200.  4.36</span></span>
<span><span class="co">#&gt; 3 310          226.  3.90</span></span>
<span><span class="co">#&gt; 4 330          273.  8.01</span></span>
<span><span class="co">#&gt; 5 331          298.  4.87</span></span>
<span><span class="co">#&gt; 6 332          316.  2.40</span></span>
<span><span class="co">#&gt; # ℹ 12 more rows</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esaminiamo l’adattamento di questo modello ai dati.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sleep2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">days_deprived</span>, y <span class="op">=</span> <span class="va">Reaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">np_coef</span>,</span>
<span>        mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>            intercept <span class="op">=</span> <span class="va">intercept</span>,</span>
<span>            slope <span class="op">=</span> <span class="va">slope</span></span>
<span>        <span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Reaction Time"</span>, x <span class="op">=</span> <span class="st">"Days deprived of sleep (0 = baseline)"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_multilevel_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questa situazione è notevolmente migliorata rispetto al modello di pooling completo. Se desideriamo testare l’ipotesi nulla secondo cui la pendenza della retta di regressione è uguale a zero, possiamo farlo eseguendo un test <span class="math inline">\(t\)</span> di Student sul campione di pendenze individuali.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">np_coef</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pull</span><span class="op">(</span><span class="va">slope</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  One Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  pull(np_coef, slope)</span></span>
<span><span class="co">#&gt; t = 6, df = 17, p-value = 1e-05</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;   7.54 15.33</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x </span></span>
<span><span class="co">#&gt;      11.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo test suggerisce che la pendenza media di 11.435 è diversa da zero, t(17) = 6.20 p &lt; .001.</p>
</section></section><section id="partial-pooling" class="level2" data-number="14.7"><h2 data-number="14.7" class="anchored" data-anchor-id="partial-pooling">
<span class="header-section-number">14.7</span> Partial Pooling</h2>
<p>Nell’analisi dei dati psicologici, la scelta del metodo di pooling rappresenta una decisione cruciale per bilanciare la variabilità individuale con la necessità di sfruttare le informazioni aggregate. Da un lato, l’approccio di <em>complete pooling</em> tratta tutti i dati come se appartenessero a un unico gruppo omogeneo, ignorando completamente le differenze tra individui. Dall’altro lato, l’approccio di <em>no pooling</em> analizza i dati di ciascun partecipante separatamente, senza beneficiare delle informazioni condivise tra i soggetti. Entrambi questi estremi presentano limiti significativi: il <em>complete pooling</em> può occultare variazioni individuali rilevanti, mentre il <em>no pooling</em> rischia di produrre stime instabili e meno robuste, soprattutto in presenza di pochi dati per soggetto.</p>
<section id="il-vantaggio-del-partial-pooling" class="level3" data-number="14.7.1"><h3 data-number="14.7.1" class="anchored" data-anchor-id="il-vantaggio-del-partial-pooling">
<span class="header-section-number">14.7.1</span> Il Vantaggio del Partial Pooling</h3>
<p>Il <em>partial pooling</em>, implementato tramite modelli lineari a effetti misti, rappresenta un approccio intermedio che supera queste limitazioni. Questo metodo sfrutta le informazioni condivise tra i partecipanti per migliorare le stime a livello individuale, mantenendo al contempo la capacità di catturare variazioni specifiche. In pratica, il modello:</p>
<ul>
<li>
<strong>Condivide informazioni tra soggetti</strong>: Le stime individuali sono influenzate dalle tendenze generali osservate nel gruppo, evitando così di basarsi esclusivamente sui dati limitati di ciascun partecipante.</li>
<li>
<strong>Permette variazioni individuali</strong>: Ogni soggetto può avere una propria intercetta e pendenza che si discostano dalla media di gruppo, riflettendo le differenze individuali.</li>
</ul>
<p>Questo equilibrio consente di ottenere stime che sono sia robuste sia rappresentative, riducendo il rischio di sovradattamento (<em>overfitting</em>) e migliorando la generalizzabilità dei risultati.</p>
</section><section id="implementazione-dei-modelli-a-effetti-misti" class="level3" data-number="14.7.2"><h3 data-number="14.7.2" class="anchored" data-anchor-id="implementazione-dei-modelli-a-effetti-misti">
<span class="header-section-number">14.7.2</span> Implementazione dei Modelli a Effetti Misti</h3>
<ul>
<li>
<strong>Trattare i Soggetti come Fattori Casuali</strong>: Nel <em>partial pooling</em>, i soggetti vengono considerati come un fattore casuale anziché fisso. Ciò implica che i livelli del fattore (i soggetti nel nostro caso) sono visti come un campione casuale da una popolazione più ampia.</li>
<li>
<strong>Modello Lineare a Effetti Misti</strong>: Questo tipo di modello statistico consente di includere i fattori casuali nell’analisi. In un modello misto, le stime per ogni soggetto sono “informate” o influenzate dalle informazioni aggregate degli altri soggetti.</li>
<li>
<strong>Shrinkage</strong>: Il fenomeno dello <em>shrinkage</em> (restringimento) indica che le stime per ciascun soggetto vengono regolate o “spostate” verso le stime medie della popolazione, permettendo una valutazione più equilibrata e meno influenzata da variazioni estreme o casuali.</li>
</ul></section><section id="articolazione-e-applicazione-del-modello-multilivello" class="level3" data-number="14.7.3"><h3 data-number="14.7.3" class="anchored" data-anchor-id="articolazione-e-applicazione-del-modello-multilivello">
<span class="header-section-number">14.7.3</span> Articolazione e Applicazione del Modello Multilivello</h3>
<p>Il modello multilivello descritto cattura le relazioni tra variabili misurate a più livelli, integrando dinamicamente la variabilità individuale e di gruppo. La struttura a due livelli consente di modellare sia le differenze tra soggetti che le relazioni all’interno di ciascun soggetto.</p>
</section><section id="livello-1-relazione-individuale" class="level3" data-number="14.7.4"><h3 data-number="14.7.4" class="anchored" data-anchor-id="livello-1-relazione-individuale">
<span class="header-section-number">14.7.4</span> Livello 1: Relazione Individuale</h3>
<p>Al livello individuale, il modello esprime una relazione lineare tra la variabile di risposta <span class="math inline">\(Y_{sd}\)</span> (tempo di reazione) e il predittore <span class="math inline">\(X_{sd}\)</span> (giorni di privazione del sonno):</p>
<p><span class="math display">\[
Y_{sd} = \beta_{0s} + \beta_{1s} X_{sd} + e_{sd},
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(Y_{sd}\)</span>: Tempo di reazione del soggetto <span class="math inline">\(s\)</span> al giorno <span class="math inline">\(d\)</span>,</li>
<li>
<span class="math inline">\(\beta_{0s}\)</span>: Intercetta specifica del soggetto <span class="math inline">\(s\)</span>,</li>
<li>
<span class="math inline">\(\beta_{1s}\)</span>: Pendenza specifica del soggetto <span class="math inline">\(s\)</span>,</li>
<li>
<span class="math inline">\(e_{sd} \sim N(0, \sigma^2)\)</span>: Errore residuo per il soggetto <span class="math inline">\(s\)</span> al giorno <span class="math inline">\(d\)</span>, distribuito normalmente con varianza <span class="math inline">\(\sigma^2\)</span>.</li>
</ul>
<p>Le intercette (<span class="math inline">\(\beta_{0s}\)</span>) e le pendenze (<span class="math inline">\(\beta_{1s}\)</span>) variano tra i soggetti e sono determinate al Livello 2.</p>
</section><section id="livello-2-variabilità-tra-soggetti" class="level3" data-number="14.7.5"><h3 data-number="14.7.5" class="anchored" data-anchor-id="livello-2-variabilità-tra-soggetti">
<span class="header-section-number">14.7.5</span> Livello 2: Variabilità Tra Soggetti</h3>
<p>Al livello superiore, il modello specifica come le intercette e le pendenze variano tra i soggetti:</p>
<p><span class="math display">\[
\beta_{0s} = \gamma_{0} + S_{0s},
\]</span> <span class="math display">\[
\beta_{1s} = \gamma_{1} + S_{1s},
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\gamma_0\)</span>: Intercetta media della popolazione,</li>
<li>
<span class="math inline">\(\gamma_1\)</span>: Pendenza media della popolazione,</li>
<li>
<span class="math inline">\(S_{0s} \sim N(0, \tau_{00}^2)\)</span>: Effetto casuale sull’intercetta per il soggetto <span class="math inline">\(s\)</span>,</li>
<li>
<span class="math inline">\(S_{1s} \sim N(0, \tau_{11}^2)\)</span>: Effetto casuale sulla pendenza per il soggetto <span class="math inline">\(s\)</span>,</li>
<li>
<span class="math inline">\(\langle S_{0s}, S_{1s} \rangle\)</span>: Effetti casuali correlati con covarianza <span class="math inline">\(\rho \tau_{00} \tau_{11}\)</span>.</li>
</ul>
<p>La matrice di varianza-covarianza degli effetti casuali è data da:</p>
<p><span class="math display">\[
\Sigma =
\begin{pmatrix}
\tau_{00}^2 &amp; \rho \tau_{00} \tau_{11} \\
\rho \tau_{00} \tau_{11} &amp; \tau_{11}^2
\end{pmatrix},
\]</span></p>
<p>dove <span class="math inline">\(\tau_{00}^2\)</span> e <span class="math inline">\(\tau_{11}^2\)</span> rappresentano rispettivamente la varianza delle intercette e delle pendenze, e <span class="math inline">\(\rho\)</span> descrive la correlazione tra questi effetti.</p>
</section><section id="modello-completo" class="level3" data-number="14.7.6"><h3 data-number="14.7.6" class="anchored" data-anchor-id="modello-completo">
<span class="header-section-number">14.7.6</span> Modello Completo</h3>
<p>Combinando i due livelli, il modello multilivello può essere espresso come:</p>
<p><span class="math display">\[
Y_{sd} = \gamma_0 + S_{0s} + (\gamma_1 + S_{1s}) X_{sd} + e_{sd},
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\gamma_0\)</span> e <span class="math inline">\(\gamma_1\)</span>: Effetti fissi (intercetta e pendenza medie della popolazione),</li>
<li>
<span class="math inline">\(S_{0s}\)</span> e <span class="math inline">\(S_{1s}\)</span>: Effetti casuali che catturano variazioni individuali,</li>
<li>
<span class="math inline">\(e_{sd}\)</span>: Errore residuo specifico per ciascuna osservazione.</li>
</ul></section><section id="interpretazione-degli-effetti-fissi-e-casuali" class="level3" data-number="14.7.7"><h3 data-number="14.7.7" class="anchored" data-anchor-id="interpretazione-degli-effetti-fissi-e-casuali">
<span class="header-section-number">14.7.7</span> Interpretazione degli Effetti Fissi e Casuali</h3>
<ul>
<li>
<strong>Effetti Fissi (<span class="math inline">\(\gamma_0\)</span>, <span class="math inline">\(\gamma_1\)</span>)</strong>: Rappresentano la tendenza generale della popolazione, fornendo stime medie valide per tutti i soggetti.</li>
<li>
<strong>Effetti Casuali (<span class="math inline">\(S_{0s}\)</span>, <span class="math inline">\(S_{1s}\)</span>)</strong>: Catturano la variabilità tra i soggetti, modellando le deviazioni rispetto agli effetti fissi.</li>
</ul></section><section id="importanza-della-matrice-di-varianza-covarianza" class="level3" data-number="14.7.8"><h3 data-number="14.7.8" class="anchored" data-anchor-id="importanza-della-matrice-di-varianza-covarianza">
<span class="header-section-number">14.7.8</span> Importanza della Matrice di Varianza-Covarianza</h3>
<p>La matrice di varianza-covarianza consente di:</p>
<ol type="1">
<li>
<strong>Quantificare la variabilità tra i soggetti</strong>: Le varianze <span class="math inline">\(\tau_{00}^2\)</span> e <span class="math inline">\(\tau_{11}^2\)</span> indicano l’eterogeneità delle intercette e delle pendenze rispettivamente.</li>
<li>
<strong>Esaminare le relazioni tra intercette e pendenze</strong>: La covarianza <span class="math inline">\(\rho \tau_{00} \tau_{11}\)</span> fornisce informazioni sulle correlazioni tra i due parametri. Ad esempio, una correlazione positiva potrebbe indicare che soggetti con tempi di reazione iniziali più elevati (intercetta maggiore) tendono a mostrare aumenti più rapidi del tempo di reazione con la privazione del sonno.</li>
</ol></section><section id="vantaggi-del-modello-multilivello" class="level3" data-number="14.7.9"><h3 data-number="14.7.9" class="anchored" data-anchor-id="vantaggi-del-modello-multilivello">
<span class="header-section-number">14.7.9</span> Vantaggi del Modello Multilivello</h3>
<ol type="1">
<li>
<strong>Bilancia complete pooling e no pooling</strong>: Integra tendenze generali con variazioni specifiche.</li>
<li>
<strong>Stime robuste</strong>: Migliora l’accuratezza delle stime per i soggetti individuali sfruttando le informazioni condivise tra tutti i soggetti.</li>
<li>
<strong>Generalizzabilità</strong>: Fornisce una base solida per inferenze valide sull’intera popolazione.</li>
</ol>
<p>In conclusione, il modello multilivello offre un approccio flessibile e potente per analizzare dati gerarchici, come quelli longitudinali o nidificati. Permette di distinguere tra effetti generali e variazioni individuali, fornendo una rappresentazione dettagliata dei fenomeni psicologici e una base solida per interpretazioni e inferenze.</p>
</section></section><section id="stima-dei-parametri-del-modello" class="level2" data-number="14.8"><h2 data-number="14.8" class="anchored" data-anchor-id="stima-dei-parametri-del-modello">
<span class="header-section-number">14.8</span> Stima dei Parametri del Modello</h2>
<p>Per stimare i parametri del modello in R, utilizzeremo la funzione <code>lmer()</code> del pacchetto <strong>lme4</strong> <span class="citation" data-cites="bates2014fitting">(<a href="../../99-references.html#ref-bates2014fitting" role="doc-biblioref">Bates et al., 2014</a>)</span>. Questa funzione consente di specificare sia gli effetti fissi (ad esempio, giorni di deprivazione del sonno) sia gli effetti casuali (ad esempio, variazioni tra soggetti), costruendo un modello che bilancia informazioni aggregate e individuali.</p>
<section id="sintassi-generale-di-lmer" class="level3" data-number="14.8.1"><h3 data-number="14.8.1" class="anchored" data-anchor-id="sintassi-generale-di-lmer">
<span class="header-section-number">14.8.1</span> Sintassi Generale di <code>lmer()</code>
</h3>
<p>La sintassi base di <code>lmer()</code> è:</p>
<p><span class="math display">\[
\text{lmer(formula, data, ...)},
\]</span></p>
<p>dove:</p>
<ul>
<li>
<strong><code>formula</code></strong> definisce la struttura del modello, specificando la relazione tra variabili dipendenti, effetti fissi e casuali.</li>
<li>
<strong><code>data</code></strong> indica il dataset contenente le variabili.</li>
</ul>
<p>La struttura generale della formula è:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DV</span> <span class="op">~</span> <span class="va">fix1</span> <span class="op">+</span> <span class="va">fix2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">fixN</span> <span class="op">+</span> <span class="op">(</span><span class="va">ran1</span> <span class="op">+</span> <span class="va">ran2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">ranK</span> <span class="op">|</span> <span class="va">random_factor</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>dove:</p>
<ul>
<li>
<strong><code>DV</code></strong>: variabile dipendente.</li>
<li>
<strong><code>fix1, fix2, ..., fixN</code></strong>: effetti fissi (fattori indipendenti a livello globale).</li>
<li>
<strong><code>ran1, ran2, ..., ranK</code></strong>: effetti casuali che variano tra i livelli del fattore casuale specificato da <code>random_factor</code>.</li>
</ul>
<p>Le <strong>interazioni</strong> tra i fattori possono essere definite utilizzando:</p>
<ul>
<li>
<code>A * B</code> (effetti principali + interazione),</li>
<li>
<code>A:B</code> (solo interazione).</li>
</ul></section><section id="effetti-casuali-nella-formula" class="level3" data-number="14.8.2"><h3 data-number="14.8.2" class="anchored" data-anchor-id="effetti-casuali-nella-formula">
<span class="header-section-number">14.8.2</span> Effetti Casuali nella Formula</h3>
<p>Gli effetti casuali sono specificati all’interno di parentesi, ad esempio:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">days_deprived</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Questa sintassi indica che sia l’intercetta (<span class="math inline">\(1\)</span>) sia il coefficiente associato a <code>days_deprived</code> variano tra i livelli del fattore casuale <code>Subject</code>. È anche possibile avere più termini di effetti casuali nella stessa formula, ad esempio, per fattori casuali incrociati.</p>
<p>Sul lato sinistro della barra <code>|</code> si elencano gli effetti che vogliamo far variare, mentre sul lato destro si specifica la variabile che identifica i livelli del fattore casuale (ad esempio, <code>Subject</code>).</p>
</section><section id="esempi-di-modelli-con-sleep2" class="level3" data-number="14.8.3"><h3 data-number="14.8.3" class="anchored" data-anchor-id="esempi-di-modelli-con-sleep2">
<span class="header-section-number">14.8.3</span> Esempi di Modelli con <code>sleep2</code>
</h3>
<p>Consideriamo diverse specifiche di modello per i dati <code>sleep2</code>, con le rispettive formule e strutture della matrice di varianza-covarianza (<span class="math inline">\(\mathbf{\Sigma}\)</span>).</p>
<section id="solo-intercette-casuali" class="level4" data-number="14.8.3.1"><h4 data-number="14.8.3.1" class="anchored" data-anchor-id="solo-intercette-casuali">
<span class="header-section-number">14.8.3.1</span> Solo Intercette Casuali</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">days_deprived</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In questo modello, solo l’intercetta varia tra i soggetti (<span class="math inline">\(\tau_{00}^2\)</span>):</p>
<p><span class="math display">\[
\mathbf{\Sigma} =
\begin{pmatrix}
\tau_{00}^2 &amp; 0 \\
0 &amp; 0
\end{pmatrix}
\]</span></p>
</section><section id="intercette-e-pendenze-casuali" class="level4" data-number="14.8.3.2"><h4 data-number="14.8.3.2" class="anchored" data-anchor-id="intercette-e-pendenze-casuali">
<span class="header-section-number">14.8.3.2</span> Intercette e Pendenze Casuali</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">days_deprived</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">days_deprived</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In questo modello, sia l’intercetta (<span class="math inline">\(\tau_{00}^2\)</span>) sia la pendenza (<span class="math inline">\(\tau_{11}^2\)</span>) variano tra i soggetti, con una correlazione (<span class="math inline">\(\rho\)</span>) tra i due:</p>
<p><span class="math display">\[
\mathbf{\Sigma} =
\begin{pmatrix}
\tau_{00}^2 &amp; \rho \tau_{00} \tau_{11} \\
\rho \tau_{00} \tau_{11} &amp; \tau_{11}^2
\end{pmatrix}
\]</span></p>
</section><section id="pendenze-casuali-senza-correlazione" class="level4" data-number="14.8.3.3"><h4 data-number="14.8.3.3" class="anchored" data-anchor-id="pendenze-casuali-senza-correlazione">
<span class="header-section-number">14.8.3.3</span> Pendenze Casuali Senza Correlazione</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">days_deprived</span> <span class="op">+</span> <span class="op">(</span><span class="va">days_deprived</span> <span class="op">||</span> <span class="va">Subject</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Questa sintassi alternativa esclude la covarianza tra intercette e pendenze, risultando in una matrice diagonale:</p>
<p><span class="math display">\[
\mathbf{\Sigma} =
\begin{pmatrix}
\tau_{00}^2 &amp; 0 \\
0 &amp; \tau_{11}^2
\end{pmatrix}
\]</span></p>
</section><section id="solo-pendenze-casuali" class="level4" data-number="14.8.3.4"><h4 data-number="14.8.3.4" class="anchored" data-anchor-id="solo-pendenze-casuali">
<span class="header-section-number">14.8.3.4</span> Solo Pendenze Casuali</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">days_deprived</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">days_deprived</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In questo caso, solo le pendenze variano tra i soggetti (<span class="math inline">\(\tau_{11}^2\)</span>):</p>
<p><span class="math display">\[
\mathbf{\Sigma} =
\begin{pmatrix}
0 &amp; 0 \\
0 &amp; \tau_{11}^2
\end{pmatrix}
\]</span></p>
<p><strong>Tabella Riassuntiva dei Modelli</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 32%">
<col style="width: 51%">
</colgroup>
<thead><tr class="header">
<th><strong>Modello</strong></th>
<th><strong>Formula</strong></th>
<th><strong>Struttura di <span class="math inline">\(\mathbf{\Sigma}\)</span></strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>1. Solo intercette</strong></td>
<td><code>Reaction ~ days_deprived + (1 | Subject)</code></td>
<td><span class="math inline">\(\begin{pmatrix} \tau_{00}^2 &amp; 0 \\ 0 &amp; 0 \end{pmatrix}\)</span></td>
</tr>
<tr class="even">
<td><strong>2. Intercette e pendenze</strong></td>
<td><code>Reaction ~ days_deprived + (1 + days_deprived | Subject)</code></td>
<td><span class="math inline">\(\begin{pmatrix} \tau_{00}^2 &amp; \rho \tau_{00} \tau_{11} \\ \rho \tau_{00} \tau_{11} &amp; \tau_{11}^2 \end{pmatrix}\)</span></td>
</tr>
<tr class="odd">
<td><strong>3. No covarianza</strong></td>
<td><code>Reaction ~ days_deprived + (days_deprived || Subject)</code></td>
<td><span class="math inline">\(\begin{pmatrix} \tau_{00}^2 &amp; 0 \\ 0 &amp; \tau_{11}^2 \end{pmatrix}\)</span></td>
</tr>
<tr class="even">
<td><strong>4. Solo pendenze</strong></td>
<td><code>Reaction ~ days_deprived + (0 + days_deprived | Subject)</code></td>
<td><span class="math inline">\(\begin{pmatrix} 0 &amp; 0 \\ 0 &amp; \tau_{11}^2 \end{pmatrix}\)</span></td>
</tr>
</tbody>
</table></section></section><section id="scelta-del-modello" class="level3" data-number="14.8.4"><h3 data-number="14.8.4" class="anchored" data-anchor-id="scelta-del-modello">
<span class="header-section-number">14.8.4</span> Scelta del Modello</h3>
<p>La scelta del modello dipende dalla complessità dei dati e dalle ipotesi sull’eterogeneità tra i soggetti:</p>
<ul>
<li>
<strong>Modello 1</strong>: È il più semplice, adatto quando si ritiene che le differenze tra soggetti influenzino solo l’intercetta.</li>
<li>
<strong>Modello 2</strong>: Modello più flessibile, consente variazioni sia nelle intercette che nelle pendenze.</li>
<li>
<strong>Modello 3</strong>: Variante di Modello 2, esclude la correlazione tra intercette e pendenze, utile per semplificare il modello.</li>
<li>
<strong>Modello 4</strong>: Adatto quando si ritiene che la variabilità tra soggetti influenzi solo le pendenze.</li>
</ul>
<p>In conclusione, la funzione <code>lmer()</code> offre una potente flessibilità per modellare dati multilivello, adattandosi a diverse ipotesi e configurazioni. La comprensione delle strutture della matrice di varianza-covarianza è fondamentale per interpretare correttamente i risultati e scegliere il modello più appropriato per il contesto analitico.</p>
</section><section id="applicazione" class="level3" data-number="14.8.5"><h3 data-number="14.8.5" class="anchored" data-anchor-id="applicazione">
<span class="header-section-number">14.8.5</span> Applicazione</h3>
<p>Per i dati dell’esempio, il modello più appropriato è il <strong>Modello 2</strong>, che include intercette e pendenze casuali per ciascun soggetto. Procediamo quindi a stimarlo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pp_mod</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span></span>
<span>    <span class="va">Reaction</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">days_deprived</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">days_deprived</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>, </span>
<span>    data <span class="op">=</span> <span class="va">sleep2</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per verificare la stima del modello, utilizziamo la funzione <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: Reaction ~ 1 + days_deprived + (1 + days_deprived | Subject)</span></span>
<span><span class="co">#&gt;    Data: sleep2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML criterion at convergence: 1404</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -4.016 -0.354  0.007  0.468  5.073 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name          Variance Std.Dev. Corr</span></span>
<span><span class="co">#&gt;  Subject  (Intercept)   958.4    30.96        </span></span>
<span><span class="co">#&gt;           days_deprived  45.8     6.77    0.18</span></span>
<span><span class="co">#&gt;  Residual               651.6    25.53        </span></span>
<span><span class="co">#&gt; Number of obs: 144, groups:  Subject, 18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)     267.97       8.27    32.4</span></span>
<span><span class="co">#&gt; days_deprived    11.44       1.85     6.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr)</span></span>
<span><span class="co">#&gt; days_deprvd -0.062</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="predizioni-del-modello" class="level3" data-number="14.8.6"><h3 data-number="14.8.6" class="anchored" data-anchor-id="predizioni-del-modello">
<span class="header-section-number">14.8.6</span> Predizioni del Modello</h3>
<p>Prima di interpretare i risultati, rappresentiamo graficamente i dati osservati e le previsioni del modello. La funzione <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> permette di calcolare le stime previste per ciascun livello del predittore, considerando gli effetti casuali e fissi. Di seguito, i passaggi per creare un dataset per le predizioni.</p>
<section id="creazione-di-un-nuovo-dataset" class="level4" data-number="14.8.6.1"><h4 data-number="14.8.6.1" class="anchored" data-anchor-id="creazione-di-un-nuovo-dataset">
<span class="header-section-number">14.8.6.1</span> Creazione di un Nuovo Dataset</h4>
<p>Per ottenere le previsioni, creiamo un nuovo dataset (<code>newdata</code>) con tutte le combinazioni dei livelli di <code>Subject</code> e <code>days_deprived</code>. Utilizziamo la funzione <code>crossing()</code> del pacchetto <strong>dplyr</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu">crossing</span><span class="op">(</span></span>
<span>    Subject <span class="op">=</span> <span class="va">sleep2</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">pull</span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    days_deprived <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">7</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ecco un’anteprima del dataset generato:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">newdata</span>, <span class="fl">17</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 17 × 2</span></span>
<span><span class="co">#&gt;   Subject days_deprived</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;           &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 308                 0</span></span>
<span><span class="co">#&gt; 2 308                 1</span></span>
<span><span class="co">#&gt; 3 308                 2</span></span>
<span><span class="co">#&gt; 4 308                 3</span></span>
<span><span class="co">#&gt; 5 308                 4</span></span>
<span><span class="co">#&gt; 6 308                 5</span></span>
<span><span class="co">#&gt; # ℹ 11 more rows</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="dettagli-del-codice" class="level4" data-number="14.8.6.2"><h4 data-number="14.8.6.2" class="anchored" data-anchor-id="dettagli-del-codice">
<span class="header-section-number">14.8.6.2</span> Dettagli del Codice</h4>
<ul>
<li>
<p><code>Subject = sleep2 |&gt; pull(Subject) |&gt; levels() |&gt; factor()</code>:</p>
<ol type="1">
<li>
<code>pull(Subject)</code>: Estrae la colonna <code>Subject</code> dal dataset <code>sleep2</code>.</li>
<li>
<code><a href="https://rdrr.io/r/base/levels.html">levels()</a></code>: Recupera i livelli unici della variabile categorica <code>Subject</code>.</li>
<li>
<code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>: Converte i livelli in un fattore, garantendo la compatibilità con la funzione <code>crossing()</code>.</li>
</ol>
</li>
<li><p><code>days_deprived = 0:7</code>: Genera una sequenza di valori da 0 a 7, rappresentando i giorni di privazione del sonno.</p></li>
<li><p><code>crossing()</code>: Combina tutte le possibili coppie di livelli di <code>Subject</code> e valori di <code>days_deprived</code>, creando un dataset completo per calcolare le predizioni.</p></li>
</ul></section><section id="calcolo-delle-predizioni" class="level4" data-number="14.8.6.3"><h4 data-number="14.8.6.3" class="anchored" data-anchor-id="calcolo-delle-predizioni">
<span class="header-section-number">14.8.6.3</span> Calcolo delle Predizioni</h4>
<p>Utilizziamo la funzione <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> per stimare i valori di <code>Reaction</code> per ciascuna combinazione di soggetto e giorno:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newdata2</span> <span class="op">&lt;-</span> <span class="va">newdata</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>Reaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">pp_mod</span>, <span class="va">newdata</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizziamo i primi valori del nuovo dataset:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">newdata2</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   Subject days_deprived Reaction</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;           &lt;int&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 308                 0     292.</span></span>
<span><span class="co">#&gt; 2 308                 1     313.</span></span>
<span><span class="co">#&gt; 3 308                 2     333.</span></span>
<span><span class="co">#&gt; 4 308                 3     353.</span></span>
<span><span class="co">#&gt; 5 308                 4     373.</span></span>
<span><span class="co">#&gt; 6 308                 5     393.</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="visualizzazione-grafica" class="level3" data-number="14.8.7"><h3 data-number="14.8.7" class="anchored" data-anchor-id="visualizzazione-grafica">
<span class="header-section-number">14.8.7</span> Visualizzazione Grafica</h3>
<p>Per rappresentare graficamente le rette di regressione previste dal modello per ciascun soggetto, utilizziamo <strong>ggplot2</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sleep2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">days_deprived</span>, y <span class="op">=</span> <span class="va">Reaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">newdata2</span>,</span>
<span>        <span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">Subject</span><span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="st">"Reaction Time (ms)"</span>, </span>
<span>        x <span class="op">=</span> <span class="st">"Days Deprived of Sleep (0 = baseline)"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Reaction Time by Days of Sleep Deprivation"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_multilevel_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>
<p><code>geom_line()</code>: Disegna le rette di regressione previste per ciascun soggetto utilizzando i dati di <code>newdata2</code>.</p>
<ul>
<li>
<code>aes(group = Subject)</code>: Specifica che ogni linea è associata a un soggetto distinto.</li>
<li>
<code>color = "blue"</code>: Imposta il colore delle linee.</li>
</ul>
</li>
<li><p><code>geom_point()</code>: Aggiunge i punti corrispondenti ai dati osservati.</p></li>
<li><p><code>facet_wrap(~Subject)</code>: Crea un pannello separato per ciascun soggetto, facilitando il confronto tra dati osservati e predizioni.</p></li>
<li><p><code>labs()</code>: Personalizza le etichette degli assi e il titolo del grafico.</p></li>
</ol>
<p>Il grafico risultante mostra le predizioni del modello (linee blu) sovrapposte ai dati osservati (punti) per ciascun soggetto. Questo consente di valutare visivamente l’adeguatezza del modello nel catturare sia le tendenze generali sia le variazioni individuali.</p>
</section></section><section id="interpretare-loutput-di-lmer-ed-estrarre-le-stime" class="level2" data-number="14.9"><h2 data-number="14.9" class="anchored" data-anchor-id="interpretare-loutput-di-lmer-ed-estrarre-le-stime">
<span class="header-section-number">14.9</span> Interpretare l’output di <code>lmer()</code> ed estrarre le stime</h2>
<p>La chiamata a <code>lmer()</code> restituisce un oggetto della classe “lmerMod”.</p>
<section id="effetti-fissi" class="level3" data-number="14.9.1"><h3 data-number="14.9.1" class="anchored" data-anchor-id="effetti-fissi">
<span class="header-section-number">14.9.1</span> Effetti fissi</h3>
<p>La sezione dell’output chiamata “Effetti fissi:” è simile a ciò che si vede nell’output per un modello lineare semplice adattato con <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<pre><code>Fixed effects:
              Estimate Std. Error t value
(Intercept)    267.967      8.266  32.418
days_deprived   11.435      1.845   6.197</code></pre>
<p>L’output precedente indica che il tempo di reazione medio stimato per i partecipanti al Giorno 0 era di circa 268 millisecondi, con ogni giorno di privazione del sonno che aggiungeva mediamente ulteriori 11 millisecondi al tempo di risposta.</p>
<p>Se dobbiamo ottenere gli effetti fissi dal modello, possiamo estrarli utilizzando la funzione <code>fixef()</code>.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fixef</span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept) days_deprived </span></span>
<span><span class="co">#&gt;         268.0          11.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gli errori standard ci forniscono stime della variabilità di questi parametri dovuta all’errore di campionamento. Possiamo utilizzarli per calcolare i valori <span class="math inline">\(t\)</span> o derivare gli intervalli di confidenza. Per estrarli, utilizziamo <code>vcov(pp_mod)</code>, che restituirà una matrice di varianza-covarianza (non quella associata agli effetti casuali), quindi estraiamo la diagonale utilizzando <code><a href="https://rdrr.io/r/base/diag.html">diag()</a></code> e calcoliamo infine la radice quadrata utilizzando <code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code>.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2 x 2 Matrix of class "dpoMatrix"</span></span>
<span><span class="co">#&gt;               (Intercept) days_deprived</span></span>
<span><span class="co">#&gt; (Intercept)         68.33         -0.95</span></span>
<span><span class="co">#&gt; days_deprived       -0.95          3.41</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept) days_deprived </span></span>
<span><span class="co">#&gt;          8.27          1.85</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si noti che, nell’output di <code>lmer</code>, i valori <span class="math inline">\(t\)</span> non sono accompagnati dai valori <span class="math inline">\(p\)</span>, come avviene di solito nei contesti di modellazione più semplici. Esistono molteplici approcci per ottenere i valori <span class="math inline">\(p\)</span> da modelli a effetti misti, ciascuno con vantaggi e svantaggi (si veda, ad esempio, Luke (2017) per un’analisi delle opzioni disponibili). I valori <span class="math inline">\(t\)</span> non vengono accompagnati dai gradi di libertà, poiché i gradi di libertà in un modello a effetti misti non sono ben definiti. Spesso i ricercatori trattano i valori <span class="math inline">\(t\)</span> come valori <span class="math inline">\(z\)</span> di Wald, ossia come osservazioni provenienti da una distribuzione normale standard. Poiché la distribuzione <span class="math inline">\(t\)</span> si avvicina alla distribuzione normale standard all’aumentare del numero di osservazioni, questa pratica “t-as-z” è legittima se il numero di osservazioni campionarie è sufficientemente grande.</p>
<p>Per calcolare i valori <span class="math inline">\(z\)</span> di Wald, basta dividere la stima dell’effetto fisso per il suo errore standard:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tvals</span> <span class="op">&lt;-</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tvals</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept) days_deprived </span></span>
<span><span class="co">#&gt;          32.4           6.2</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I valori-<span class="math inline">\(p\)</span> si ottengono nel modo seguente:</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">tvals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept) days_deprived </span></span>
<span><span class="co">#&gt;      0.00e+00      5.75e-10</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo fornisce una forte evidenza contro l’ipotesi nulla <span class="math inline">\(H_0: \gamma_1 = 0\)</span>. Sembra che la privazione del sonno aumenti effettivamente il tempo di risposta.</p>
<p>È possibile ottenere gli intervalli di confidenza per le stime utilizzando la funzione <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code> (questa tecnica utilizza il bootstrap parametrico).</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 2.5 %  97.5 %</span></span>
<span><span class="co">#&gt; .sig01         19.098  46.337</span></span>
<span><span class="co">#&gt; .sig02         -0.405   0.806</span></span>
<span><span class="co">#&gt; .sig03          4.008  10.249</span></span>
<span><span class="co">#&gt; .sigma         22.467  29.349</span></span>
<span><span class="co">#&gt; (Intercept)   251.344 284.590</span></span>
<span><span class="co">#&gt; days_deprived   7.725  15.146</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="effetti-random" class="level3" data-number="14.9.2"><h3 data-number="14.9.2" class="anchored" data-anchor-id="effetti-random">
<span class="header-section-number">14.9.2</span> Effetti random</h3>
<pre><code>Random effects:
 Groups   Name          Variance Std.Dev. Corr
 Subject  (Intercept)   958.35   30.957       
          days_deprived  45.78    6.766   0.18
 Residual               651.60   25.526       
Number of obs: 144, groups:  Subject, 18</code></pre>
<p>La parte relativa agli effetti casuali dell’output di <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> ci fornisce una tabella con informazioni sulle diverse componenti della varianza: la matrice di varianza-covarianza (o matrici, se ci sono più fattori casuali) e la varianza residua.</p>
<p>Cominciamo con la riga <code>Residual</code>. Questo ci indica che la varianza residua, <span class="math inline">\(\sigma^2\)</span>, è stata stimata a circa 651.6. Il valore nella colonna successiva, 25.526, è la deviazione standard, <span class="math inline">\(\sigma\)</span>, che è la radice quadrata della varianza.</p>
<p>Estraiamo la deviazione standard dei residui utilizzando la funzione <code><a href="https://rdrr.io/r/stats/sigma.html">sigma()</a></code>.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html">sigma</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span> <span class="co"># residual</span></span>
<span><span class="co">#&gt; [1] 25.5</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le due righe sopra la riga Residual ci forniscono informazioni sulla matrice di varianza-covarianza per il fattore casuale “Subject”.</p>
<pre><code>Random effects:
 Groups   Name          Variance Std.Dev. Corr
 Subject  (Intercept)   958.35   30.957       
          days_deprived  45.78    6.766   0.18</code></pre>
<p>I valori nella colonna “Variance” ci forniscono la diagonale principale della matrice, mentre i valori nella colonna “Std.Dev.” rappresentano semplicemente le radici quadrate di questi valori. La colonna “Corr” indica la correlazione tra l’intercetta e la pendenza.</p>
<p>Possiamo estrarre questi valori dall’oggetto adattato <code>pp_mod</code> utilizzando la funzione <code>VarCorr()</code>. Questa funzione restituisce una lista nominata, con un elemento per ciascun fattore casuale. Nel nostro caso, “Subject” è l’unico fattore casuale, quindi la lista avrà lunghezza 1.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># variance-covariance matrix for random factor Subject</span></span>
<span><span class="fu">VarCorr</span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span><span class="op">[[</span><span class="st">"Subject"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># oppure: VarCorr(pp_mod)[[1]]</span></span>
<span><span class="co">#&gt;               (Intercept) days_deprived</span></span>
<span><span class="co">#&gt; (Intercept)         958.4          37.2</span></span>
<span><span class="co">#&gt; days_deprived        37.2          45.8</span></span>
<span><span class="co">#&gt; attr(,"stddev")</span></span>
<span><span class="co">#&gt;   (Intercept) days_deprived </span></span>
<span><span class="co">#&gt;         30.96          6.77 </span></span>
<span><span class="co">#&gt; attr(,"correlation")</span></span>
<span><span class="co">#&gt;               (Intercept) days_deprived</span></span>
<span><span class="co">#&gt; (Intercept)         1.000         0.178</span></span>
<span><span class="co">#&gt; days_deprived       0.178         1.000</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le prime righe rappresentano la matrice di varianza-covarianza. Le varianze sono riportate sulla diagonale principale. <code>correlation</code> indica la correlazione tra la stima della pendenza e la stima dell’intercetta.</p>
<p>Possiamo estrarre gli effetti casuali stimati (BLUPS) utilizzando la funzione <code>ranef()</code>.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ranef</span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span><span class="op">[[</span><span class="st">"Subject"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     (Intercept) days_deprived</span></span>
<span><span class="co">#&gt; 308      24.499         8.602</span></span>
<span><span class="co">#&gt; 309     -59.372        -8.128</span></span>
<span><span class="co">#&gt; 310     -39.476        -7.429</span></span>
<span><span class="co">#&gt; 330       1.350        -2.385</span></span>
<span><span class="co">#&gt; 331      18.458        -3.748</span></span>
<span><span class="co">#&gt; 332      30.527        -4.894</span></span>
<span><span class="co">#&gt; 333      13.368         0.289</span></span>
<span><span class="co">#&gt; 334     -18.158         3.844</span></span>
<span><span class="co">#&gt; 335     -16.974       -12.070</span></span>
<span><span class="co">#&gt; 337      44.585        10.176</span></span>
<span><span class="co">#&gt; 349     -26.684         2.195</span></span>
<span><span class="co">#&gt; 350      -5.966         8.176</span></span>
<span><span class="co">#&gt; 351      -5.571        -2.372</span></span>
<span><span class="co">#&gt; 352      46.635        -0.562</span></span>
<span><span class="co">#&gt; 369       0.962         1.739</span></span>
<span><span class="co">#&gt; 370     -18.522         5.632</span></span>
<span><span class="co">#&gt; 371      -7.343         0.273</span></span>
<span><span class="co">#&gt; 372      17.683         0.662</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Possiamo ottenere i valori stimati dal modello utilizzando <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code> e i residui utilizzando <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code>.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mutate</span><span class="op">(</span><span class="va">sleep2</span>,</span>
<span>    fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span>,</span>
<span>    resid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">pp_mod</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">slice</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="op">+</span><span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 18 × 6</span></span>
<span><span class="co">#&gt; # Groups:   Subject [18]</span></span>
<span><span class="co">#&gt;    Reaction  Days Subject days_deprived   fit  resid</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;           &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     251.     2 308                 0  292. -41.7 </span></span>
<span><span class="co">#&gt;  2     203.     2 309                 0  209.  -5.62</span></span>
<span><span class="co">#&gt;  3     234.     2 310                 0  228.   5.83</span></span>
<span><span class="co">#&gt;  4     284.     2 330                 0  269.  14.5 </span></span>
<span><span class="co">#&gt;  5     302.     2 331                 0  286.  15.4 </span></span>
<span><span class="co">#&gt;  6     273.     2 332                 0  298. -25.5 </span></span>
<span><span class="co">#&gt;  7     277.     2 333                 0  281.  -4.57</span></span>
<span><span class="co">#&gt;  8     243.     2 334                 0  250.  -6.44</span></span>
<span><span class="co">#&gt;  9     254.     2 335                 0  251.   3.50</span></span>
<span><span class="co">#&gt; 10     292.     2 337                 0  313. -20.9 </span></span>
<span><span class="co">#&gt; 11     239.     2 349                 0  241.  -2.36</span></span>
<span><span class="co">#&gt; 12     256.     2 350                 0  262.  -5.80</span></span>
<span><span class="co">#&gt; 13     270.     2 351                 0  262.   7.50</span></span>
<span><span class="co">#&gt; 14     327.     2 352                 0  315.  12.3 </span></span>
<span><span class="co">#&gt; 15     257.     2 369                 0  269. -11.7 </span></span>
<span><span class="co">#&gt; 16     239.     2 370                 0  249. -10.5 </span></span>
<span><span class="co">#&gt; 17     278.     2 371                 0  261.  17.3 </span></span>
<span><span class="co">#&gt; 18     298.     2 372                 0  286.  11.9</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Infine, possiamo ottenere previsioni per nuovi dati utilizzando <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>, come abbiamo fatto in precedenza.</p>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## create the table with new predictor values</span></span>
<span><span class="va">ndat</span> <span class="op">&lt;-</span> <span class="fu">crossing</span><span class="op">(</span></span>
<span>    Subject <span class="op">=</span> <span class="va">sleep2</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    days_deprived <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>Reaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">pp_mod</span>, newdata <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ndat</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   Subject days_deprived Reaction</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;           &lt;int&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 308                 8     453.</span></span>
<span><span class="co">#&gt; 2 308                 9     473.</span></span>
<span><span class="co">#&gt; 3 308                10     493.</span></span>
<span><span class="co">#&gt; 4 309                 8     235.</span></span>
<span><span class="co">#&gt; 5 309                 9     238.</span></span>
<span><span class="co">#&gt; 6 309                10     242.</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sleep2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">days_deprived</span>, y <span class="op">=</span> <span class="va">Reaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">newdata2</span>, <span class="va">ndat</span><span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Reaction Time"</span>, x <span class="op">=</span> <span class="st">"Days deprived of sleep (0 = baseline)"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="01_multilevel_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="riflessioni-conclusive" class="level2" data-number="14.10"><h2 data-number="14.10" class="anchored" data-anchor-id="riflessioni-conclusive">
<span class="header-section-number">14.10</span> Riflessioni Conclusive</h2>
<p>Questo capitolo ha presentato una panoramica sui modelli statistici multilivello, con un focus sull’effetto della deprivazione del sonno sulle prestazioni psicomotorie utilizzando il dataset <code>sleepstudy</code>. In tale contesto, sono stati introdotti e discussi concetti fondamentali come il “complete pooling”, il “no pooling” e il “partial pooling”, esplorandone le implicazioni nella modellazione dei dati con misure ripetute.</p>
<p>L’analisi ha posto l’accento sull’applicazione pratica dei modelli multilivello, con una particolare attenzione alla distinzione tra variabili fisse e casuali e alla loro rilevanza per la struttura del modello. Un aspetto centrale della trattazione è stata la matrice di varianza-covarianza, essenziale per comprendere le relazioni interne ai modelli multilivello.</p>
<p>Questi modelli rivestono un ruolo cruciale nel campo dell’assessment psicologico e della psicometria, poiché permettono di analizzare dati complessi tenendo conto delle variazioni individuali e di gruppo. Offrono strumenti flessibili per esaminare come fattori contestuali e individuali influenzino il comportamento e le prestazioni psicologiche, un elemento chiave per una valutazione psicologica accurata.</p>
<p>Infine, il capitolo prepara il terreno per il successivo approfondimento sui modelli multilivello nell’ambito del calcolo dell’affidabilità tra giudici, argomento che sarà sviluppato nel capitolo seguente. Inoltre, viene tracciato un collegamento con i modelli di crescita latente, i quali saranno trattati nei capitoli successivi come naturale prosecuzione o alternativa ai modelli multilivello. Questo sottolinea la continuità e la rilevanza di tali approcci nell’ambito della ricerca psicologica e psicometrica.</p>
</section><section id="session-info" class="level2" data-number="14.11"><h2 data-number="14.11" class="anchored" data-anchor-id="session-info">
<span class="header-section-number">14.11</span> Session Info</h2>
<div class="cell" data-layout-align="center" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.3.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] kableExtra_1.4.0  repr_1.1.7        lme4_1.1-36       Matrix_1.7-2     </span></span>
<span><span class="co">#&gt;  [5] car_3.1-3         carData_3.0-5     ggokabeito_0.1.0  see_0.10.0       </span></span>
<span><span class="co">#&gt;  [9] MASS_7.3-64       viridis_0.6.5     viridisLite_0.4.2 ggpubr_0.6.0     </span></span>
<span><span class="co">#&gt; [13] ggExtra_0.10.1    gridExtra_2.3     patchwork_1.3.0   bayesplot_1.11.1 </span></span>
<span><span class="co">#&gt; [17] semTools_0.5-6    semPlot_1.1.6     lavaan_0.6-19     psych_2.4.12     </span></span>
<span><span class="co">#&gt; [21] scales_1.3.0      markdown_1.13     knitr_1.49        lubridate_1.9.4  </span></span>
<span><span class="co">#&gt; [25] forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4       purrr_1.0.4      </span></span>
<span><span class="co">#&gt; [29] readr_2.1.5       tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1    </span></span>
<span><span class="co">#&gt; [33] tidyverse_2.0.0   here_1.0.1       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] rstudioapi_0.17.1   jsonlite_1.8.9      magrittr_2.0.3     </span></span>
<span><span class="co">#&gt;   [4] TH.data_1.1-3       estimability_1.5.1  farver_2.1.2       </span></span>
<span><span class="co">#&gt;   [7] nloptr_2.1.1        rmarkdown_2.29      vctrs_0.6.5        </span></span>
<span><span class="co">#&gt;  [10] minqa_1.2.8         base64enc_0.1-3     rstatix_0.7.2      </span></span>
<span><span class="co">#&gt;  [13] htmltools_0.5.8.1   broom_1.0.7         Formula_1.2-5      </span></span>
<span><span class="co">#&gt;  [16] htmlwidgets_1.6.4   plyr_1.8.9          sandwich_3.1-1     </span></span>
<span><span class="co">#&gt;  [19] emmeans_1.10.7      zoo_1.8-12          igraph_2.1.4       </span></span>
<span><span class="co">#&gt;  [22] mime_0.12           lifecycle_1.0.4     pkgconfig_2.0.3    </span></span>
<span><span class="co">#&gt;  [25] R6_2.5.1            fastmap_1.2.0       rbibutils_2.3      </span></span>
<span><span class="co">#&gt;  [28] shiny_1.10.0        digest_0.6.37       OpenMx_2.21.13     </span></span>
<span><span class="co">#&gt;  [31] fdrtool_1.2.18      colorspace_2.1-1    rprojroot_2.0.4    </span></span>
<span><span class="co">#&gt;  [34] Hmisc_5.2-2         labeling_0.4.3      timechange_0.3.0   </span></span>
<span><span class="co">#&gt;  [37] abind_1.4-8         compiler_4.4.2      withr_3.0.2        </span></span>
<span><span class="co">#&gt;  [40] glasso_1.11         htmlTable_2.4.3     backports_1.5.0    </span></span>
<span><span class="co">#&gt;  [43] ggsignif_0.6.4      corpcor_1.6.10      gtools_3.9.5       </span></span>
<span><span class="co">#&gt;  [46] tools_4.4.2         pbivnorm_0.6.0      foreign_0.8-88     </span></span>
<span><span class="co">#&gt;  [49] zip_2.3.2           httpuv_1.6.15       nnet_7.3-20        </span></span>
<span><span class="co">#&gt;  [52] glue_1.8.0          quadprog_1.5-8      nlme_3.1-167       </span></span>
<span><span class="co">#&gt;  [55] promises_1.3.2      lisrelToR_0.3       grid_4.4.2         </span></span>
<span><span class="co">#&gt;  [58] checkmate_2.3.2     cluster_2.1.8       reshape2_1.4.4     </span></span>
<span><span class="co">#&gt;  [61] generics_0.1.3      gtable_0.3.6        tzdb_0.4.0         </span></span>
<span><span class="co">#&gt;  [64] data.table_1.16.4   hms_1.1.3           utf8_1.2.4         </span></span>
<span><span class="co">#&gt;  [67] xml2_1.3.6          sem_3.1-16          pillar_1.10.1      </span></span>
<span><span class="co">#&gt;  [70] rockchalk_1.8.157   later_1.4.1         splines_4.4.2      </span></span>
<span><span class="co">#&gt;  [73] lattice_0.22-6      survival_3.8-3      kutils_1.73        </span></span>
<span><span class="co">#&gt;  [76] tidyselect_1.2.1    miniUI_0.1.1.1      pbapply_1.7-2      </span></span>
<span><span class="co">#&gt;  [79] reformulas_0.4.0    svglite_2.1.3       stats4_4.4.2       </span></span>
<span><span class="co">#&gt;  [82] xfun_0.50           qgraph_1.9.8        arm_1.14-4         </span></span>
<span><span class="co">#&gt;  [85] stringi_1.8.4       yaml_2.3.10         pacman_0.5.1       </span></span>
<span><span class="co">#&gt;  [88] boot_1.3-31         evaluate_1.0.3      codetools_0.2-20   </span></span>
<span><span class="co">#&gt;  [91] mi_1.1              cli_3.6.3           RcppParallel_5.1.10</span></span>
<span><span class="co">#&gt;  [94] rpart_4.1.24        systemfonts_1.2.1   xtable_1.8-4       </span></span>
<span><span class="co">#&gt;  [97] Rdpack_2.6.2        munsell_0.5.1       Rcpp_1.0.14        </span></span>
<span><span class="co">#&gt; [100] coda_0.19-4.1       png_0.1-8           XML_3.99-0.18      </span></span>
<span><span class="co">#&gt; [103] parallel_4.4.2      jpeg_0.1-10         mvtnorm_1.3-3      </span></span>
<span><span class="co">#&gt; [106] openxlsx_4.2.8      rlang_1.1.5         multcomp_1.4-28    </span></span>
<span><span class="co">#&gt; [109] mnormt_2.1.1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-bates2014fitting" class="csl-entry" role="listitem">
Bates, D., Mächler, M., Bolker, B., &amp; Walker, S. (2014). Fitting linear mixed-effects models using lme4. <em>arXiv preprint arXiv:1406.5823</em>.
</div>
<div id="ref-petersen2024principles" class="csl-entry" role="listitem">
Petersen, I. T. (2024). <em>Principles of psychological assessment: With applied examples in R</em>. CRC Press.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/testing_psicologico\/intro\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/ctt/06_ctt_applications.html" class="pagination-link" aria-label="Applicazioni della CTT">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Applicazioni della CTT</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/raters/02_interrater_reliability.html" class="pagination-link" aria-label="L'affidabilità tra giudici">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">L’affidabilità tra giudici</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Testing Psicologico</strong> è una dispensa scritta da Corrado Caudek.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>