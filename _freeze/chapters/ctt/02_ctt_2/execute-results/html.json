{
  "hash": "5e45b7e78c62c78a66f9b1a8c3aed58d",
  "result": {
    "engine": "knitr",
    "markdown": "# L'affidabilità del test {#sec-ctt-reliability}\n\n**Prerequisiti**\n\n- Leggere il capitolo 3, *Reliability*, del testo *Principles of psychological assessment* di @petersen2024principles. \n\n**Preparazione del Notebook**\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carica il file _common.R per impostazioni di pacchetti e opzioni\nhere::here(\"code\", \"_common.R\") |> source()\n\n# Carica pacchetti aggiuntivi\npacman::p_load(modelsummary, MASS)\n```\n:::\n\n\n\n\n\n\n## Introduzione\n\nL'affidabilità (o attendibilità) rappresenta un principio fondamentale nella teoria della misurazione ed è essenziale per garantire che le misure siano coerenti, stabili e precise nei diversi contesti applicativi. Nel testing psicologico, una buona affidabilità implica che i punteggi ottenuti siano sufficientemente consistenti e non eccessivamente influenzati da errori casuali. Questa caratteristica è di estrema importanza perché i punteggi osservati possono variare non solo in funzione delle differenze tra individui, ma anche a causa di fattori esterni e condizioni di misurazione non perfettamente controllabili.\n\nLa Teoria della Misurazione Classica (CTT, Classical Test Theory) fornisce una cornice teorica chiara per affrontare e quantificare il problema della misurazione affidabile. Secondo la CTT, ogni punteggio osservato (X) può essere scomposto in due componenti: il punteggio vero (T) e l'errore di misurazione (E). Uno degli obiettivi fondamentali della CTT consiste proprio nel suddividere la varianza complessiva dei punteggi osservati in due parti distinte:\n\n1. **Varianza del punteggio vero ($\\sigma_T^2$)**, che riflette la differenza reale tra gli individui rispetto alla caratteristica misurata.\n2. **Varianza dell'errore ($\\sigma_E^2$)**, che rappresenta le variazioni casuali e indesiderate derivanti da imperfezioni nel processo di misurazione.\n\nPer poter ottenere questa suddivisione e definire formalmente l'affidabilità, la CTT si basa su alcune assunzioni fondamentali:\n\n- **Errore medio nullo**: Si assume che gli errori di misurazione abbiano una media uguale a zero, cioè $E(e) = 0$. Questo implica che gli errori siano casuali e distribuiti simmetricamente attorno al punteggio vero, senza alcun bias sistematico.\n- **Indipendenza tra punteggio vero e errore**: L'errore di misurazione non deve essere correlato con il punteggio vero, cioè la correlazione $\\rho_{T,E} = 0$. Questo significa che l'errore non dipende dal valore della caratteristica misurata.\n- **Indipendenza degli errori nel tempo**: L'errore di misurazione in un'occasione deve essere indipendente dall'errore in un'altra occasione ($\\rho_{e_1, e_2} = 0$).\n\n## Varianza del punteggio osservato\n\nSecondo la CTT, la varianza del punteggio osservato ($\\sigma^2_X$) è la somma della varianza del punteggio vero e della varianza dell'errore:\n\n$$\n\\sigma^2_X = \\sigma_T^2 + \\sigma_E^2.\n$$ {#eq-var-sum}\n\nLa validità di questa relazione può essere dimostrata facilmente considerando l'assunzione di indipendenza tra errore e punteggio vero ($\\rho_{T,E} = 0$), che implica $\\sigma_{TE} = 0$.\n\n$$\n\\sigma^2_X =  \\mathbb{V}(T+E) =  \\sigma_T^2 + \\sigma_E^2 + 2 \\sigma_{TE}.\n$$ {#eq-3-2-4}\n\nDato che $\\sigma_{TE}=\\rho_{TE}\\sigma_T \\sigma_E=0$, in quanto $\\rho_{TE}=0$, ne segue che\n\n$$\n\\sigma^2_X =   \\sigma_T^2 + \\sigma_E^2.\n$$\n\nAd esempio, utilizzando dati simulati:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(8394)\n\nn <- 100\nSigma <- matrix(c(6, 0, 0, 3), byrow = TRUE, ncol = 2)\nmu <- c(12, 0)\ndat <- MASS::mvrnorm(n, mu, Sigma, empirical = TRUE)\nT <- dat[, 1]\nE <- dat[, 2]\nX <- T + E\n\nvar(X)\n#> [1] 9\nvar(T) + var(E)\n#> [1] 9\n```\n:::\n\n\n\n\n\n## Covarianza tra punteggio osservato e punteggio vero\n\nLa covarianza tra il punteggio osservato e il punteggio vero è pari alla varianza del punteggio vero:\n\n$$\n\\sigma_{X T} = \\sigma_T^2.\n$$ {#eq-cov-obs-true}\n\nQuesta relazione è dimostrata considerando l'indipendenza tra punteggio vero e errore e il fatto che $E(E) = 0$:\n\n$$\n\\begin{aligned}\n\\sigma_{X T} &= \\mathbb{E}(XT) - \\mathbb{E}(X)\\mathbb{E}(T)\\notag\\\\\n&=  \\mathbb{E}[(T+E)T] - \\mathbb{E}(T+E)\\mathbb{E}(T)\\notag\\\\\n&=  \\mathbb{E}(T^2) + \\underbrace{\\mathbb{E}(ET)}_{=0} - [\\mathbb{E}(T)]^2 -  \\underbrace{\\mathbb{E}(E)}_{=0} \\mathbb{E}(T)\\notag\\\\\n&=\\mathbb{E}(T^2) - [\\mathbb{E}(T)]^2\\notag \\\\\n&= \\sigma_T^2.\n\\end{aligned}\n$$\n\nVerifica empirica:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncov(X, T)\n#> [1] 6\nvar(T)\n#> [1] 6\n```\n:::\n\n\n\n\n\n## Correlazione tra punteggio osservato e punteggio vero\n\nLa correlazione tra punteggio osservato e punteggio vero è data dal rapporto tra la deviazione standard del punteggio vero e quella del punteggio osservato:\n\n$$\n\\rho_{X T} = \\frac{\\sigma_T}{\\sigma_X}.\n$$ {#eq-sd-ratio}\n\nEsaminiamo la dimostrazione. Per definizione, la correlazione tra due variabili $X$ e $T$ è data dal rapporto tra la loro covarianza e il prodotto delle rispettive deviazioni standard:\n\n$$\n\\rho_{XT} = \\frac{\\sigma_{XT}}{\\sigma_X \\sigma_T}.\n$$\n\nDalla teoria classica della misurazione sappiamo che il punteggio osservato $X$ è la somma del punteggio vero $T$ e dell'errore $E$: $X = T + E$. Pertanto, la covarianza tra punteggio osservato e punteggio vero è:\n\n$$\n\\sigma_{XT} = \\text{Cov}(X, T) = \\text{Cov}(T + E, T).\n$$\n\nApplicando la proprietà della linearità della covarianza, \n\n$$\\text{Cov}(A+B,C)=\\text{Cov}(A,C)+\\text{Cov}(B,C) ,$$ \n\nper il caso presente, poiché per assunzione della CTT vale che la covarianza tra errore e punteggio vero sia nulla ($\\sigma_{ET} = 0$), otteniamo:\n\n$$\n\\sigma_{XT} = \\text{Cov}(T + E, T) = \\text{Cov}(T,T) + \\text{Cov}(E,T) = \\sigma^2_T + 0 = \\sigma^2_T.\n$$\n\nInserendo questo risultato nell'equazione iniziale otteniamo:\n\n$$\n\\rho_{XT} = \\frac{\\sigma_{XT}}{\\sigma_X \\sigma_T} = \\frac{\\sigma^2_T}{\\sigma_X \\sigma_T}.\n$$\n\nA questo punto semplifichiamo l'espressione, dividendo numeratore e denominatore per $\\sigma_T$:\n\n$$\n\\rho_{XT} = \\frac{\\sigma^2_T}{\\sigma_X \\sigma_T} = \\frac{\\sigma_T}{\\sigma_X}.\n$$\n\nQuindi, abbiamo dimostrato che la correlazione tra il punteggio osservato e il punteggio vero è data dal rapporto tra la deviazione standard del punteggio vero e quella del punteggio osservato. Questo risultato è importante perché evidenzia che la correlazione tra punteggio vero e osservato dipende dalla proporzione di varianza vera rispetto alla varianza totale (osservata). Questa relazione mostra che l'affidabilità aumenta quanto più la varianza vera prevale sulla varianza totale osservata.\n\nVerifica empirica:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor(X, T)\n#> [1] 0.816\nsd(T) / sd(X)\n#> [1] 0.816\n```\n:::\n\n\n\n\n\n## Definizione e interpretazione dell'affidabilità\n\nIl quadrato della correlazione tra punteggio osservato e punteggio vero, $\\rho_{XT}^2$, corrisponde all'attendibilità del test. Quindi, la **CTT definisce formalmente l'affidabilità** di un test come il rapporto tra la varianza del punteggio vero e la varianza del punteggio osservato:\n\n$$\n\\rho_{X T}^2 = \\frac{\\sigma_T^2}{\\sigma_X^2}.\n$$ {#eq-reliability-1}\n\nQuesta relazione implica anche che l'affidabilità è uguale al quadrato della correlazione tra il punteggio osservato e il punteggio vero. L'affidabilità può quindi essere interpretata come la proporzione della varianza osservata che riflette la reale differenza tra individui rispetto alla caratteristica misurata.\n\nQuesta formula è il concetto fondamentale della CTT e misura il livello di variazione del punteggio vero rispetto alla variazione del punteggio osservato.\n\nVerifica empirica:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor(X, T)^2\n#> [1] 0.667\nvar(T) / var(X)\n#> [1] 0.667\n```\n:::\n\n\n\n\n\nInfine, considerando che $\\sigma_X^2 = \\sigma_T^2 + \\sigma_E^2$, possiamo anche esprimere l'affidabilità in termini di errore:\n\n$$\n\\begin{equation}\n\\rho_{XT}^2 = \\frac{\\sigma_{T}^2}{\\sigma_X^2} =\\frac{\\sigma_{X}^2 - \\sigma^2_E}{\\sigma_X^2} = 1-\\frac{\\sigma_{E}^2}{\\sigma_{X}^2}.\n\\end{equation}\n$$ {#eq-3-2-6}\n\n\nDall'@eq-3-2-6, possiamo dedurre che il coefficiente di affidabilità assume il valore di $1$ quando la varianza degli errori $\\sigma_{E}^2$ è nulla, e assume il valore di $0$ quando la varianza degli errori è uguale alla varianza del punteggio osservato. Quindi, il coefficiente di affidabilità è un valore assoluto situato nell'intervallo tra $0$ e $1$ che indica il grado in cui un test misura stabilmente una caratteristica psicologica senza interferenze casuali.\n\nIn relazione ai dati dell'esempio, otteniamo:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n1 - (var(E) / var(X))\n#> [1] 0.667\n```\n:::\n\n\n\n\n\n\n## Attendibilità e modello di regressione lineare\n\nLa CTT può essere chiaramente compresa attraverso il parallelo con il modello di regressione lineare semplice. Infatti, nella CTT il punteggio osservato (variabile dipendente) viene espresso come funzione lineare del punteggio vero (variabile indipendente). In altre parole, il punteggio osservato può essere considerato come il risultato di una regressione lineare del punteggio vero, con un'intercetta uguale a 0 e una pendenza uguale a 1, a cui si aggiunge un errore casuale.\n\nIn termini più formali, questo modello può essere espresso come:\n\n$$\nX = a + b T + E.\n$$\n\ndove:\n\n - $X$ rappresenta il punteggio osservato,\n - $T$ il punteggio vero,\n - $E$ è l'errore di misurazione.\n \nIl coefficiente di attendibilità definito dalla CTT (ovvero il rapporto tra la varianza del punteggio vero e la varianza del punteggio osservato) coincide esattamente con il coefficiente di determinazione $R^2$ del modello di regressione lineare così definito. Il coefficiente di determinazione $R^2$ misura infatti la proporzione di varianza della variabile dipendente spiegata dal modello, che in questo caso corrisponde alla varianza del punteggio vero.\n \nPer chiarire ulteriormente il concetto, riprendiamo l'esempio con i dati simulati:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfm <- lm(X ~ T)\nsummary(fm)\n#> \n#> Call:\n#> lm(formula = X ~ T)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -4.434 -0.972 -0.087  1.080  3.735 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)\n#> (Intercept) 4.26e-15   8.75e-01       0        1\n#> T           1.00e+00   7.14e-02      14   <2e-16\n#> \n#> Residual standard error: 1.74 on 98 degrees of freedom\n#> Multiple R-squared:  0.667,\tAdjusted R-squared:  0.663 \n#> F-statistic:  196 on 1 and 98 DF,  p-value: <2e-16\n```\n:::\n\n\n\n\n\nCome possiamo osservare dall'output, la regressione ha intercetta prossima a 0 e pendenza prossima a 1. Questo risultato è coerente con le assunzioni della CTT secondo cui i punteggi osservati dovrebbero riflettere direttamente i punteggi veri, $\\mathbb{E}(X) = \\mathbb{E}(T)$.\n\nInoltre, il coefficiente di determinazione  fornito dal modello di regressione corrisponde precisamente al coefficiente di attendibilità calcolato tramite la formula della CTT:\n\n$$\n\\rho_{X T}^2 = \\frac{\\sigma_T^2}{\\sigma_X^2}.\n$$\n\nVerifica empirica:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nvar(T) / var(X)\n#> [1] 0.667\n```\n:::\n\n\n\n\n\nPertanto, il coefficiente di attendibilità può essere interpretato come il coefficiente di determinazione di una regressione lineare che descrive quanto della variabilità totale nei punteggi osservati possa essere spiegata dai punteggi veri.\n\nInoltre, l'errore standard della regressione corrisponde esattamente all'errore standard di misurazione definito dalla CTT. Questo valore rappresenta la variabilità media degli errori intorno alla retta di regressione, ovvero la dispersione dei punteggi osservati intorno ai punteggi veri:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsqrt(var(E) * 99 / 98)\n#> [1] 1.74\n```\n:::\n\n\n\n\n\n**Nota importante:** il fattore correttivo utilizzato nella formula precedente deriva dal fatto che, nella stima della varianza tramite regressione lineare, si usa $n-2$ al denominatore (dove $n$ è il numero di osservazioni), mentre la funzione `var()` di R usa $n-1$. Da qui la necessità della correzione:\n\n$$\n\\text{Errore standard} = \\sqrt{\\frac{(n-1)}{(n-2)} \\cdot \\sigma_E^2}.\n$$\n\nQuesta equivalenza chiarisce ulteriormente come il modello di regressione lineare e la CTT siano strettamente connessi, offrendo una prospettiva intuitiva per comprendere il significato e l'importanza del concetto di affidabilità.\n\n<!-- ## Misurazioni parallele e affidabilità -->\n\n<!-- L'equazione $\\rho_{XT}^2 = \\frac{\\sigma_{T}^2}{\\sigma_X^2}$ definisce il coefficiente di affidabilità, ma non ci fornisce gli strumenti pratici per calcolarlo direttamente. Questo perché la varianza del punteggio reale $\\sigma_{T}^2$ rappresenta un valore sconosciuto. Il metodo utilizzato dalla CTT per ottenere una stima empirica dell'attendibilità è quello delle *forme parallele* del -->\n<!-- test. In pratica, se è possibile creare versioni alternative del test che siano equivalenti in termini di contenuto, modalità di risposta e caratteristiche statistiche, allora diventa possibile ottenere una stima empirica del coefficiente di affidabilità. -->\n\n<!-- Secondo la CTT, due test $X=T+E$ e $X^\\prime=T^\\prime+E^\\prime$ sono considerati misurazioni parallele della stessa abilità latente quando: -->\n\n<!-- - $T = T^\\prime$, -->\n<!-- - $\\mathbb{V}(E) = \\mathbb{V}(E^\\prime)$. -->\n\n<!-- Queste premesse implicano che $\\mathbb{E}(X) = \\mathbb{E}(X^\\prime)$. -->\n\n<!-- La dimostrazione procede come segue. Considerando che $\\mathbb{E}(X) = T$ e $\\mathbb{E}(X^\\prime) = T$, è evidente che $\\mathbb{E}(X) =\\mathbb{E}(X^\\prime)$ poiché $\\mathbb{E}(E) = \\mathbb{E}(E^\\prime) = 0$. -->\n\n<!-- In modo analogo, l'uguaglianza delle varianze nei punteggi osservati delle due misurazioni parallele deve essere verificata, cioè $\\mathbb{V}(X) = \\mathbb{V}(X^\\prime)$. -->\n\n<!-- Questa dimostrazione si sviluppa come segue. Per $X$, possiamo scrivere  -->\n\n<!-- $$\\mathbb{V}(X) = \\mathbb{V}(T + E) = \\mathbb{V}(T) + \\mathbb{V}(E);$$ -->\n\n<!-- mentre per $X^\\prime$ possiamo scrivere  -->\n\n<!-- $$\\mathbb{V}(X^\\prime) = \\mathbb{V}(T^\\prime + E^\\prime) = \\mathbb{V}(T^\\prime) + \\mathbb{V}(E^\\prime).$$  -->\n\n<!-- Poiché sappiamo che $\\mathbb{V}(E) = \\mathbb{V}(E^\\prime)$ e che $T = T^\\prime$, possiamo dedurre che $\\mathbb{V}(X) = \\mathbb{V}(X^\\prime)$. -->\n\n<!-- In aggiunta, è importante notare che per costruzione gli errori $E$ e $E^\\prime$ sono incorrelati sia con $T$ che tra di loro. -->\n\n## Misurazioni parallele e affidabilità\n\nLa definizione formale del coefficiente di affidabilità è data dall'equazione:\n\n$$\n\\rho_{XT}^2 = \\frac{\\sigma_{T}^2}{\\sigma_X^2}\n$$\n\nTuttavia, questa formula presenta una difficoltà pratica fondamentale: la varianza del punteggio vero $\\sigma_{T}^2$ non è direttamente osservabile, essendo una quantità teorica sconosciuta. La Teoria Classica dei Test (CTT) risolve questo problema attraverso il metodo delle *forme parallele* del test, che permette di ottenere una stima empirica della sua attendibilità.\n\nDue test $X = T + E$ e $X' = T' + E'$ sono definiti paralleli quando misurano la stessa abilità latente e soddisfano le seguenti condizioni:\n\n- uguaglianza dei punteggi veri: $T = T'$,\n- uguaglianza delle varianze degli errori: $\\mathbb{V}(E) = \\mathbb{V}(E')$.\n\nDa queste condizioni deriva logicamente l'uguaglianza dei valori attesi dei punteggi osservati:\n\n$$\n\\mathbb{E}(X) = \\mathbb{E}(T + E) = \\mathbb{E}(T) + \\mathbb{E}(E) = T\n$$\n$$\n\\mathbb{E}(X') = \\mathbb{E}(T' + E') = \\mathbb{E}(T') + \\mathbb{E}(E') = T'\n$$\n\nDato che per definizione $T = T'$ e $\\mathbb{E}(E) = \\mathbb{E}(E') = 0$, segue direttamente:\n\n$$\n\\mathbb{E}(X) = \\mathbb{E}(X') .\n$$\n\nAnalogamente, per i test paralleli deve valere anche l'uguaglianza delle varianze dei punteggi osservati:\n\n$$\n\\mathbb{V}(X) = \\mathbb{V}(X') .\n$$\n\nLa dimostrazione si articola chiaramente:\n\n$$\n\\mathbb{V}(X) = \\mathbb{V}(T + E) = \\mathbb{V}(T) + \\mathbb{V}(E)\n$$\n\n$$\n\\mathbb{V}(X') = \\mathbb{V}(T' + E') = \\mathbb{V}(T') + \\mathbb{V}(E')\n$$\n\nConsiderando che $T = T'$ e $\\mathbb{V}(E) = \\mathbb{V}(E')$, si conferma immediatamente che:\n\n$$\n\\mathbb{V}(X) = \\mathbb{V}(X').\n$$\n\nInfine, per costruzione, la CTT assume che gli errori di misurazione $E$ ed $E'$ siano indipendenti dal punteggio vero $T$ e siano incorrelati tra loro:\n\n$$\n\\text{Cov}(E, T) = \\text{Cov}(E', T') = \\text{Cov}(E, E') = 0 .\n$$\n\nQueste proprietà costituiscono i requisiti essenziali per la validità pratica ed empirica del metodo delle forme parallele, permettendo di stimare in modo affidabile il coefficiente di attendibilità del test tramite la correlazione tra le due misurazioni parallele.\n\n\n\n<!-- ## La correlazione tra due forme parallele del test -->\n\n<!-- Ora procediamo a dimostrare che, secondo le ipotesi della Teoria della CTT, la correlazione tra due versioni parallele di un test è effettivamente equivalente al rapporto tra la varianza del punteggio reale e la varianza del punteggio osservato. Come discusso nel capitolo precedente, le misurazioni parallele rappresentano il grado più elevato di somiglianza tra due diverse versioni di un test. -->\n\n<!-- La dimostrazione è la seguente. Consideriamo, senza perdita di generalità, che $\\mathbb{E}(X) = \\mathbb{E}(X') = \\mathbb{E}(T) = 0$. Questa scelta ci consente di scrivere: -->\n\n<!-- $$ -->\n<!-- \\begin{aligned} -->\n<!-- \\rho_{X X^\\prime} &= \\frac{\\sigma(X, X^\\prime)}{\\sigma(X) \\sigma(X^\\prime)} \\\\ -->\n<!-- &= \\frac{\\mathbb{E}(XX^\\prime)}{\\sigma(X) \\sigma(X^\\prime)} \\\\ -->\n<!-- &= \\frac{\\mathbb{E}[(T+E)(T+E^\\prime)]}{\\sigma(X) \\sigma(X^\\prime)} \\\\ -->\n<!-- &= \\frac{\\mathbb{E}(T^2) + \\mathbb{E}(TE^\\prime) + \\mathbb{E}(TE) + \\mathbb{E}(EE^\\prime)}{\\sigma(X) \\sigma(X^\\prime)}. -->\n<!-- \\end{aligned} -->\n<!-- $$ -->\n\n<!-- Tuttavia, sappiamo che $\\mathbb{E}(TE) = \\mathbb{E}(TE^\\prime) = \\mathbb{E}(EE^\\prime) = 0$. Inoltre, $\\sigma(X) = \\sigma(X^\\prime) = \\sigma_X$. Pertanto, giungiamo a: -->\n\n<!-- $$ -->\n<!-- \\rho_{X X^\\prime} = \\frac{\\mathbb{E}(T^2)}{\\sigma_X \\sigma_X} = \\frac{\\sigma^2_T}{\\sigma^2_X}. -->\n<!-- $$ {#eq:3-3-5} -->\n\n<!-- Notiamo che il risultato ottenuto, insieme all'equazione che definisce il coefficiente di affidabilità $\\rho_{XT}^2 = \\frac{\\sigma_{T}^2}{\\sigma_X^2}$, presentano entrambi la stessa espressione a destra del segno di uguale. Questo conduce a un risultato cruciale: il coefficiente di affidabilità, ossia il quadrato della correlazione tra il punteggio osservato e il punteggio reale, è identico alla correlazione tra i punteggi osservati di due versioni parallele del test: -->\n\n<!-- $$ -->\n<!-- \\rho^2_{XT} =  \\rho_{XX^\\prime}. -->\n<!-- $$ {#eq-rho2xt-rhoxx} -->\n\n<!-- Questa conclusione è di notevole importanza in quanto consente di esprimere la variabile inosservabile $\\rho^2_{XT}$ in termini della variabile osservabile $\\rho_{XX^\\prime}$, la quale può essere calcolata in base ai punteggi osservati delle due forme parallele del test. Fondamentalmente, la stima di $\\rho^2_{XT}$ si semplifica nella stima di $\\rho^2_{XX^\\prime}$. Questo spiega l'importanza dell'equazione {eq}`eq-rho2xt-rhoxx` nella CTT. Inoltre, è da sottolineare che l'equazione {ref}`eq:rho2xt-rhoxx` fornisce una giustificazione per l'utilizzo della correlazione split-half come misura di affidabilità. -->\n\n<!-- ## La correlazione tra punteggio osservato e punteggio vero -->\n\n<!-- Esaminiamo adesso la correlazione tra il punteggio osservato e il punteggio reale. L'@eq-rho2xt-rhoxx può essere riformulata come segue: -->\n\n<!-- $$ -->\n<!-- \\rho_{XT} = \\sqrt{\\rho_{XX^\\prime}}. -->\n<!-- $$  -->\n\n<!-- In altre parole, la radice quadrata del coefficiente di affidabilità equivale alla correlazione tra il punteggio osservato e il punteggio reale. -->\n\n<!-- Procediamo ora a verificare questa relazione utilizzando i dati dell'esempio. -->\n\n<!-- ```{r} -->\n<!-- #| vscode: {languageId: r} -->\n<!-- sqrt(var(T) / var(X)) -->\n<!-- ``` -->\n\n<!-- ```{r} -->\n<!-- #| vscode: {languageId: r} -->\n<!-- cor(X, T) -->\n<!-- ``` -->\n\n<!-- ## I fattori che influenzano l'attendibilità -->\n\n<!-- Considerando le tre equazioni: -->\n\n<!-- $$ -->\n<!-- \\rho^2_{XT} = \\rho_{XX'},\\quad -->\n<!-- \\rho_{XT}^2 = \\frac{\\sigma_{T}^2}{\\sigma_X^2}, \\quad -->\n<!-- \\rho_{XT}^2 = 1-\\frac{\\sigma_{E}^2}{\\sigma_X^2}, -->\n<!-- $$  -->\n\n<!-- possiamo affermare che esistono tre modi equivalenti per giungere alla conclusione che l'attendibilità di un test è elevata. L'attendibilità di un test è considerata alta quando si verificano le seguenti condizioni: -->\n\n<!-- - La correlazione tra le forme parallele del test è elevata. -->\n<!-- - La varianza del punteggio vero è ampia rispetto alla varianza del punteggio osservato. -->\n<!-- - La varianza dell'errore di misurazione è ridotta rispetto alla varianza del punteggio osservato. -->\n\n<!-- Queste considerazioni rivestono un'importanza fondamentale nella progettazione di un test. In particolare, l'equazione $\\rho^2_{XT} = \\rho_{XX'}$ fornisce un criterio per la selezione degli item da includere nel test. Se interpretiamo $\\rho_{XX'}$ come la correlazione tra due item, allora gli item che presentano la correlazione più elevata tra di loro dovrebbero essere inclusi nel test. In questo modo, l'attendibilità del test aumenta, poiché gli item selezionati risultano fortemente correlati con il punteggio vero. -->\n\n\n## La correlazione tra due forme parallele del test\n\nVediamo ora come dimostrare formalmente che, sotto le ipotesi della CTT, la correlazione tra due versioni parallele del test coincide esattamente con il rapporto tra la varianza del punteggio vero e la varianza del punteggio osservato.\n\nSupponiamo, per semplicità e senza perdita di generalità, che $\\mathbb{E}(X) = \\mathbb{E}(X') = \\mathbb{E}(T) = 0$. Questa scelta semplifica i calcoli e porta alla seguente formulazione:\n\n$$\n\\begin{aligned}\n\\rho_{X X^\\prime} &= \\frac{\\sigma(X, X^\\prime)}{\\sigma(X) \\sigma(X^\\prime)} \\\\\n&= \\frac{\\mathbb{E}(XX^\\prime)}{\\sigma(X) \\sigma(X^\\prime)} \\\\\n&= \\frac{\\mathbb{E}[(T+E)(T+E^\\prime)]}{\\sigma(X) \\sigma(X^\\prime)} \\\\\n&= \\frac{\\mathbb{E}(T^2) + \\mathbb{E}(TE^\\prime) + \\mathbb{E}(TE) + \\mathbb{E}(EE^\\prime)}{\\sigma(X) \\sigma(X^\\prime)}.\n\\end{aligned}\n$$\n\nPoiché gli errori $E$ ed $E'$ sono incorrelati con $T$ e tra loro, abbiamo $\\mathbb{E}(TE) = \\mathbb{E}(TE^\\prime) = \\mathbb{E}(EE^\\prime) = 0$. Inoltre, per ipotesi di parallelismo, $\\sigma(X) = \\sigma(X^\\prime) = \\sigma_X$. Quindi, otteniamo il risultato finale:\n\n$$\n\\rho_{X X^\\prime} = \\frac{\\mathbb{E}(T^2)}{\\sigma_X \\sigma_X} = \\frac{\\sigma^2_T}{\\sigma^2_X}.\n$$ {#eq-3-3-5}\n\nQuesto risultato è estremamente rilevante poiché permette di collegare la correlazione osservabile tra due forme parallele $\\rho_{X X'}$ con la correlazione teorica (non direttamente osservabile) tra il punteggio osservato e quello vero:\n\n$$\n\\rho^2_{XT} = \\rho_{XX^\\prime}.\n$$ {#eq-rho2xt-rhoxx}\n\nQuesta equazione giustifica l'uso empirico della correlazione tra forme parallele (ad esempio, tramite metodo split-half) per stimare l'affidabilità del test. \n\n## La correlazione tra punteggio osservato e punteggio vero\n\nL'equazione @eq-rho2xt-rhoxx può essere riscritta per esprimere direttamente la correlazione tra punteggio osservato e punteggio vero:\n\n$$\n\\rho_{XT} = \\sqrt{\\rho_{XX^\\prime}}.\n$$\n\nQuindi, la radice quadrata della correlazione tra due forme parallele del test fornisce la correlazione tra il punteggio osservato e il punteggio reale.\n\nVerifica empirica:\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsqrt(var(T) / var(X))\n#> [1] 0.816\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor(X, T)\n#> [1] 0.816\n```\n:::\n\n\n\n\n\n## I fattori che influenzano l'attendibilità\n\nLe seguenti tre equazioni riassumono concisamente i criteri fondamentali per valutare l'affidabilità di un test:\n\n$$\n\\rho^2_{XT} = \\rho_{XX'},\\quad\n\\rho_{XT}^2 = \\frac{\\sigma_{T}^2}{\\sigma_X^2}, \\quad\n\\rho_{XT}^2 = 1 - \\frac{\\sigma_{E}^2}{\\sigma_X^2}.\n$$\n\nDa queste espressioni possiamo identificare tre condizioni equivalenti che descrivono un test altamente attendibile:\n\n- una correlazione elevata tra le due forme parallele del test;\n- una varianza del punteggio vero significativamente più ampia rispetto alla varianza del punteggio osservato;\n- una varianza dell'errore di misurazione ridotta rispetto alla varianza complessiva del punteggio osservato.\n\nQuesti fattori svolgono un ruolo cruciale nella progettazione e nello sviluppo di strumenti psicometrici. In particolare, la selezione di item strettamente correlati tra loro aumenta l'affidabilità, perché contribuisce direttamente a incrementare la proporzione di varianza del punteggio vero rispetto alla varianza totale osservata.\n\n\n## Riflessioni conclusive\n\nL'affidabilità costituisce un concetto fondamentale all'interno della teoria della misurazione, poiché si riferisce alla coerenza dei punteggi in varie situazioni, come diverse configurazioni di item, versioni del test o momenti di somministrazione. Nel corso di questo capitolo, abbiamo esplorato le basi teoriche dell'affidabilità. All'interno della CTT, l'affidabilità è definita come la correlazione tra il punteggio vero e il punteggio osservato, oppure, equivalentemente, come uno meno la correlazione tra il punteggio di errore e il punteggio osservato. Dal momento che il punteggio vero non è direttamente osservabile, è necessario ricorrere a metodi alternativi per stimare l'affidabilità. Il metodo proposto dalla CTT per ottenere tale stima è quello della correlazione dei punteggi ottenuti da due test paralleli.\n\n## Session Info\n\n\n\n\n\n::: {.cell layout-align=\"center\" vscode='{\"languageId\":\"r\"}'}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.4.2 (2024-10-31)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.3.1\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats     graphics  grDevices utils     datasets  methods   base     \n#> \n#> other attached packages:\n#>  [1] modelsummary_2.3.0 ggokabeito_0.1.0   see_0.10.0        \n#>  [4] MASS_7.3-65        viridis_0.6.5      viridisLite_0.4.2 \n#>  [7] ggpubr_0.6.0       ggExtra_0.10.1     gridExtra_2.3     \n#> [10] patchwork_1.3.0    bayesplot_1.11.1   semTools_0.5-6    \n#> [13] semPlot_1.1.6      lavaan_0.6-19      psych_2.4.12      \n#> [16] scales_1.3.0       markdown_1.13      knitr_1.49        \n#> [19] lubridate_1.9.4    forcats_1.0.0      stringr_1.5.1     \n#> [22] dplyr_1.1.4        purrr_1.0.4        readr_2.1.5       \n#> [25] tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     \n#> [28] tidyverse_2.0.0    here_1.0.1        \n#> \n#> loaded via a namespace (and not attached):\n#>   [1] rstudioapi_0.17.1   jsonlite_1.9.1      magrittr_2.0.3     \n#>   [4] TH.data_1.1-3       estimability_1.5.1  farver_2.1.2       \n#>   [7] nloptr_2.1.1        rmarkdown_2.29      vctrs_0.6.5        \n#>  [10] minqa_1.2.8         base64enc_0.1-3     rstatix_0.7.2      \n#>  [13] htmltools_0.5.8.1   broom_1.0.7         Formula_1.2-5      \n#>  [16] htmlwidgets_1.6.4   plyr_1.8.9          sandwich_3.1-1     \n#>  [19] emmeans_1.10.7      zoo_1.8-13          igraph_2.1.4       \n#>  [22] mime_0.12           lifecycle_1.0.4     pkgconfig_2.0.3    \n#>  [25] Matrix_1.7-2        R6_2.6.1            fastmap_1.2.0      \n#>  [28] rbibutils_2.3       shiny_1.10.0        digest_0.6.37      \n#>  [31] OpenMx_2.21.13      fdrtool_1.2.18      colorspace_2.1-1   \n#>  [34] rprojroot_2.0.4     Hmisc_5.2-2         timechange_0.3.0   \n#>  [37] abind_1.4-8         compiler_4.4.2      withr_3.0.2        \n#>  [40] glasso_1.11         htmlTable_2.4.3     backports_1.5.0    \n#>  [43] carData_3.0-5       ggsignif_0.6.4      corpcor_1.6.10     \n#>  [46] gtools_3.9.5        tools_4.4.2         pbivnorm_0.6.0     \n#>  [49] foreign_0.8-88      zip_2.3.2           httpuv_1.6.15      \n#>  [52] nnet_7.3-20         glue_1.8.0          quadprog_1.5-8     \n#>  [55] nlme_3.1-167        promises_1.3.2      lisrelToR_0.3      \n#>  [58] grid_4.4.2          checkmate_2.3.2     cluster_2.1.8      \n#>  [61] reshape2_1.4.4      generics_0.1.3      gtable_0.3.6       \n#>  [64] tzdb_0.4.0          data.table_1.17.0   hms_1.1.3          \n#>  [67] car_3.1-3           tables_0.9.31       sem_3.1-16         \n#>  [70] pillar_1.10.1       rockchalk_1.8.157   later_1.4.1        \n#>  [73] splines_4.4.2       lattice_0.22-6      survival_3.8-3     \n#>  [76] kutils_1.73         tidyselect_1.2.1    miniUI_0.1.1.1     \n#>  [79] pbapply_1.7-2       reformulas_0.4.0    stats4_4.4.2       \n#>  [82] xfun_0.51           qgraph_1.9.8        arm_1.14-4         \n#>  [85] stringi_1.8.4       yaml_2.3.10         pacman_0.5.1       \n#>  [88] boot_1.3-31         evaluate_1.0.3      codetools_0.2-20   \n#>  [91] mi_1.1              cli_3.6.4           RcppParallel_5.1.10\n#>  [94] rpart_4.1.24        xtable_1.8-4        Rdpack_2.6.2       \n#>  [97] munsell_0.5.1       Rcpp_1.0.14         coda_0.19-4.1      \n#> [100] png_0.1-8           XML_3.99-0.18       parallel_4.4.2     \n#> [103] jpeg_0.1-10         lme4_1.1-36         mvtnorm_1.3-3      \n#> [106] openxlsx_4.2.8      rlang_1.1.5         multcomp_1.4-28    \n#> [109] mnormt_2.1.1\n```\n:::\n\n\n\n\n\n<!-- [^2]: Vedremo in seguito -->\n<!--     (§ [$$ch:err_stnd_stima$$](#ch:err_stnd_stima){reference-type=\"ref\" -->\n<!--     reference=\"ch:err_stnd_stima\"}) come il livello di abilità latente -->\n<!--     (il punteggio vero) possa essere stimato con la formula di Kelley -->\n<!--     (1923), ovvero $$\\begin{aligned} -->\n<!--     \\hat{T}_i &= \\rho_{XT} x_i + (1 - \\rho_{XT})\\mu_x\\notag\\\\ -->\n<!--     &= \\mu_x + \\rho_{XT} (x_i - \\mu_x),\\notag\\end{aligned}$$ dove -->\n<!--     $\\mu_x$ è la media dei punteggio osservato e $\\hat{T}_i$ è la stima -->\n<!--     del punteggio vero per l'$i$-esimo rispondente. -->\n\n<!-- [^3]:  -->\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}