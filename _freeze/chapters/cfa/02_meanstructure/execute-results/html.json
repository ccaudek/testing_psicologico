{
  "hash": "3c521624f286cedd10c8295e1d3e8c3f",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute:\n  freeze: auto\n---\n\n\n\n\n# La struttura delle medie {#sec-cfa-meanstructure}\n\n::: callout-important\n## In questo capitolo imparerai a:\n\n- utilizzare l'informazione delle medie nei modelli CFA.\n:::\n\n::: callout-tip\n## Prerequisiti\n\n- Leggere il capitolo *Factor Analysis and Principal Component Analysis* [@petersen2024principles].\n:::\n\n::: callout-caution\n## Preparazione del Notebook\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"code\", \"_common.R\") |> source()\n\n# Carica pacchetti aggiuntivi\npacman::p_load(lavaan, psych, semPlot)\n```\n:::\n\n\n\n:::\n\n## Introduzione\n\nL'Analisi Fattoriale Confermativa (CFA) condivide con l'analisi fattoriale tradizionale l'obiettivo di esaminare le relazioni di covarianza tra le variabili. Tuttavia, una caratteristica distintiva della CFA è la possibilità di includere nel modello anche le medie, sia delle variabili osservate che di quelle latenti. Questo approccio si rivela particolarmente utile in contesti come l'analisi fattoriale confermativa longitudinale, dove le ipotesi non si limitano alle covarianze, ma riguardano anche i cambiamenti nelle medie dei costrutti analizzati nel tempo.\n\n\n## Interpretazione delle Intercette nei Modelli CFA\n\nNei modelli CFA o nei Modelli di Equazioni Strutturali (SEM), l'intercetta di una variabile indicatore, denotata con $\\tau$, rappresenta la media stimata dell'indicatore quando il fattore latente a cui è associato assume il valore zero. Questo consente di integrare nel modello informazioni sia sulle relazioni tra variabili (covarianze) sia sulle loro medie.\n\nLa relazione generale per un indicatore $y$ in un modello CFS (o SEM) è espressa dalla seguente equazione:\n\n$$ \ny = \\tau + \\lambda \\cdot \\text{fattore latente} + \\varepsilon,\n$$\n\ndove:\n\n- **$y$**: è il punteggio osservato dell'indicatore.\n- **$\\tau$**: è l'intercetta, che rappresenta la media stimata dell'indicatore quando il fattore latente è zero.\n- **$\\lambda$**: è il carico fattoriale, che misura la relazione tra il fattore latente e l'indicatore, ovvero quanto l'indicatore è influenzato dal fattore latente.\n- **$\\varepsilon$**: è l'errore di misura, che cattura la varianza dell'indicatore non spiegata dal fattore latente.\n\n### Struttura delle Medie nel Modello CFA\n\nLa struttura delle medie in un modello CFA può essere espressa attraverso la seguente formula:\n\n$$ \n\\text{media(variabile osservata)} = \\Lambda \\mu_{\\text{lat}} + \\tau,\n$$\n\ndove:\n\n- **$\\Lambda$**: è la matrice dei carichi fattoriali, che collega i fattori latenti agli indicatori.\n- **$\\mu_{\\text{lat}}$**: è il vettore delle medie dei fattori latenti.\n- **$\\tau$**: è il vettore delle intercette degli indicatori, che rappresenta le medie degli indicatori indipendentemente dai fattori latenti.\n\n### Interpretazione \n\n- **Cosa rappresenta $\\tau$ concretamente?**  \n  L'intercetta $\\tau$ rappresenta il valore atteso di un indicatore quando il fattore latente associato ha un valore pari a zero. Per esempio, immagina un indicatore che misura la performance in un test. Se il fattore latente (ad esempio, \"abilità generale\") è zero, $\\tau$ indica la media attesa della performance in quella condizione specifica.\n\n- **Perché $\\tau$ è importante?**  \n  $\\tau$ è fondamentale per interpretare il livello base dell'indicatore, consentendo di separare la varianza spiegata dai fattori latenti da quella attribuibile ad altre cause, come il livello medio dell'indicatore stesso. Questo è particolarmente utile per comprendere i punti di partenza dei partecipanti o i livelli medi degli indicatori in un contesto specifico.\n\n#### Esempio Intuitivo\n\nSupponiamo di analizzare i risultati di un test di matematica. Se il fattore latente rappresenta \"abilità matematica\" e il carico fattoriale $\\lambda$ è elevato, ciò significa che i punteggi del test sono fortemente influenzati dall'abilità matematica. Tuttavia, $\\tau$ fornisce un'informazione aggiuntiva: indica il punteggio medio nel test per chi ha un'abilità matematica pari a zero. \n\nSe i dati sono stati centrati, l'intercetta $\\tau$ rappresenta la performance media prevista per i partecipanti con un'abilità matematica media rispetto al gruppo di riferimento.\n\n#### Importanza di $\\tau$ nei Modelli SEM\n\nL'intercetta $\\tau$ assume particolare rilievo nei modelli SEM applicati a:\n\n- **Studi longitudinali**: Le variazioni di $\\tau$ nel tempo possono indicare cambiamenti nei livelli medi degli indicatori, come miglioramenti o peggioramenti in una competenza specifica.\n- **Confronti tra gruppi**: Differenze significative nelle intercette tra gruppi possono evidenziare disuguaglianze nei livelli medi di un indicatore, fornendo informazioni utili per analisi comparative.\n\nIn sintesi, l'intercetta $\\tau$ è uno strumento chiave per comprendere e interpretare il comportamento degli indicatori nei modelli SEM, offrendo una visione chiara delle loro relazioni con i fattori latenti e delle differenze a livello di gruppo o temporale.\n\n### Utilizzo delle Medie nel Software `lavaan`\n\nNel software `lavaan`, utilizzato per l'analisi SEM, è possibile stimare le intercette inserendo l'opzione `meanstructure = TRUE` nella sintassi del modello. Questo comando permette di includere automaticamente una costante \"1\" in tutte le equazioni del modello, facilitando così il calcolo delle intercette per le variabili endogene. È necessario fornire i dati originali o una matrice di covarianza, insieme alle medie di tutte le variabili interessate.\n\n## Un Esempio Pratico\n\nUtilizziamo il dataset `HolzingerSwineford1939` per costruire un modello di misurazione basato su tre costrutti latenti:\n\n- **Visual (visual)**: rappresenta abilità visive, misurate dagli indicatori `x1`, `x2` e `x3`.\n- **Textual (textual)**: rappresenta abilità testuali, misurate dagli indicatori `x4`, `x5` e `x6`.\n- **Speed (speed)**: rappresenta velocità di elaborazione, misurata dagli indicatori `x7`, `x8` e `x9`.\n\nVisualizziamo una panoramica del dataset:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata(HolzingerSwineford1939)\nglimpse(HolzingerSwineford1939)\n#> Rows: 301\n#> Columns: 15\n#> $ id     <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, …\n#> $ sex    <int> 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2,…\n#> $ ageyr  <int> 13, 13, 13, 13, 12, 14, 12, 12, 13, 12, 12, 12, 12, 12, 12,…\n#> $ agemo  <int> 1, 7, 1, 2, 2, 1, 1, 2, 0, 5, 2, 11, 7, 8, 6, 1, 11, 5, 8, …\n#> $ school <fct> Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Paste…\n#> $ grade  <int> 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,…\n#> $ x1     <dbl> 3.333, 5.333, 4.500, 5.333, 4.833, 5.333, 2.833, 5.667, 4.5…\n#> $ x2     <dbl> 7.75, 5.25, 5.25, 7.75, 4.75, 5.00, 6.00, 6.25, 5.75, 5.25,…\n#> $ x3     <dbl> 0.375, 2.125, 1.875, 3.000, 0.875, 2.250, 1.000, 1.875, 1.5…\n#> $ x4     <dbl> 2.333, 1.667, 1.000, 2.667, 2.667, 1.000, 3.333, 3.667, 2.6…\n#> $ x5     <dbl> 5.75, 3.00, 1.75, 4.50, 4.00, 3.00, 6.00, 4.25, 5.75, 5.00,…\n#> $ x6     <dbl> 1.2857, 1.2857, 0.4286, 2.4286, 2.5714, 0.8571, 2.8571, 1.2…\n#> $ x7     <dbl> 3.391, 3.783, 3.261, 3.000, 3.696, 4.348, 4.696, 3.391, 4.5…\n#> $ x8     <dbl> 5.75, 6.25, 3.90, 5.30, 6.30, 6.65, 6.20, 5.15, 4.65, 4.55,…\n#> $ x9     <dbl> 6.361, 7.917, 4.417, 4.861, 5.917, 7.500, 4.861, 3.667, 7.3…\n```\n:::\n\n\n\n\n### Specifica del Modello\n\nOgni costrutto è definito in relazione ai propri indicatori. Le varianze dei costrutti latenti sono fissate a 1 per garantirne la scalatura, mentre le loro medie sono fissate a 0.\n\nEcco il modello specificato:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhs_model <- \"\n    visual =~ NA*x1 + x2 + x3\n    textual =~ NA*x4 + x5 + x6\n    speed =~ NA*x7 + x8 + x9\n\n    visual ~~ 1*visual\n    textual ~~ 1*textual\n    speed ~~ 1*speed\n\"\n```\n:::\n\n\n\n\n### Stima del Modello\n\nRichiediamo la stima delle intercette degli indicatori impostando `meanstructure = TRUE`. Le intercette ($\\tau$) rappresentano il valore medio atteso per ciascun indicatore quando il rispettivo fattore latente è pari a zero. Adattiamo il modello ai dati:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfit <- cfa(hs_model,\n    data = HolzingerSwineford1939,\n    meanstructure = TRUE\n)\n```\n:::\n\n\n\n\nEsaminiamo un riepilogo dei risultati, inclusi i carichi fattoriali standardizzati:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(fit, standardized = TRUE)\n#> lavaan 0.6-19 ended normally after 20 iterations\n#> \n#>   Estimator                                         ML\n#>   Optimization method                           NLMINB\n#>   Number of model parameters                        30\n#> \n#>   Number of observations                           301\n#> \n#> Model Test User Model:\n#>                                                       \n#>   Test statistic                                85.306\n#>   Degrees of freedom                                24\n#>   P-value (Chi-square)                           0.000\n#> \n#> Parameter Estimates:\n#> \n#>   Standard errors                             Standard\n#>   Information                                 Expected\n#>   Information saturated (h1) model          Structured\n#> \n#> Latent Variables:\n#>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n#>   visual =~                                                             \n#>     x1                0.900    0.081   11.128    0.000    0.900    0.772\n#>     x2                0.498    0.077    6.429    0.000    0.498    0.424\n#>     x3                0.656    0.074    8.817    0.000    0.656    0.581\n#>   textual =~                                                            \n#>     x4                0.990    0.057   17.474    0.000    0.990    0.852\n#>     x5                1.102    0.063   17.576    0.000    1.102    0.855\n#>     x6                0.917    0.054   17.082    0.000    0.917    0.838\n#>   speed =~                                                              \n#>     x7                0.619    0.070    8.903    0.000    0.619    0.570\n#>     x8                0.731    0.066   11.090    0.000    0.731    0.723\n#>     x9                0.670    0.065   10.305    0.000    0.670    0.665\n#> \n#> Covariances:\n#>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n#>   visual ~~                                                             \n#>     textual           0.459    0.064    7.189    0.000    0.459    0.459\n#>     speed             0.471    0.073    6.461    0.000    0.471    0.471\n#>   textual ~~                                                            \n#>     speed             0.283    0.069    4.117    0.000    0.283    0.283\n#> \n#> Intercepts:\n#>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n#>    .x1                4.936    0.067   73.473    0.000    4.936    4.235\n#>    .x2                6.088    0.068   89.855    0.000    6.088    5.179\n#>    .x3                2.250    0.065   34.579    0.000    2.250    1.993\n#>    .x4                3.061    0.067   45.694    0.000    3.061    2.634\n#>    .x5                4.341    0.074   58.452    0.000    4.341    3.369\n#>    .x6                2.186    0.063   34.667    0.000    2.186    1.998\n#>    .x7                4.186    0.063   66.766    0.000    4.186    3.848\n#>    .x8                5.527    0.058   94.854    0.000    5.527    5.467\n#>    .x9                5.374    0.058   92.546    0.000    5.374    5.334\n#> \n#> Variances:\n#>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n#>     visual            1.000                               1.000    1.000\n#>     textual           1.000                               1.000    1.000\n#>     speed             1.000                               1.000    1.000\n#>    .x1                0.549    0.114    4.833    0.000    0.549    0.404\n#>    .x2                1.134    0.102   11.146    0.000    1.134    0.821\n#>    .x3                0.844    0.091    9.317    0.000    0.844    0.662\n#>    .x4                0.371    0.048    7.779    0.000    0.371    0.275\n#>    .x5                0.446    0.058    7.642    0.000    0.446    0.269\n#>    .x6                0.356    0.043    8.277    0.000    0.356    0.298\n#>    .x7                0.799    0.081    9.823    0.000    0.799    0.676\n#>    .x8                0.488    0.074    6.573    0.000    0.488    0.477\n#>    .x9                0.566    0.071    8.003    0.000    0.566    0.558\n```\n:::\n\n\n\n\n### Interpretazione dei Risultati\n\n**Carichi Fattoriali ($\\lambda$)**\n\nI carichi fattoriali indicano quanto fortemente un indicatore è associato al costrutto latente. Ad esempio, per `visual`, il carico fattoriale di `x1` è 0.90, indicando una forte relazione tra il costrutto \"Visual\" e l'indicatore `x1`.\n\n**Intercette ($\\tau$)**\n\nLe intercette rappresentano la media predetta degli indicatori quando il fattore latente associato è zero. Nel nostro modello, le medie dei costrutti latenti sono fissate a zero, quindi le intercette corrispondono alle medie predette degli indicatori.\n\n### Calcolo delle Medie Osservate e Predette\n\nPer comprendere meglio il ruolo delle intercette, calcoliamo le medie osservate e predette per gli indicatori `x1`, `x2` e `x3`.\n\nEstraiamo le intercette stimate dal modello:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nparams <- parameterEstimates(fit)\nintercepts <- params$est[params$op == \"~1\"]\nintercepts\n#>  [1] 4.936 6.088 2.250 3.061 4.341 2.186 4.186 5.527 5.374 0.000 0.000 0.000\n```\n:::\n\n\n\n\n### Calcolo della Media Predetta\n\nLa media predetta di ciascun indicatore in un modello CFA è fornita direttamente dalle intercette stimate ($\\tau$). Per gli indicatori `x1`, `x2`, `x3`, estraiamo le intercette dal modello:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean_predicted_scores <- mean(intercepts[1:3])  # Intercette predette per x1, x2, x3\nmean_predicted_scores\n#> [1] 4.425\n```\n:::\n\n\n\n\n### Calcolo della Media Osservata\n\nLa media osservata per gli stessi indicatori si ottiene calcolando la media aritmetica dei loro punteggi effettivi, come segue:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean_observed_scores <- mean(\n  (HolzingerSwineford1939$x1 + HolzingerSwineford1939$x2 + HolzingerSwineford1939$x3) / 3\n)\nmean_observed_scores\n#> [1] 4.425\n```\n:::\n\n\n\n\nSe il modello si adatta bene ai dati, le due medie dovrebbero essere molto vicine. Questo riflette l'adeguatezza del modello nel rappresentare i dati. In questo caso, i due valori coincidono o differiscono solo leggermente, confermando che il modello rappresenta fedelmente i dati osservati.\n\nIn sommario, questo esempio illustra come i carichi fattoriali e le intercette nel modello CFA siano utilizzati per stimare le medie predette degli indicatori. L'allineamento tra medie osservate e predette riflette l'adeguatezza del modello nella rappresentazione dei dati.\n\n\n## Medie di Costrutti Latenti Non Zero\n\nQuando le medie dei costrutti latenti ($\\mu_{\\text{latente}}$) non sono fissate a zero, la media **predetta** di ciascun indicatore dipende sia dalle intercette ($\\tau$) che dai carichi fattoriali ($\\lambda$). In questo caso, l'equazione per la media predetta di un indicatore, ad esempio `x1`, è:\n\n$$ \n\\text{media predetta}(x1) = \\mu_{\\text{latente}} \\cdot \\lambda_{x1} + \\tau_{x1},\n$$\n\ndove:\n\n- $\\mu_{\\text{latente}}$: è la media stimata del costrutto latente associato.\n- $\\lambda_{x1}$: è il carico fattoriale dell'indicatore `x1`, che misura quanto fortemente il costrutto latente influenza l'indicatore.\n- $\\tau_{x1}$: è l'intercetta stimata dell'indicatore `x1`.\n\nQuesta relazione evidenzia che, quando $\\mu_{\\text{latente}} \\neq 0$, la media degli indicatori riflette non solo la loro intercetta, ma anche il contributo del costrutto latente, modulato dai carichi fattoriali.\n\n\n## Modello con Medie dei Costrutti Latenti Non Zero\n\nPer esplorare questa configurazione, costruiamo un modello SEM in cui le medie dei costrutti latenti sono stimate liberamente. Per garantire l'identificabilità del modello, introduciamo due vincoli fondamentali:\n\n1. **Intercette degli indicatori marker fissate a zero**: Le variabili osservate `x1`, `x4` e `x7`, che sono gli indicatori marker per ciascun fattore, avranno intercette impostate a zero.\n2. **Una media latente fissata a zero**: La media del costrutto latente `visual` è fissata a zero come riferimento, mentre le medie di `textual` e `speed` sono stimate liberamente.\n\n### Specificazione del Modello\n\nIl modello viene specificatocome segue:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhs_model <- \"\n    # Definizione dei fattori latenti\n    visual =~ NA*x1 + x2 + x3\n    textual =~ NA*x4 + x5 + x6\n    speed =~ NA*x7 + x8 + x9\n\n    # Standardizzazione delle varianze latenti\n    visual ~~ 1*visual\n    textual ~~ 1*textual\n    speed ~~ 1*speed\n\n    # Vincoli sulle intercette degli indicatori marker\n    x1 ~ 0*1  # Intercetta di x1 fissata a zero\n    x4 ~ 0*1  # Intercetta di x4 fissata a zero\n    x7 ~ 0*1  # Intercetta di x7 fissata a zero\n\n    # Vincoli sulle medie latenti\n    visual ~ 0*1  # Media di visual fissata a zero\n    textual ~ 1   # Media di textual stimata liberamente\n    speed ~ 1     # Media di speed stimata liberamente\n\"\n```\n:::\n\n\n\n\n### Interpretazione delle Medie Predette\n\nLa caratteristica chiave di questo modello è che le medie predette degli indicatori sono una funzione di tre componenti:\n\n1. La media del costrutto latente ($\\mu_{\\text{latente}}$)\n2. Il carico fattoriale dell'indicatore ($\\lambda$)\n3. L'intercetta dell'indicatore ($\\tau$)\n\nQuesta relazione è espressa dalla formula:\n\n$$\n\\text{media predetta(indicatore)} = \\mu_{\\text{latente}} \\cdot \\lambda + \\tau\n$$\n\nPer esempio:\n\n1. Per l'indicatore marker `x1` (fattore visual):\n   $$\n   \\text{media predetta}(x1) = \\mu_{\\text{visual}} \\cdot \\lambda_{x1} + \\tau_{x1} = 0 \\cdot \\lambda_{x1} + 0 = 0\n   $$\n\n2. Per l'indicatore marker `x4` (fattore textual):\n   $$\n   \\text{media predetta}(x4) = \\mu_{\\text{textual}} \\cdot \\lambda_{x4} + \\tau_{x4}\n   $$\n   dove $\\mu_{\\text{textual}}$ è stimato liberamente e $\\tau_{x4} = 0$\n\n3. Per gli altri indicatori (es. x2, x3, x5, x6, x8, x9):\n   - Le intercette sono stimate liberamente\n   - Le medie predette includono sia il contributo della media latente che dell'intercetta\n\nQuesta struttura delle medie ci permette di:\n\n- confrontare le medie dei costrutti latenti tra gruppi diversi;\n- valutare i cambiamenti longitudinali nei costrutti latenti;\n- interpretare le differenze nelle medie degli indicatori in termini dei loro componenti strutturali.\n\n### Adattamento del Modello\n\nApplichiamo il modello ai dati e esaminiamo i risultati:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfit <- cfa(hs_model, data = HolzingerSwineford1939, meanstructure = TRUE)\nparams <- parameterEstimates(fit)\nparams\n#>        lhs op     rhs    est    se       z pvalue ci.lower ci.upper\n#> 1   visual =~      x1  4.983 0.212  23.538  0.000    4.568    5.398\n#> 2   visual =~      x2  1.702 0.093  18.248  0.000    1.519    1.885\n#> 3   visual =~      x3  2.243 0.106  21.099  0.000    2.035    2.451\n#> 4  textual =~      x4  1.783 0.081  21.945  0.000    1.624    1.942\n#> 5  textual =~      x5  1.985 0.090  22.007  0.000    1.808    2.162\n#> 6  textual =~      x6  1.652 0.076  21.702  0.000    1.502    1.801\n#> 7    speed =~      x7  1.136 0.072  15.882  0.000    0.996    1.277\n#> 8    speed =~      x8  1.341 0.070  19.127  0.000    1.204    1.478\n#> 9    speed =~      x9  1.229 0.068  17.979  0.000    1.095    1.363\n#> 10  visual ~~  visual  1.000 0.000      NA     NA    1.000    1.000\n#> 11 textual ~~ textual  1.000 0.000      NA     NA    1.000    1.000\n#> 12   speed ~~   speed  1.000 0.000      NA     NA    1.000    1.000\n#> 13      x1 ~1          0.000 0.000      NA     NA    0.000    0.000\n#> 14      x4 ~1          0.000 0.000      NA     NA    0.000    0.000\n#> 15      x7 ~1          0.000 0.000      NA     NA    0.000    0.000\n#> 16  visual ~1          0.000 0.000      NA     NA    0.000    0.000\n#> 17 textual ~1          0.885 0.054  16.405  0.000    0.779    0.990\n#> 18   speed ~1          2.845 0.187  15.207  0.000    2.478    3.211\n#> 19      x1 ~~      x1  0.890 0.257   3.457  0.001    0.385    1.394\n#> 20      x2 ~~      x2  1.134 0.100  11.368  0.000    0.938    1.329\n#> 21      x3 ~~      x3  0.844 0.087   9.719  0.000    0.674    1.015\n#> 22      x4 ~~      x4  0.371 0.045   8.239  0.000    0.283    0.459\n#> 23      x5 ~~      x5  0.446 0.055   8.116  0.000    0.338    0.554\n#> 24      x6 ~~      x6  0.356 0.041   8.679  0.000    0.276    0.437\n#> 25      x7 ~~      x7  0.799 0.077  10.411  0.000    0.649    0.950\n#> 26      x8 ~~      x8  0.488 0.062   7.915  0.000    0.367    0.608\n#> 27      x9 ~~      x9  0.566 0.062   9.132  0.000    0.445    0.688\n#> 28  visual ~~ textual  0.870 0.016  53.410  0.000    0.838    0.902\n#> 29  visual ~~   speed  0.877 0.019  47.025  0.000    0.840    0.913\n#> 30 textual ~~   speed  0.783 0.027  28.490  0.000    0.729    0.837\n#> 31      x2 ~1          4.460 0.064  69.660  0.000    4.335    4.586\n#> 32      x3 ~1          0.106 0.058   1.814  0.070   -0.008    0.220\n#> 33      x5 ~1          0.934 0.075  12.485  0.000    0.787    1.080\n#> 34      x6 ~1         -0.649 0.064 -10.085  0.000   -0.775   -0.523\n#> 35      x8 ~1          0.588 0.236   2.496  0.013    0.126    1.050\n#> 36      x9 ~1          0.847 0.226   3.742  0.000    0.403    1.291\n```\n:::\n\n\n\n\n### Interpretazione dei Risultati\n\n1. **Medie Latenti ($\\mu_{\\text{latente}}$)**  \n   Le medie stimate per i costrutti `textual` e `speed` riflettono il loro contributo alle medie predette degli indicatori associati. Per `visual`, la media latente è fissata a zero per identificare il modello.\n\n2. **Media Predetta degli Indicatori**  \n   Per ciascun indicatore, la media predetta include sia l'intercetta (fissata a zero in questo esempio) sia il contributo del costrutto latente moltiplicato per il carico fattoriale.\n\nAd esempio, per `x1`:\n\n$$\n\\text{media predetta}(x1) = \\mu_{\\text{visual}} \\cdot \\lambda_{x1} + \\tau_{x1} = 0 \\cdot \\lambda_{x1} + 0 = 0\n$$\n\nMentre per un indicatore di `textual` (ad esempio `x4`), la media predetta sarà:\n\n$$\n\\text{media predetta}(x4) = \\mu_{\\text{textual}} \\cdot \\lambda_{x4} + \\tau_{x4}.\n$$\n\n### Calcolo delle Medie Predette\n\nPer calcolare le medie predette:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Funzione per calcolare le medie predette\ncalc_predicted_means <- function(params) {\n  # Estrai i carichi fattoriali (lambda)\n  lambdas <- params[params$op == \"=~\", c(\"lhs\", \"rhs\", \"est\")]\n  \n  # Estrai le medie latenti (mu)\n  means <- params[params$op == \"~1\" & params$lhs %in% c(\"visual\", \"textual\", \"speed\"), \n                 c(\"lhs\", \"est\")]\n  \n  # Estrai le intercette (tau)\n  intercepts <- params[params$op == \"~1\" & params$lhs %in% paste0(\"x\", 1:9), \n                      c(\"lhs\", \"est\")]\n  \n  # Calcola le medie predette\n  predicted_means <- data.frame(\n    indicator = character(),\n    predicted_mean = numeric(),\n    formula = character(),\n    stringsAsFactors = FALSE\n  )\n  \n  # Per ogni indicatore\n  for(i in 1:9) {\n    indicator <- paste0(\"x\", i)\n    # Trova il fattore latente associato\n    factor <- lambdas$lhs[lambdas$rhs == indicator]\n    lambda <- lambdas$est[lambdas$rhs == indicator]\n    mu <- means$est[means$lhs == factor]\n    tau <- intercepts$est[intercepts$lhs == indicator]\n    \n    # Se l'intercetta non è presente nei risultati, assume 0\n    if(length(tau) == 0) tau <- 0\n    \n    # Calcola la media predetta\n    pred_mean <- mu * lambda + tau\n    \n    # Crea la formula come stringa\n    formula <- sprintf(\"%.3f * %.3f + %.3f = %.3f\", \n                      mu, lambda, tau, pred_mean)\n    \n    # Aggiungi alla tabella dei risultati\n    predicted_means <- rbind(predicted_means,\n                           data.frame(\n                             indicator = indicator,\n                             predicted_mean = pred_mean,\n                             formula = formula,\n                             stringsAsFactors = FALSE\n                           ))\n  }\n  \n  return(predicted_means)\n}\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calcola e mostra le medie predette\nresults <- calc_predicted_means(params)\nprint(results)\n#>   indicator predicted_mean                        formula\n#> 1        x1         0.0000  0.000 * 4.983 + 0.000 = 0.000\n#> 2        x2         4.4603  0.000 * 1.702 + 4.460 = 4.460\n#> 3        x3         0.1055  0.000 * 2.243 + 0.106 = 0.106\n#> 4        x4         1.5775  0.885 * 1.783 + 0.000 = 1.578\n#> 5        x5         2.6894  0.885 * 1.985 + 0.934 = 2.689\n#> 6        x6         0.8118 0.885 * 1.652 + -0.649 = 0.812\n#> 7        x7         3.2331  2.845 * 1.136 + 0.000 = 3.233\n#> 8        x8         4.4028  2.845 * 1.341 + 0.588 = 4.403\n#> 9        x9         4.3436  2.845 * 1.229 + 0.847 = 4.344\n```\n:::\n\n\n\n\nLe medie latenti riflettono il contributo di ciascun costrutto alla media predetta dei rispettivi indicatori. La formula $\\hat{Y} = \\mu \\cdot \\lambda + \\tau$ ci consente di distinguere i diversi contributi strutturali alle medie osservate.\n\nIn sintesi, quando le medie dei costrutti latenti sono diverse da zero, il calcolo delle medie predette degli indicatori diventa più complesso, poiché include il contributo sia delle intercette sia dei carichi fattoriali ponderati dalle medie latenti. Questo approccio è particolarmente utile in contesti in cui è necessario confrontare medie tra gruppi o valutare cambiamenti longitudinali nei costrutti latenti.\n\n## Riflessioni Conclusive\n\nIn questo capitolo abbiamo approfondito come l'inclusione delle medie nei modelli CFA consenta di ampliare la comprensione delle relazioni tra variabili, andando oltre le covarianze. Abbiamo evidenziato il ruolo cruciale delle intercette, che rappresentano il valore medio atteso degli indicatori quando i fattori latenti assumono valore zero, e come esse contribuiscano alla struttura delle medie predette degli indicatori. Infine, abbiamo esplorato l'utilità dei modelli con medie dei costrutti latenti non zero, che permettono di analizzare differenze tra gruppi e cambiamenti longitudinali, fornendo un quadro interpretativo più ricco e completo. Questo approccio è particolarmente rilevante per indagini che mirano a comprendere i livelli medi dei costrutti in relazione ai loro indicatori, sia in contesti trasversali che longitudinali.\n\n## Session Info\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.4.2 (2024-10-31)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.3.2\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats     graphics  grDevices utils     datasets  methods   base     \n#> \n#> other attached packages:\n#>  [1] ggokabeito_0.1.0  see_0.11.0        MASS_7.3-65       viridis_0.6.5    \n#>  [5] viridisLite_0.4.2 ggpubr_0.6.0      ggExtra_0.10.1    gridExtra_2.3    \n#>  [9] patchwork_1.3.0   bayesplot_1.11.1  semTools_0.5-6    semPlot_1.1.6    \n#> [13] lavaan_0.6-19     psych_2.4.12      scales_1.3.0      markdown_1.13    \n#> [17] knitr_1.50        lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1    \n#> [21] dplyr_1.1.4       purrr_1.0.4       readr_2.1.5       tidyr_1.3.1      \n#> [25] tibble_3.2.1      ggplot2_3.5.1     tidyverse_2.0.0   here_1.0.1       \n#> \n#> loaded via a namespace (and not attached):\n#>   [1] rstudioapi_0.17.1   jsonlite_1.9.1      magrittr_2.0.3     \n#>   [4] TH.data_1.1-3       estimability_1.5.1  farver_2.1.2       \n#>   [7] nloptr_2.2.1        rmarkdown_2.29      vctrs_0.6.5        \n#>  [10] minqa_1.2.8         base64enc_0.1-3     rstatix_0.7.2      \n#>  [13] htmltools_0.5.8.1   broom_1.0.7         Formula_1.2-5      \n#>  [16] htmlwidgets_1.6.4   plyr_1.8.9          sandwich_3.1-1     \n#>  [19] emmeans_1.10.7      zoo_1.8-13          igraph_2.1.4       \n#>  [22] mime_0.13           lifecycle_1.0.4     pkgconfig_2.0.3    \n#>  [25] Matrix_1.7-3        R6_2.6.1            fastmap_1.2.0      \n#>  [28] rbibutils_2.3       shiny_1.10.0        digest_0.6.37      \n#>  [31] OpenMx_2.21.13      fdrtool_1.2.18      colorspace_2.1-1   \n#>  [34] rprojroot_2.0.4     Hmisc_5.2-3         timechange_0.3.0   \n#>  [37] abind_1.4-8         compiler_4.4.2      withr_3.0.2        \n#>  [40] glasso_1.11         htmlTable_2.4.3     backports_1.5.0    \n#>  [43] carData_3.0-5       ggsignif_0.6.4      corpcor_1.6.10     \n#>  [46] gtools_3.9.5        tools_4.4.2         pbivnorm_0.6.0     \n#>  [49] foreign_0.8-88      zip_2.3.2           httpuv_1.6.15      \n#>  [52] nnet_7.3-20         glue_1.8.0          quadprog_1.5-8     \n#>  [55] nlme_3.1-167        promises_1.3.2      lisrelToR_0.3      \n#>  [58] grid_4.4.2          checkmate_2.3.2     cluster_2.1.8.1    \n#>  [61] reshape2_1.4.4      generics_0.1.3      gtable_0.3.6       \n#>  [64] tzdb_0.5.0          data.table_1.17.0   hms_1.1.3          \n#>  [67] car_3.1-3           sem_3.1-16          pillar_1.10.1      \n#>  [70] rockchalk_1.8.157   later_1.4.1         splines_4.4.2      \n#>  [73] lattice_0.22-6      survival_3.8-3      kutils_1.73        \n#>  [76] tidyselect_1.2.1    miniUI_0.1.1.1      pbapply_1.7-2      \n#>  [79] reformulas_0.4.0    stats4_4.4.2        xfun_0.51          \n#>  [82] qgraph_1.9.8        arm_1.14-4          stringi_1.8.4      \n#>  [85] yaml_2.3.10         pacman_0.5.1        boot_1.3-31        \n#>  [88] evaluate_1.0.3      codetools_0.2-20    mi_1.1             \n#>  [91] cli_3.6.4           RcppParallel_5.1.10 rpart_4.1.24       \n#>  [94] xtable_1.8-4        Rdpack_2.6.3        munsell_0.5.1      \n#>  [97] Rcpp_1.0.14         coda_0.19-4.1       png_0.1-8          \n#> [100] XML_3.99-0.18       parallel_4.4.2      jpeg_0.1-10        \n#> [103] lme4_1.1-36         mvtnorm_1.3-3       openxlsx_4.2.8     \n#> [106] rlang_1.1.5         multcomp_1.4-28     mnormt_2.1.1\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}